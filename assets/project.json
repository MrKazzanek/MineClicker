{"targets":[{"isStage":true,"name":"Stage","variables":{"VzGD}tm][hTNoS5x:Ibv":["Level","1"],"d,Ba6-.Jr6`h)xl2s,OI":["BreakStage",0],"3!B/9WIw.uf6;X`p_;cu":["MaxBreakStage",150],"fZqCs~PLs3uoIz/[2_|J":["Block_ID",2],"`GVD.c1UE9DZ{3mjeUd7":["Points",0],"E!S4pt-5(1v~!0da|;Yl":["random",2],"(p+d9kHP;,5r1Oz/e)h(":["minPoints","1"],"@ixQ9+%M=vAl%ZwAJ^pH":["maxPoints","1"],"gYS].7@afa{v{n;o;7X[":["setPoints",1]},"lists":{"WIOYQtk8ni%a=uy4-5E;":["Blocks_Name",["dirt","stone"]],"f%?~*0|CMZ#9Gw5K.lPB":["Blocks_Durability",[50,150]],"*j1uYHafC(5U/WZ7Lq:8":["Blocks_Level",["1 2","1 2 3 4"]],"_PgJKa(WzR+~-iY1.YNl":["Blocks_Min_Points",["1","1"]],"Z2ySSm4q(=ZgQ0Q0lZm6":["Blocks_Max_Points",["1","2"]],"ze.71iygbyS6;SsB_zf|":["Blocks_Temp",[1,2]]},"broadcasts":{",6/]Ks:eXY%1ASLg5~9B":"mach.stage","2NuA11W#_C}+?0gcS/IY":"load.block.data","]Y!iYLN$]R@W]Z(q*R1!":"place.new.block","3fIKQ4]58a.JeaP9kj9}":"set.layer.block","!fjwSPu`wRm/]?-*L7ow":"set.layer.block.break.overlay","EGr=3j|Q$6K90x,blkX3":"breaked.block","`cZZNkAZ^^hQ0_^mu3o?":"spawn.particles"},"blocks":{"T":{"opcode":"procedures_definition","next":"c","parent":null,"inputs":{"custom_block":[1,"bb"]},"fields":{},"topLevel":true},"bb":{"opcode":"procedures_prototype","next":null,"parent":"T","inputs":{},"fields":{},"shadow":true,"mutation":{"tagName":"mutation","children":[],"proccode":"machStage","argumentids":"[]","argumentnames":"[]","argumentdefaults":"[]","warp":"true"}},"bc":{"opcode":"procedures_call","next":null,"parent":"bd","inputs":{},"fields":{},"mutation":{"tagName":"mutation","children":[],"proccode":"machStage","argumentids":"[]","warp":"true"}},"bd":{"opcode":"event_whenflagclicked","next":"bc","parent":null,"inputs":{},"fields":{},"topLevel":true},"c":{"opcode":"runtimeoptions_setDimensions","next":"be","parent":"T","inputs":{"width":[3,"bf",[4,"480"]],"height":[3,"bg",[4,"360"]]},"fields":{}},"bf":{"opcode":"dogeiscutResolution_suggestedStageWidth","next":null,"parent":"c","inputs":{},"fields":{}},"bg":{"opcode":"dogeiscutResolution_suggestedStageHeight","next":null,"parent":"c","inputs":{},"fields":{}},"bh":{"opcode":"dogeiscutResolution_whenWindowResized","next":"bi","parent":null,"inputs":{},"fields":{},"topLevel":true},"bi":{"opcode":"procedures_call","next":null,"parent":"bh","inputs":{},"fields":{},"mutation":{"tagName":"mutation","children":[],"proccode":"machStage","argumentids":"[]","warp":"true"}},"be":{"opcode":"event_broadcast","next":null,"parent":"c","inputs":{"BROADCAST_INPUT":[1,[11,"mach.stage",",6/]Ks:eXY%1ASLg5~9B"]]},"fields":{}}},"comments":{"c#":{"blockId":null,"x":50,"y":50,"width":350,"height":170,"minimized":false,"text":"Configuration for https://turbowarp.org/\nYou can move, resize, and minimize this comment, but don't edit it by hand. This comment can be deleted to remove the stored settings.\n{\"framerate\":60,\"runtimeOptions\":{\"maxClones\":Infinity,\"miscLimits\":false,\"fencing\":false},\"hq\":true,\"width\":685} // _twconfig_"}},"currentCostume":0,"costumes":[{"name":"bg","dataFormat":"svg","assetId":"cd21514d0531fdffb22204e0ec5ed84a","md5ext":"cd21514d0531fdffb22204e0ec5ed84a.svg","rotationCenterX":240,"rotationCenterY":180}],"sounds":[],"volume":100,"layerOrder":0,"tempo":60,"videoTransparency":50,"videoState":"on","textToSpeechLanguage":null},{"isStage":false,"name":"Backgrounds","variables":{},"lists":{},"broadcasts":{},"blocks":{"bj":{"opcode":"event_whenflagclicked","next":"U","parent":null,"inputs":{},"fields":{},"topLevel":true},"U":{"opcode":"motion_gotoxy","next":"V","parent":"bj","inputs":{"X":[1,[4,"0"]],"Y":[1,[4,"0"]]},"fields":{}},"bk":{"opcode":"event_whenbroadcastreceived","next":"W","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["mach.stage",",6/]Ks:eXY%1ASLg5~9B"]},"topLevel":true},"W":{"opcode":"motion_gotoxy","next":"X","parent":"bk","inputs":{"X":[1,[4,"0"]],"Y":[1,[4,"0"]]},"fields":{}},"X":{"opcode":"looks_setsizeto","next":"d","parent":"W","inputs":{"SIZE":[1,[4,"100"]]},"fields":{}},"d":{"opcode":"control_if_else","next":null,"parent":"X","inputs":{"CONDITION":[2,"n"],"SUBSTACK":[2,"Y"],"SUBSTACK2":[2,"Z"]},"fields":{}},"n":{"opcode":"operator_gt","next":null,"parent":"d","inputs":{"OPERAND1":[3,"!",[10,""]],"OPERAND2":[3,"#",[10,"50"]]},"fields":{}},"!":{"opcode":"operator_divide","next":null,"parent":"n","inputs":{"NUM1":[3,"bl",[4,""]],"NUM2":[1,[4,"480"]]},"fields":{}},"bl":{"opcode":"dogeiscutResolution_suggestedStageWidth","next":null,"parent":"!","inputs":{},"fields":{}},"#":{"opcode":"operator_divide","next":null,"parent":"n","inputs":{"NUM1":[3,"bm",[4,""]],"NUM2":[1,[4,"360"]]},"fields":{}},"bm":{"opcode":"dogeiscutResolution_suggestedStageHeight","next":null,"parent":"#","inputs":{},"fields":{}},"Y":{"opcode":"looks_setsizeto","next":null,"parent":"d","inputs":{"SIZE":[3,"%",[4,"100"]]},"fields":{}},"%":{"opcode":"operator_multiply","next":null,"parent":"Y","inputs":{"NUM1":[3,"(",[4,""]],"NUM2":[1,[4,"110"]]},"fields":{}},"(":{"opcode":"operator_divide","next":null,"parent":"%","inputs":{"NUM1":[3,"bn",[4,""]],"NUM2":[1,[4,"480"]]},"fields":{}},"bn":{"opcode":"dogeiscutResolution_suggestedStageWidth","next":null,"parent":"(","inputs":{},"fields":{}},"Z":{"opcode":"looks_setsizeto","next":null,"parent":"d","inputs":{"SIZE":[3,")",[4,"100"]]},"fields":{}},")":{"opcode":"operator_multiply","next":null,"parent":"Z","inputs":{"NUM1":[3,"*",[4,""]],"NUM2":[1,[4,"110"]]},"fields":{}},"*":{"opcode":"operator_divide","next":null,"parent":")","inputs":{"NUM1":[3,"bo",[4,""]],"NUM2":[1,[4,"360"]]},"fields":{}},"bo":{"opcode":"dogeiscutResolution_suggestedStageWidth","next":null,"parent":"*","inputs":{},"fields":{}},"V":{"opcode":"looks_gotofrontback","next":"bp","parent":"U","inputs":{},"fields":{"FRONT_BACK":["back",null]}},"bp":{"opcode":"event_broadcast","next":null,"parent":"V","inputs":{"BROADCAST_INPUT":[1,[11,"set.layer.block","3fIKQ4]58a.JeaP9kj9}"]]},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"GameBackgrounds","bitmapResolution":1,"dataFormat":"svg","assetId":"743ec86d003b7ddd0432663d8ca21832","md5ext":"743ec86d003b7ddd0432663d8ca21832.svg","rotationCenterX":1564.2948409021433,"rotationCenterY":807.4489476276277}],"sounds":[],"volume":100,"layerOrder":1,"visible":true,"x":0,"y":0,"size":156.97916666666666,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"BlocksData","variables":{},"lists":{},"broadcasts":{},"blocks":{"bq":{"opcode":"event_whenflagclicked","next":"+","parent":null,"inputs":{},"fields":{},"topLevel":true},",":{"opcode":"data_deletealloflist","next":"-","parent":"+","inputs":{},"fields":{"LIST":["Blocks_Durability","f%?~*0|CMZ#9Gw5K.lPB"]}},".":{"opcode":"data_deletealloflist","next":":","parent":"/","inputs":{},"fields":{"LIST":["Blocks_Level","*j1uYHafC(5U/WZ7Lq:8"]}},"/":{"opcode":"data_deletealloflist","next":".","parent":"-","inputs":{},"fields":{"LIST":["Blocks_Max_Points","Z2ySSm4q(=ZgQ0Q0lZm6"]}},"-":{"opcode":"data_deletealloflist","next":"/","parent":",","inputs":{},"fields":{"LIST":["Blocks_Min_Points","_PgJKa(WzR+~-iY1.YNl"]}},"+":{"opcode":"data_deletealloflist","next":",","parent":"bq","inputs":{},"fields":{"LIST":["Blocks_Name","WIOYQtk8ni%a=uy4-5E;"]}},";":{"opcode":"data_addtolist","next":"=","parent":"o","inputs":{"ITEM":[1,[10,"dirt"]]},"fields":{"LIST":["Blocks_Name","WIOYQtk8ni%a=uy4-5E;"]}},"br":{"opcode":"event_broadcast","next":null,"parent":"?","inputs":{"BROADCAST_INPUT":[1,[11,"place.new.block","]Y!iYLN$]R@W]Z(q*R1!"]]},"fields":{}},"bs":{"opcode":"event_whenbroadcastreceived","next":"o","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["load.block.data","2NuA11W#_C}+?0gcS/IY"]},"topLevel":true},"=":{"opcode":"data_addtolist","next":"@","parent":";","inputs":{"ITEM":[1,[10,"50"]]},"fields":{"LIST":["Blocks_Durability","f%?~*0|CMZ#9Gw5K.lPB"]}},"@":{"opcode":"data_addtolist","next":"[","parent":"=","inputs":{"ITEM":[1,[10,"1 2"]]},"fields":{"LIST":["Blocks_Level","*j1uYHafC(5U/WZ7Lq:8"]}},"[":{"opcode":"data_addtolist","next":"bt","parent":"@","inputs":{"ITEM":[1,[10,"1"]]},"fields":{"LIST":["Blocks_Min_Points","_PgJKa(WzR+~-iY1.YNl"]}},"bt":{"opcode":"data_addtolist","next":null,"parent":"[","inputs":{"ITEM":[1,[10,"1"]]},"fields":{"LIST":["Blocks_Max_Points","Z2ySSm4q(=ZgQ0Q0lZm6"]}},"o":{"opcode":"lmscomments_commentC","next":"]","parent":"bs","inputs":{"COMMENT":[1,[10,"dirt"]],"SUBSTACK":[2,";"]},"fields":{}},"]":{"opcode":"lmscomments_commentC","next":null,"parent":"o","inputs":{"COMMENT":[1,[10,"stone"]],"SUBSTACK":[2,"^"]},"fields":{}},"^":{"opcode":"data_addtolist","next":"_","parent":"]","inputs":{"ITEM":[1,[10,"stone"]]},"fields":{"LIST":["Blocks_Name","WIOYQtk8ni%a=uy4-5E;"]}},"_":{"opcode":"data_addtolist","next":"`","parent":"^","inputs":{"ITEM":[1,[10,"150"]]},"fields":{"LIST":["Blocks_Durability","f%?~*0|CMZ#9Gw5K.lPB"]}},"`":{"opcode":"data_addtolist","next":"{","parent":"_","inputs":{"ITEM":[1,[10,"1 2 3 4"]]},"fields":{"LIST":["Blocks_Level","*j1uYHafC(5U/WZ7Lq:8"]}},"{":{"opcode":"data_addtolist","next":"bu","parent":"`","inputs":{"ITEM":[1,[10,"1"]]},"fields":{"LIST":["Blocks_Min_Points","_PgJKa(WzR+~-iY1.YNl"]}},"bu":{"opcode":"data_addtolist","next":null,"parent":"{","inputs":{"ITEM":[1,[10,"2"]]},"fields":{"LIST":["Blocks_Max_Points","Z2ySSm4q(=ZgQ0Q0lZm6"]}},":":{"opcode":"event_broadcastandwait","next":"|","parent":".","inputs":{"BROADCAST_INPUT":[1,[11,"load.block.data","2NuA11W#_C}+?0gcS/IY"]]},"fields":{}},"?":{"opcode":"data_setvariableto","next":"br","parent":"|","inputs":{"VALUE":[1,[10,"1"]]},"fields":{"VARIABLE":["Level","VzGD}tm][hTNoS5x:Ibv"]}},"|":{"opcode":"data_setvariableto","next":"?","parent":":","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["Points","`GVD.c1UE9DZ{3mjeUd7"]}}},"comments":{},"currentCostume":0,"costumes":[{"name":"","bitmapResolution":1,"dataFormat":"svg","assetId":"3339a2953a3bf62bb80e54ff575dbced","md5ext":"3339a2953a3bf62bb80e54ff575dbced.svg","rotationCenterX":0,"rotationCenterY":0}],"sounds":[],"volume":100,"layerOrder":2,"visible":true,"x":36,"y":28,"size":100,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Block","variables":{"fS?/^dy,R.4~R07Q8K55":["i",2]},"lists":{},"broadcasts":{},"blocks":{"}":{"opcode":"data_deletealloflist","next":"~","parent":"e","inputs":{},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"bv":{"opcode":"event_whenbroadcastreceived","next":"aa","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["set.layer.block","3fIKQ4]58a.JeaP9kj9}"]},"topLevel":true},"ab":{"opcode":"looks_gotofrontback","next":"bw","parent":"aa","inputs":{},"fields":{"FRONT_BACK":["front",null]}},"bx":{"opcode":"event_whenflagclicked","next":"ac","parent":null,"inputs":{},"fields":{},"topLevel":true},"ac":{"opcode":"looks_hide","next":"ad","parent":"bx","inputs":{},"fields":{}},"ad":{"opcode":"looks_setsizeto","next":"by","parent":"ac","inputs":{"SIZE":[1,[4,"225"]]},"fields":{}},"by":{"opcode":"motion_gotoxy","next":null,"parent":"ad","inputs":{"X":[1,[4,"0"]],"Y":[1,[4,"0"]]},"fields":{}},"bz":{"opcode":"event_whenbroadcastreceived","next":"e","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["place.new.block","]Y!iYLN$]R@W]Z(q*R1!"]},"topLevel":true},"~":{"opcode":"data_setvariableto","next":"f","parent":"}","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["i","fS?/^dy,R.4~R07Q8K55"]}},"f":{"opcode":"control_repeat","next":"g","parent":"~","inputs":{"TIMES":[3,"bA",[6,"10"]],"SUBSTACK":[2,"ae"]},"fields":{}},"bA":{"opcode":"data_lengthoflist","next":null,"parent":"f","inputs":{},"fields":{"LIST":["Blocks_Name","WIOYQtk8ni%a=uy4-5E;"]}},"ae":{"opcode":"data_changevariableby","next":"p","parent":"f","inputs":{"VALUE":[1,[4,"1"]]},"fields":{"VARIABLE":["i","fS?/^dy,R.4~R07Q8K55"]}},"p":{"opcode":"control_if","next":null,"parent":"ae","inputs":{"CONDITION":[2,"af"],"SUBSTACK":[2,"bB"]},"fields":{}},"bC":{"opcode":"data_itemoflist","next":null,"parent":"af","inputs":{"INDEX":[3,[12,"i","fS?/^dy,R.4~R07Q8K55"],[7,"1"]]},"fields":{"LIST":["Blocks_Level","*j1uYHafC(5U/WZ7Lq:8"]}},"af":{"opcode":"operator_contains","next":null,"parent":"p","inputs":{"STRING1":[3,"bC",[10,"jab≈Çko"]],"STRING2":[3,[12,"Level","VzGD}tm][hTNoS5x:Ibv"],[10,"j"]]},"fields":{}},"bB":{"opcode":"data_addtolist","next":null,"parent":"p","inputs":{"ITEM":[3,[12,"i","fS?/^dy,R.4~R07Q8K55"],[10,"1"]]},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"g":{"opcode":"control_if","next":"q","parent":"f","inputs":{"CONDITION":[2,"ag"],"SUBSTACK":[2,"bD"]},"fields":{}},"bE":{"opcode":"data_lengthoflist","next":null,"parent":"ag","inputs":{},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"ag":{"opcode":"operator_lt","next":null,"parent":"g","inputs":{"OPERAND1":[3,"bE",[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"bD":{"opcode":"data_addtolist","next":null,"parent":"g","inputs":{"ITEM":[1,[10,"1"]]},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"q":{"opcode":"data_setvariableto","next":"r","parent":"g","inputs":{"VALUE":[3,"ah",[10,"0"]]},"fields":{"VARIABLE":["random","E!S4pt-5(1v~!0da|;Yl"]}},"ah":{"opcode":"operator_random","next":null,"parent":"q","inputs":{"FROM":[1,[4,"1"]],"TO":[3,"bF",[4,"10"]]},"fields":{}},"bF":{"opcode":"data_lengthoflist","next":null,"parent":"ah","inputs":{},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"r":{"opcode":"data_setvariableto","next":"s","parent":"q","inputs":{"VALUE":[3,"bG",[10,"0"]]},"fields":{"VARIABLE":["Block_ID","fZqCs~PLs3uoIz/[2_|J"]}},"bG":{"opcode":"data_itemoflist","next":null,"parent":"r","inputs":{"INDEX":[3,[12,"random","E!S4pt-5(1v~!0da|;Yl"],[7,"1"]]},"fields":{"LIST":["Blocks_Temp","ze.71iygbyS6;SsB_zf|"]}},"s":{"opcode":"looks_switchcostumeto","next":"t","parent":"r","inputs":{"COSTUME":[3,"bH","bI"]},"fields":{}},"bI":{"opcode":"looks_costume","next":null,"parent":null,"inputs":{},"fields":{"COSTUME":["stone",null]},"shadow":true,"topLevel":true},"bH":{"opcode":"data_itemoflist","next":null,"parent":"s","inputs":{"INDEX":[3,[12,"Block_ID","fZqCs~PLs3uoIz/[2_|J"],[7,"1"]]},"fields":{"LIST":["Blocks_Name","WIOYQtk8ni%a=uy4-5E;"]}},"t":{"opcode":"data_setvariableto","next":"ai","parent":"s","inputs":{"VALUE":[3,"bJ",[10,"0"]]},"fields":{"VARIABLE":["MaxBreakStage","3!B/9WIw.uf6;X`p_;cu"]}},"bJ":{"opcode":"data_itemoflist","next":null,"parent":"t","inputs":{"INDEX":[3,[12,"Block_ID","fZqCs~PLs3uoIz/[2_|J"],[7,"1"]]},"fields":{"LIST":["Blocks_Durability","f%?~*0|CMZ#9Gw5K.lPB"]}},"ai":{"opcode":"data_setvariableto","next":"aj","parent":"t","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["BreakStage","d,Ba6-.Jr6`h)xl2s,OI"]}},"aj":{"opcode":"looks_seteffectto","next":"bK","parent":"ai","inputs":{"VALUE":[1,[4,"0"]]},"fields":{"EFFECT":["BRIGHTNESS",null]}},"bK":{"opcode":"looks_show","next":null,"parent":"aj","inputs":{},"fields":{}},"bw":{"opcode":"event_broadcast","next":null,"parent":"ab","inputs":{"BROADCAST_INPUT":[1,[11,"set.layer.block.break.overlay","!fjwSPu`wRm/]?-*L7ow"]]},"fields":{}},"ak":{"opcode":"tw_getButtonIsDown","next":null,"parent":"u","inputs":{"MOUSE_BUTTON":[1,"bL"]},"fields":{}},"bL":{"opcode":"tw_menu_mouseButton","next":null,"parent":"ak","inputs":{},"fields":{"mouseButton":["0",null]},"shadow":true},"bM":{"opcode":"event_whenflagclicked","next":"al","parent":null,"inputs":{},"fields":{},"topLevel":true},"al":{"opcode":"control_forever","next":null,"parent":"bM","inputs":{"SUBSTACK":[2,"h"]},"fields":{}},"h":{"opcode":"control_if_else","next":null,"parent":"al","inputs":{"CONDITION":[2,"u"],"SUBSTACK":[2,"am"],"SUBSTACK2":[2,"bN"]},"fields":{}},"u":{"opcode":"operator_and","next":null,"parent":"h","inputs":{"OPERAND2":[2,"an"],"OPERAND1":[2,"ak"]},"fields":{}},"am":{"opcode":"data_changevariableby","next":"v","parent":"h","inputs":{"VALUE":[1,[4,"1"]]},"fields":{"VARIABLE":["BreakStage","d,Ba6-.Jr6`h)xl2s,OI"]}},"v":{"opcode":"control_if","next":null,"parent":"am","inputs":{"CONDITION":[2,"bO"],"SUBSTACK":[2,"ao"]},"fields":{}},"bO":{"opcode":"operator_gt","next":null,"parent":"v","inputs":{"OPERAND1":[3,[12,"BreakStage","d,Ba6-.Jr6`h)xl2s,OI"],[10,""]],"OPERAND2":[3,[12,"MaxBreakStage","3!B/9WIw.uf6;X`p_;cu"],[10,"50"]]},"fields":{}},"ap":{"opcode":"data_setvariableto","next":"aq","parent":"ao","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["BreakStage","d,Ba6-.Jr6`h)xl2s,OI"]}},"aq":{"opcode":"looks_hide","next":"w","parent":"ap","inputs":{},"fields":{}},"bP":{"opcode":"operator_random","next":null,"parent":"x","inputs":{"FROM":[3,[12,"minPoints","(p+d9kHP;,5r1Oz/e)h("],[4,"1"]],"TO":[3,[12,"maxPoints","@ixQ9+%M=vAl%ZwAJ^pH"],[4,"10"]]},"fields":{}},"bQ":{"opcode":"data_itemoflist","next":null,"parent":"w","inputs":{"INDEX":[3,[12,"Block_ID","fZqCs~PLs3uoIz/[2_|J"],[7,"1"]]},"fields":{"LIST":["Blocks_Min_Points","_PgJKa(WzR+~-iY1.YNl"]}},"w":{"opcode":"data_setvariableto","next":"y","parent":"aq","inputs":{"VALUE":[3,"bQ",[10,"0"]]},"fields":{"VARIABLE":["minPoints","(p+d9kHP;,5r1Oz/e)h("]}},"y":{"opcode":"data_setvariableto","next":"x","parent":"w","inputs":{"VALUE":[3,"bR",[10,"0"]]},"fields":{"VARIABLE":["maxPoints","@ixQ9+%M=vAl%ZwAJ^pH"]}},"bR":{"opcode":"data_itemoflist","next":null,"parent":"y","inputs":{"INDEX":[3,[12,"Block_ID","fZqCs~PLs3uoIz/[2_|J"],[7,"1"]]},"fields":{"LIST":["Blocks_Max_Points","Z2ySSm4q(=ZgQ0Q0lZm6"]}},"ar":{"opcode":"data_changevariableby","next":"as","parent":"x","inputs":{"VALUE":[3,[12,"setPoints","gYS].7@afa{v{n;o;7X["],[4,"1"]]},"fields":{"VARIABLE":["Points","`GVD.c1UE9DZ{3mjeUd7"]}},"an":{"opcode":"sensing_touchingobject","next":null,"parent":"u","inputs":{"TOUCHINGOBJECTMENU":[1,"bS"]},"fields":{}},"bS":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"an","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["_mouse_",null]},"shadow":true},"at":{"opcode":"event_broadcast","next":"au","parent":"as","inputs":{"BROADCAST_INPUT":[1,[11,"place.new.block","]Y!iYLN$]R@W]Z(q*R1!"]]},"fields":{}},"bN":{"opcode":"data_setvariableto","next":null,"parent":"h","inputs":{"VALUE":[1,[10,"0"]]},"fields":{"VARIABLE":["BreakStage","d,Ba6-.Jr6`h)xl2s,OI"]}},"e":{"opcode":"motion_gotoxy","next":"}","parent":"bz","inputs":{"X":[3,"bT",[4,"0"]],"Y":[3,"bU",[4,"0"]]},"fields":{}},"bT":{"opcode":"operator_random","next":null,"parent":"e","inputs":{"FROM":[1,[4,"-40"]],"TO":[1,[4,"40"]]},"fields":{}},"bU":{"opcode":"operator_random","next":null,"parent":"e","inputs":{"FROM":[1,[4,"-40"]],"TO":[1,[4,"40"]]},"fields":{}},"av":{"opcode":"operator_not","next":null,"parent":"au","inputs":{"OPERAND":[2,"aw"]},"fields":{}},"c#":{"opcode":"event_whenflagclicked","next":null,"parent":null,"inputs":{},"fields":{},"topLevel":true},"au":{"opcode":"control_wait_until","next":null,"parent":"at","inputs":{"CONDITION":[2,"av"]},"fields":{}},"aw":{"opcode":"tw_getButtonIsDown","next":null,"parent":"av","inputs":{"MOUSE_BUTTON":[1,"bV"]},"fields":{}},"bV":{"opcode":"tw_menu_mouseButton","next":null,"parent":"aw","inputs":{},"fields":{"mouseButton":["0",null]},"shadow":true},"as":{"opcode":"event_broadcast","next":"at","parent":"ar","inputs":{"BROADCAST_INPUT":[1,[11,"breaked.block","EGr=3j|Q$6K90x,blkX3"]]},"fields":{}},"x":{"opcode":"data_setvariableto","next":"ar","parent":"y","inputs":{"VALUE":[3,"bP",[10,"0"]]},"fields":{"VARIABLE":["setPoints","gYS].7@afa{v{n;o;7X["]}},"aa":{"opcode":"control_wait","next":"ab","parent":"bv","inputs":{"DURATION":[1,[5,"0.01"]]},"fields":{}},"ao":{"opcode":"event_broadcast","next":"ap","parent":"v","inputs":{"BROADCAST_INPUT":[1,[11,"spawn.particles","`cZZNkAZ^^hQ0_^mu3o?"]]},"fields":{}}},"comments":{},"currentCostume":1,"costumes":[{"name":"dirt","bitmapResolution":1,"dataFormat":"svg","assetId":"db851c06a552f15ee06befc5e185e6d0","md5ext":"db851c06a552f15ee06befc5e185e6d0.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"stone","bitmapResolution":1,"dataFormat":"svg","assetId":"6fb05c4a0144d36fd14744c2803b77b0","md5ext":"6fb05c4a0144d36fd14744c2803b77b0.svg","rotationCenterX":8,"rotationCenterY":8}],"sounds":[],"volume":100,"layerOrder":6,"visible":true,"x":1,"y":-13,"size":225,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"BlockBreakOverlay","variables":{"P1;P5_yL^F=l$@Gc^z^.":["costiume_number",10]},"lists":{},"broadcasts":{},"blocks":{"bW":{"opcode":"event_whenbroadcastreceived","next":"bX","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["set.layer.block.break.overlay","!fjwSPu`wRm/]?-*L7ow"]},"topLevel":true},"bX":{"opcode":"looks_gotofrontback","next":null,"parent":"bW","inputs":{},"fields":{"FRONT_BACK":["front"]}},"bY":{"opcode":"event_whenflagclicked","next":"ax","parent":null,"inputs":{},"fields":{},"topLevel":true},"ax":{"opcode":"motion_gotoxy","next":"ay","parent":"bY","inputs":{"X":[1,[4,"0"]],"Y":[1,[4,"0"]]},"fields":{}},"ay":{"opcode":"looks_setsizeto","next":"z","parent":"ax","inputs":{"SIZE":[1,[4,"225"]]},"fields":{}},"z":{"opcode":"looks_switchcostumeto","next":"bZ","parent":"ay","inputs":{"COSTUME":[1,"b!"]},"fields":{}},"b!":{"opcode":"looks_costume","next":null,"parent":"z","inputs":{},"fields":{"COSTUME":["1",null]},"shadow":true},"b#":{"opcode":"event_whenflagclicked","next":"az","parent":null,"inputs":{},"fields":{},"topLevel":true},"az":{"opcode":"control_forever","next":null,"parent":"b#","inputs":{"SUBSTACK":[2,"aA"]},"fields":{}},"aA":{"opcode":"motion_goto","next":null,"parent":"az","inputs":{"TO":[1,"b%"]},"fields":{}},"b%":{"opcode":"motion_goto_menu","next":null,"parent":"aA","inputs":{},"fields":{"TO":["Block",null]},"shadow":true},"i":{"opcode":"control_if_else","next":null,"parent":"aB","inputs":{"CONDITION":[2,"b("],"SUBSTACK":[2,"b)"],"SUBSTACK2":[2,"aC"]},"fields":{}},"b*":{"opcode":"event_whenflagclicked","next":"aB","parent":null,"inputs":{},"fields":{},"topLevel":true},"aB":{"opcode":"control_forever","next":null,"parent":"b*","inputs":{"SUBSTACK":[2,"i"]},"fields":{}},"b+":{"opcode":"looks_switchcostumeto","next":null,"parent":"j","inputs":{"COSTUME":[3,[12,"costiume_number","P1;P5_yL^F=l$@Gc^z^."],"b,"]},"fields":{}},"b,":{"opcode":"looks_costume","next":null,"parent":null,"inputs":{},"fields":{"COSTUME":["10",null]},"shadow":true,"topLevel":true},"A":{"opcode":"data_setvariableto","next":"k","parent":"aC","inputs":{"VALUE":[3,"aD",[10,"0"]]},"fields":{"VARIABLE":["costiume_number","P1;P5_yL^F=l$@Gc^z^."]}},"aD":{"opcode":"operator_round","next":null,"parent":"A","inputs":{"NUM":[3,"aE",[4,""]]},"fields":{}},"b-":{"opcode":"operator_divide","next":null,"parent":"aE","inputs":{"NUM1":[3,[12,"BreakStage","d,Ba6-.Jr6`h)xl2s,OI"],[4,""]],"NUM2":[3,[12,"MaxBreakStage","3!B/9WIw.uf6;X`p_;cu"],[4,""]]},"fields":{}},"aE":{"opcode":"operator_multiply","next":null,"parent":"aD","inputs":{"NUM1":[3,"b-",[4,""]],"NUM2":[1,[4,"10"]]},"fields":{}},"aC":{"opcode":"looks_show","next":"A","parent":"i","inputs":{},"fields":{}},"b)":{"opcode":"looks_hide","next":null,"parent":"i","inputs":{},"fields":{}},"b(":{"opcode":"operator_lt","next":null,"parent":"i","inputs":{"OPERAND1":[3,[12,"BreakStage","d,Ba6-.Jr6`h)xl2s,OI"],[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"k":{"opcode":"control_if","next":"j","parent":"A","inputs":{"CONDITION":[2,"b."],"SUBSTACK":[2,"b/"]},"fields":{}},"b.":{"opcode":"operator_gt","next":null,"parent":"k","inputs":{"OPERAND1":[3,[12,"costiume_number","P1;P5_yL^F=l$@Gc^z^."],[10,""]],"OPERAND2":[1,[10,"10"]]},"fields":{}},"b/":{"opcode":"data_setvariableto","next":null,"parent":"k","inputs":{"VALUE":[1,[10,"10"]]},"fields":{"VARIABLE":["costiume_number","P1;P5_yL^F=l$@Gc^z^."]}},"j":{"opcode":"control_if","next":"b+","parent":"k","inputs":{"CONDITION":[2,"b:"],"SUBSTACK":[2,"b;"]},"fields":{}},"b;":{"opcode":"data_setvariableto","next":null,"parent":"j","inputs":{"VALUE":[1,[10,"1"]]},"fields":{"VARIABLE":["costiume_number","P1;P5_yL^F=l$@Gc^z^."]}},"b:":{"opcode":"operator_lt","next":null,"parent":"j","inputs":{"OPERAND1":[3,[12,"costiume_number","P1;P5_yL^F=l$@Gc^z^."],[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"bZ":{"opcode":"looks_seteffectto","next":null,"parent":"z","inputs":{"VALUE":[1,[4,"20"]]},"fields":{"EFFECT":["GHOST",null]}}},"comments":{},"currentCostume":0,"costumes":[{"name":"1","bitmapResolution":1,"dataFormat":"svg","assetId":"152dda0723c5085e41e978e990ae8462","md5ext":"152dda0723c5085e41e978e990ae8462.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"2","bitmapResolution":1,"dataFormat":"svg","assetId":"d29106820f76597ba115ff2f2edb2a65","md5ext":"d29106820f76597ba115ff2f2edb2a65.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"3","bitmapResolution":1,"dataFormat":"svg","assetId":"3e08d5bcd2edfcb828b1fbc80f3133f7","md5ext":"3e08d5bcd2edfcb828b1fbc80f3133f7.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"4","bitmapResolution":1,"dataFormat":"svg","assetId":"232c129f3f8d52ae33fe34aa55784422","md5ext":"232c129f3f8d52ae33fe34aa55784422.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"5","bitmapResolution":1,"dataFormat":"svg","assetId":"77eff2a34e992dc01363aac5b1ad5c88","md5ext":"77eff2a34e992dc01363aac5b1ad5c88.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"6","bitmapResolution":1,"dataFormat":"svg","assetId":"22e9e7fd0d68f7a7e19d265871fcb639","md5ext":"22e9e7fd0d68f7a7e19d265871fcb639.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"7","bitmapResolution":1,"dataFormat":"svg","assetId":"b6e6fbf9c176f2ac10e82acfbaf22eab","md5ext":"b6e6fbf9c176f2ac10e82acfbaf22eab.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"8","bitmapResolution":1,"dataFormat":"svg","assetId":"2faea3e9c395bd8282853e7cea6d072d","md5ext":"2faea3e9c395bd8282853e7cea6d072d.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"9","bitmapResolution":1,"dataFormat":"svg","assetId":"197a1597cf8b55b7bc3a7e4a7564b53a","md5ext":"197a1597cf8b55b7bc3a7e4a7564b53a.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"10","bitmapResolution":1,"dataFormat":"svg","assetId":"705ce9ababfb64c48fc7ce83b8e6c537","md5ext":"705ce9ababfb64c48fc7ce83b8e6c537.svg","rotationCenterX":8,"rotationCenterY":8}],"sounds":[],"volume":100,"layerOrder":7,"visible":false,"x":1,"y":-13,"size":225,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"PointsDisplay","variables":{},"lists":{},"broadcasts":{},"blocks":{"b=":{"opcode":"event_whenflagclicked","next":"aF","parent":null,"inputs":{},"fields":{},"topLevel":true},"aF":{"opcode":"control_forever","next":null,"parent":"b=","inputs":{"SUBSTACK":[2,"B"]},"fields":{}},"B":{"opcode":"SPdisplayTextV2_printTxt","next":"C","parent":"aF","inputs":{"TXT":[3,"b?",[10,"hello world"]],"ID":[1,[10,"pointsCounter"]]},"fields":{}},"b?":{"opcode":"operator_join","next":null,"parent":"B","inputs":{"STRING1":[1,[10,"$ "]],"STRING2":[3,[12,"Points","`GVD.c1UE9DZ{3mjeUd7"],[10,"banan"]]},"fields":{}},"C":{"opcode":"SPdisplayTextV2_setTextFont","next":"D","parent":"B","inputs":{"ID":[1,[10,"pointsCounter"]],"FONT":[1,"b@"]},"fields":{}},"b@":{"opcode":"SPdisplayTextV2_menu_FONTS","next":null,"parent":"C","inputs":{},"fields":{"FONTS":["\"Minecraft Ten v2\", Sans Serif",null]},"shadow":true},"D":{"opcode":"SPdisplayTextV2_setTextAlign","next":"aG","parent":"C","inputs":{"ID":[1,[10,"pointsCounter"]],"ALIGNMENT":[1,"b["]},"fields":{}},"b[":{"opcode":"SPdisplayTextV2_menu_ALIGNMENTS","next":null,"parent":"D","inputs":{},"fields":{"ALIGNMENTS":["start",null]},"shadow":true},"aG":{"opcode":"SPdisplayTextV2_setFontSize","next":"b]","parent":"D","inputs":{"ID":[1,[10,"pointsCounter"]],"NUM":[1,[4,"25"]]},"fields":{}},"b]":{"opcode":"SPdisplayTextV2_setTextColor","next":null,"parent":"aG","inputs":{"ID":[1,[10,"pointsCounter"]],"COLOR":[1,[9,"#ffffff"]]},"fields":{}},"b^":{"opcode":"event_whenflagclicked","next":"b_","parent":null,"inputs":{},"fields":{},"topLevel":true},"b_":{"opcode":"procedures_call","next":null,"parent":"b^","inputs":{},"fields":{},"mutation":{"tagName":"mutation","children":[],"proccode":"counterMach","argumentids":"[]","warp":"true"}},"b`":{"opcode":"dogeiscutResolution_whenWindowResized","next":"b{","parent":null,"inputs":{},"fields":{},"topLevel":true},"b{":{"opcode":"procedures_call","next":null,"parent":"b`","inputs":{},"fields":{},"mutation":{"tagName":"mutation","children":[],"proccode":"counterMach","argumentids":"[]","warp":"true"}},"aH":{"opcode":"procedures_definition","next":"E","parent":null,"inputs":{"custom_block":[1,"b|"]},"fields":{},"topLevel":true},"b|":{"opcode":"procedures_prototype","next":null,"parent":"aH","inputs":{},"fields":{},"shadow":true,"mutation":{"tagName":"mutation","children":[],"proccode":"counterMach","argumentids":"[]","argumentnames":"[]","argumentdefaults":"[]","warp":"true"}},"E":{"opcode":"SPdisplayTextV2_setTextPosition","next":null,"parent":"aH","inputs":{"ID":[1,[10,"pointsCounter"]],"x":[3,"aI",[4,"0"]],"y":[3,"aJ",[4,"0"]]},"fields":{}},"aI":{"opcode":"truefantommath_negative_block","next":null,"parent":"E","inputs":{"A":[3,"aK",[4,""]]},"fields":{}},"aK":{"opcode":"dogeiscutResolution_stageAnchorX","next":null,"parent":"aI","inputs":{"PERCENT":[1,[4,"99"]],"WIDTH":[3,"b}",[4,"685"]]},"fields":{}},"b}":{"opcode":"dogeiscutResolution_suggestedStageWidth","next":null,"parent":"aK","inputs":{},"fields":{}},"aJ":{"opcode":"dogeiscutResolution_stageAnchorY","next":null,"parent":"E","inputs":{"PERCENT":[1,[4,"95"]],"HEIGHT":[3,"b~",[4,"360"]]},"fields":{}},"b~":{"opcode":"dogeiscutResolution_suggestedStageHeight","next":null,"parent":"aJ","inputs":{},"fields":{}}},"comments":{},"currentCostume":0,"costumes":[{"name":"","bitmapResolution":1,"dataFormat":"svg","assetId":"3339a2953a3bf62bb80e54ff575dbced","md5ext":"3339a2953a3bf62bb80e54ff575dbced.svg","rotationCenterX":0,"rotationCenterY":0}],"sounds":[],"volume":100,"layerOrder":3,"visible":true,"x":0,"y":180,"size":100,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"BlockOutline","variables":{},"lists":{},"broadcasts":{},"blocks":{"ca":{"opcode":"event_whenbroadcastreceived","next":"cb","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["set.layer.block.break.overlay","!fjwSPu`wRm/]?-*L7ow"]},"topLevel":true},"cb":{"opcode":"looks_gotofrontback","next":null,"parent":"ca","inputs":{},"fields":{"FRONT_BACK":["front"]}},"cc":{"opcode":"event_whenflagclicked","next":"aL","parent":null,"inputs":{},"fields":{},"topLevel":true},"aL":{"opcode":"control_forever","next":null,"parent":"cc","inputs":{"SUBSTACK":[2,"aM"]},"fields":{}},"aM":{"opcode":"motion_goto","next":null,"parent":"aL","inputs":{"TO":[1,"cd"]},"fields":{}},"cd":{"opcode":"motion_goto_menu","next":null,"parent":"aM","inputs":{},"fields":{"TO":["Block",null]},"shadow":true},"ce":{"opcode":"event_whenflagclicked","next":"aN","parent":null,"inputs":{},"fields":{},"topLevel":true},"aN":{"opcode":"control_forever","next":null,"parent":"ce","inputs":{"SUBSTACK":[2,"l"]},"fields":{}},"l":{"opcode":"control_if_else","next":null,"parent":"aN","inputs":{"CONDITION":[2,"F"],"SUBSTACK":[2,"cf"],"SUBSTACK2":[2,"cg"]},"fields":{}},"F":{"opcode":"HyperSense2SP_spriteTouchingSprite","next":null,"parent":"l","inputs":{"SPRITE1":[1,"ch"],"SPRITE2":[1,"ci"]},"fields":{}},"ch":{"opcode":"HyperSense2SP_menu_OBJECTS","next":null,"parent":"F","inputs":{},"fields":{"OBJECTS":["_mouse_",null]},"shadow":true},"ci":{"opcode":"HyperSense2SP_menu_ALL_TARGETS","next":null,"parent":"F","inputs":{},"fields":{"ALL_TARGETS":["Block",null]},"shadow":true},"cf":{"opcode":"looks_show","next":null,"parent":"l","inputs":{},"fields":{}},"cg":{"opcode":"looks_hide","next":null,"parent":"l","inputs":{},"fields":{}},"cj":{"opcode":"event_whenflagclicked","next":"aO","parent":null,"inputs":{},"fields":{},"topLevel":true},"aO":{"opcode":"looks_setsizeto","next":"ck","parent":"cj","inputs":{"SIZE":[1,[4,"225"]]},"fields":{}},"ck":{"opcode":"looks_seteffectto","next":null,"parent":"aO","inputs":{"VALUE":[1,[4,"15"]]},"fields":{"EFFECT":["GHOST",null]}}},"comments":{},"currentCostume":0,"costumes":[{"name":"block-outline","bitmapResolution":1,"dataFormat":"svg","assetId":"1bc2abd679fb375b25b9213dde4a6314","md5ext":"1bc2abd679fb375b25b9213dde4a6314.svg","rotationCenterX":9,"rotationCenterY":9}],"sounds":[],"volume":100,"layerOrder":8,"visible":false,"x":1,"y":-13,"size":225,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"PointsDropedDisplay","variables":{},"lists":{},"broadcasts":{},"blocks":{"cl":{"opcode":"event_whenbroadcastreceived","next":"cm","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["set.layer.block","3fIKQ4]58a.JeaP9kj9}"]},"topLevel":true},"cm":{"opcode":"looks_gotofrontback","next":null,"parent":"cl","inputs":{},"fields":{"FRONT_BACK":["front"]}},"cn":{"opcode":"event_whenflagclicked","next":"co","parent":null,"inputs":{},"fields":{},"topLevel":true},"co":{"opcode":"looks_hide","next":null,"parent":"cn","inputs":{},"fields":{}},"G":{"opcode":"text_setText","next":"aQ","parent":"aP","inputs":{"TEXT":[3,"cp",[10,"Welcome to my project!"]]},"fields":{}},"cq":{"opcode":"event_whenbroadcastreceived","next":"aR","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["breaked.block","EGr=3j|Q$6K90x,blkX3"]},"topLevel":true},"c%":[12,"Block_ID","fZqCs~PLs3uoIz/[2_|J",-1065,369],"H":{"opcode":"motion_goto","next":"a","parent":"aR","inputs":{"TO":[1,"cr"]},"fields":{}},"cr":{"opcode":"motion_goto_menu","next":null,"parent":"H","inputs":{},"fields":{"TO":["Block",null]},"shadow":true},"cp":{"opcode":"operator_join","next":null,"parent":"G","inputs":{"STRING1":[1,[10,"+ "]],"STRING2":[3,[12,"setPoints","gYS].7@afa{v{n;o;7X["],[10,"banan"]]},"fields":{}},"aP":{"opcode":"looks_show","next":"G","parent":"aS","inputs":{},"fields":{}},"aQ":{"opcode":"text_setColor","next":"aT","parent":"G","inputs":{"COLOR":[1,[9,"#ffffff"]]},"fields":{}},"aS":{"opcode":"looks_setsizeto","next":"aP","parent":"aU","inputs":{"SIZE":[1,[4,"10"]]},"fields":{}},"I":{"opcode":"control_repeat","next":"aV","parent":"aT","inputs":{"TIMES":[1,[6,"5"]],"SUBSTACK":[2,"aW"]},"fields":{}},"aW":{"opcode":"control_wait","next":"aX","parent":"I","inputs":{"DURATION":[1,[5,"0.01"]]},"fields":{}},"aX":{"opcode":"looks_changesizeby","next":"cs","parent":"aW","inputs":{"CHANGE":[1,[4,"10"]]},"fields":{}},"aU":{"opcode":"looks_seteffectto","next":"aS","parent":"b","inputs":{"VALUE":[1,[4,"100"]]},"fields":{"EFFECT":["GHOST",null]}},"c(":{"opcode":"looks_changesizeby","next":null,"parent":null,"inputs":{"CHANGE":[1,[4,"-10"]]},"fields":{},"topLevel":true},"cs":{"opcode":"looks_changeeffectby","next":null,"parent":"aX","inputs":{"CHANGE":[1,[4,"-20"]]},"fields":{"EFFECT":["GHOST",null]}},"aT":{"opcode":"text_setFont","next":"I","parent":"aQ","inputs":{},"fields":{"FONT":["\"Minecraft Ten v2\", Sans Serif",null]}},"ct":{"opcode":"motion_xposition","next":null,"parent":"cu","inputs":{},"fields":{}},"c)":{"opcode":"motion_yposition","next":null,"parent":null,"inputs":{},"fields":{},"topLevel":true},"cv":{"opcode":"operator_random","next":null,"parent":"aY","inputs":{"FROM":[1,[4,"20"]],"TO":[1,[4,"35"]]},"fields":{}},"cu":{"opcode":"operator_subtract","next":null,"parent":null,"inputs":{"NUM1":[3,"ct",[4,""]],"NUM2":[1,[4,"40"]]},"fields":{},"topLevel":true},"cw":{"opcode":"operator_random","next":null,"parent":"aZ","inputs":{"FROM":[1,[4,"1"]],"TO":[1,[4,"2"]]},"fields":{}},"c*":{"opcode":"operator_subtract","next":null,"parent":null,"inputs":{"NUM1":[1,[4,""]],"NUM2":[1,[4,"40"]]},"fields":{},"topLevel":true},"c+":{"opcode":"operator_add","next":null,"parent":null,"inputs":{"NUM1":[1,[4,""]],"NUM2":[1,[4,"40"]]},"fields":{},"topLevel":true},"c,":{"opcode":"motion_yposition","next":null,"parent":null,"inputs":{},"fields":{},"topLevel":true},"c-":{"opcode":"motion_yposition","next":null,"parent":null,"inputs":{},"fields":{},"topLevel":true},"a!":{"opcode":"control_repeat_until","next":null,"parent":null,"inputs":{"SUBSTACK":[2,"J"],"CONDITION":[2,"a#"]},"fields":{},"topLevel":true},"a#":{"opcode":"operator_not","next":null,"parent":"a!","inputs":{"OPERAND":[2,"a%"]},"fields":{}},"cx":{"opcode":"sensing_touchingobject","next":null,"parent":null,"inputs":{"TOUCHINGOBJECTMENU":[1,"cy"]},"fields":{},"topLevel":true},"cy":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"cx","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["Block",null]},"shadow":true},"c.":{"opcode":"control_if","next":null,"parent":null,"inputs":{"CONDITION":[1,null],"SUBSTACK":[1,null]},"fields":{},"topLevel":true},"a%":{"opcode":"sensing_touchingobject","next":null,"parent":"a#","inputs":{"TOUCHINGOBJECTMENU":[1,"cz"]},"fields":{}},"cz":{"opcode":"sensing_touchingobjectmenu","next":null,"parent":"a%","inputs":{},"fields":{"TOUCHINGOBJECTMENU":["Block",null]},"shadow":true},"J":{"opcode":"motion_gotoxy","next":null,"parent":"a!","inputs":{"X":[3,"K",[4,"0"]],"Y":[3,"L",[4,"0"]]},"fields":{}},"K":{"opcode":"operator_random","next":null,"parent":"J","inputs":{"FROM":[3,"a(",[4,"1"]],"TO":[3,"a)",[4,"10"]]},"fields":{}},"a(":{"opcode":"operator_subtract","next":null,"parent":"K","inputs":{"NUM1":[3,"cA",[4,""]],"NUM2":[1,[4,"40"]]},"fields":{}},"cA":{"opcode":"motion_xposition","next":null,"parent":"a(","inputs":{},"fields":{}},"a)":{"opcode":"operator_add","next":null,"parent":"K","inputs":{"NUM1":[3,"cB",[4,""]],"NUM2":[1,[4,"40"]]},"fields":{}},"cB":{"opcode":"motion_xposition","next":null,"parent":"a)","inputs":{},"fields":{}},"L":{"opcode":"operator_random","next":null,"parent":"J","inputs":{"FROM":[3,"a*",[4,"1"]],"TO":[3,"a+",[4,"10"]]},"fields":{}},"a*":{"opcode":"operator_subtract","next":null,"parent":"L","inputs":{"NUM1":[3,"cC",[4,""]],"NUM2":[1,[4,"40"]]},"fields":{}},"cC":{"opcode":"motion_yposition","next":null,"parent":"a*","inputs":{},"fields":{}},"a+":{"opcode":"operator_add","next":null,"parent":"L","inputs":{"NUM1":[3,"cD",[4,""]],"NUM2":[1,[4,"40"]]},"fields":{}},"cD":{"opcode":"motion_yposition","next":null,"parent":"a+","inputs":{},"fields":{}},"a":{"opcode":"control_if_else","next":"b","parent":"H","inputs":{"CONDITION":[2,"aZ"],"SUBSTACK":[2,"aY"],"SUBSTACK2":[2,"a,"]},"fields":{}},"aZ":{"opcode":"operator_equals","next":null,"parent":"a","inputs":{"OPERAND1":[3,"cw",[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"b":{"opcode":"control_if_else","next":"aU","parent":"a","inputs":{"CONDITION":[2,"a-"],"SUBSTACK":[2,"a."],"SUBSTACK2":[2,"a/"]},"fields":{}},"a-":{"opcode":"operator_equals","next":null,"parent":"b","inputs":{"OPERAND1":[3,"cE",[10,""]],"OPERAND2":[1,[10,"1"]]},"fields":{}},"cE":{"opcode":"operator_random","next":null,"parent":"a-","inputs":{"FROM":[1,[4,"1"]],"TO":[1,[4,"2"]]},"fields":{}},"a.":{"opcode":"motion_sety","next":null,"parent":"b","inputs":{"Y":[3,"cF",[4,"0"]]},"fields":{}},"a/":{"opcode":"motion_sety","next":null,"parent":"b","inputs":{"Y":[3,"a:",[4,"0"]]},"fields":{}},"aV":{"opcode":"control_wait","next":"a;","parent":"I","inputs":{"DURATION":[1,[5,"0.5"]]},"fields":{}},"a;":{"opcode":"control_repeat","next":null,"parent":"aV","inputs":{"TIMES":[1,[6,"5"]],"SUBSTACK":[2,"a="]},"fields":{}},"a=":{"opcode":"control_wait","next":"a?","parent":"a;","inputs":{"DURATION":[1,[5,"0.01"]]},"fields":{}},"a?":{"opcode":"looks_changesizeby","next":"cG","parent":"a=","inputs":{"CHANGE":[1,[4,"-10"]]},"fields":{}},"cG":{"opcode":"looks_changeeffectby","next":null,"parent":"a?","inputs":{"CHANGE":[1,[4,"20"]]},"fields":{"EFFECT":["GHOST",null]}},"aY":{"opcode":"motion_changexby","next":null,"parent":"a","inputs":{"DX":[3,"cv",[4,"10"]]},"fields":{}},"a,":{"opcode":"motion_changexby","next":null,"parent":"a","inputs":{"DX":[3,"a@",[4,"10"]]},"fields":{}},"cH":{"opcode":"operator_random","next":null,"parent":"a@","inputs":{"FROM":[1,[4,"20"]],"TO":[1,[4,"35"]]},"fields":{}},"a@":{"opcode":"truefantommath_negative_block","next":null,"parent":"a,","inputs":{"A":[3,"cH",[4,""]]},"fields":{}},"cF":{"opcode":"operator_random","next":null,"parent":"a.","inputs":{"FROM":[1,[4,"20"]],"TO":[1,[4,"35"]]},"fields":{}},"a:":{"opcode":"truefantommath_negative_block","next":null,"parent":"a/","inputs":{"A":[3,"cI",[4,""]]},"fields":{}},"cI":{"opcode":"operator_random","next":null,"parent":"a:","inputs":{"FROM":[1,[4,"20"]],"TO":[1,[4,"35"]]},"fields":{}},"aR":{"opcode":"looks_gotofrontback","next":"H","parent":"cq","inputs":{},"fields":{"FRONT_BACK":["front",null]}}},"comments":{},"currentCostume":0,"costumes":[{"name":"","bitmapResolution":1,"dataFormat":"svg","assetId":"3339a2953a3bf62bb80e54ff575dbced","md5ext":"3339a2953a3bf62bb80e54ff575dbced.svg","rotationCenterX":0,"rotationCenterY":0}],"sounds":[],"volume":100,"layerOrder":4,"visible":false,"x":36,"y":21,"size":10,"direction":90,"draggable":false,"rotationStyle":"all around"},{"isStage":false,"name":"Particles","variables":{"aY!s||?W@p5I9yW9Li{M":["ParticleSpeedX",0],"!(N(8AFehXE$AoK0B*@3":["ParticleSpeedY",0]},"lists":{},"broadcasts":{},"blocks":{"cJ":{"opcode":"event_whenflagclicked","next":"a[","parent":null,"inputs":{},"fields":{},"topLevel":true},"a[":{"opcode":"looks_seteffectto","next":"cK","parent":"cJ","inputs":{"VALUE":[1,[4,"80"]]},"fields":{"EFFECT":["PIXELATE",null]}},"cK":{"opcode":"looks_hide","next":null,"parent":"a[","inputs":{},"fields":{}},"cL":{"opcode":"event_whenbroadcastreceived","next":"cM","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["set.layer.block","3fIKQ4]58a.JeaP9kj9}"]},"topLevel":true},"cM":{"opcode":"looks_gotofrontback","next":null,"parent":"cL","inputs":{},"fields":{"FRONT_BACK":["front",null]}},"cN":{"opcode":"event_whenbroadcastreceived","next":"a]","parent":null,"inputs":{},"fields":{"BROADCAST_OPTION":["spawn.particles","`cZZNkAZ^^hQ0_^mu3o?"]},"topLevel":true},"a]":{"opcode":"control_repeat","next":null,"parent":"cN","inputs":{"TIMES":[1,[6,"10"]],"SUBSTACK":[2,"a^"]},"fields":{}},"a^":{"opcode":"control_create_clone_of","next":null,"parent":"a]","inputs":{"CLONE_OPTION":[1,"cO"]},"fields":{}},"cO":{"opcode":"control_create_clone_of_menu","next":null,"parent":"a^","inputs":{},"fields":{"CLONE_OPTION":["_myself_",null]},"shadow":true},"cP":{"opcode":"control_start_as_clone","next":"M","parent":null,"inputs":{},"fields":{},"topLevel":true},"M":{"opcode":"motion_goto","next":"N","parent":"cP","inputs":{"TO":[1,"cQ"]},"fields":{}},"cQ":{"opcode":"motion_goto_menu","next":null,"parent":"M","inputs":{},"fields":{"TO":["Block",null]},"shadow":true},"N":{"opcode":"looks_switchcostumeto","next":"a_","parent":"M","inputs":{"COSTUME":[3,"a`","cR"]},"fields":{}},"cR":{"opcode":"looks_costume","next":null,"parent":null,"inputs":{},"fields":{"COSTUME":["stone",null]},"shadow":true,"topLevel":true},"a`":{"opcode":"sensing_of","next":null,"parent":"N","inputs":{"OBJECT":[1,"cS"]},"fields":{"PROPERTY":["costume name",null]}},"cS":{"opcode":"sensing_of_object_menu","next":null,"parent":"a`","inputs":{},"fields":{"OBJECT":["Block",null]},"shadow":true},"a_":{"opcode":"looks_setsizeto","next":"O","parent":"N","inputs":{"SIZE":[1,[4,"30"]]},"fields":{}},"O":{"opcode":"data_setvariableto","next":"P","parent":"a_","inputs":{"VALUE":[3,"cT",[10,"0"]]},"fields":{"VARIABLE":["ParticleSpeedX","aY!s||?W@p5I9yW9Li{M"]}},"cT":{"opcode":"operator_random","next":null,"parent":"O","inputs":{"FROM":[1,[4,"-10"]],"TO":[1,[4,"10"]]},"fields":{}},"P":{"opcode":"data_setvariableto","next":"a{","parent":"O","inputs":{"VALUE":[3,"cU",[10,"0"]]},"fields":{"VARIABLE":["ParticleSpeedY","!(N(8AFehXE$AoK0B*@3"]}},"cU":{"opcode":"operator_random","next":null,"parent":"P","inputs":{"FROM":[1,[4,"5"]],"TO":[1,[4,"15"]]},"fields":{}},"a{":{"opcode":"looks_show","next":"m","parent":"P","inputs":{},"fields":{}},"m":{"opcode":"control_repeat_until","next":"cV","parent":"a{","inputs":{"CONDITION":[2,"Q"],"SUBSTACK":[2,"a|"]},"fields":{}},"Q":{"opcode":"operator_lt","next":null,"parent":"m","inputs":{"OPERAND1":[3,"cW",[10,""]],"OPERAND2":[3,"a}",[10,"50"]]},"fields":{}},"cW":{"opcode":"motion_yposition","next":null,"parent":"Q","inputs":{},"fields":{}},"cX":{"opcode":"dogeiscutResolution_suggestedStageHeight","next":null,"parent":"R","inputs":{},"fields":{}},"R":{"opcode":"dogeiscutResolution_stageEdgePositionY","next":null,"parent":"a}","inputs":{"HEIGHT":[3,"cX",[4,"360"]],"EDGE":[1,"cY"]},"fields":{}},"cY":{"opcode":"dogeiscutResolution_menu_stageEdgeMenu","next":null,"parent":"R","inputs":{},"fields":{"stageEdgeMenu":["bottom edge",null]},"shadow":true},"a}":{"opcode":"operator_subtract","next":null,"parent":"Q","inputs":{"NUM1":[3,"R",[4,""]],"NUM2":[1,[4,"50"]]},"fields":{}},"a|":{"opcode":"motion_changexby","next":"a~","parent":"m","inputs":{"DX":[3,[12,"ParticleSpeedX","aY!s||?W@p5I9yW9Li{M"],[4,"10"]]},"fields":{}},"a~":{"opcode":"motion_changeyby","next":"ba","parent":"a|","inputs":{"DY":[3,[12,"ParticleSpeedY","!(N(8AFehXE$AoK0B*@3"],[4,"10"]]},"fields":{}},"ba":{"opcode":"data_changevariableby","next":"S","parent":"a~","inputs":{"VALUE":[1,[4,"-1"]]},"fields":{"VARIABLE":["ParticleSpeedY","!(N(8AFehXE$AoK0B*@3"]}},"S":{"opcode":"data_setvariableto","next":"cZ","parent":"ba","inputs":{"VALUE":[3,"c!",[10,"0"]]},"fields":{"VARIABLE":["ParticleSpeedX","aY!s||?W@p5I9yW9Li{M"]}},"c!":{"opcode":"operator_multiply","next":null,"parent":"S","inputs":{"NUM1":[3,[12,"ParticleSpeedX","aY!s||?W@p5I9yW9Li{M"],[4,""]],"NUM2":[1,[4,"0.95"]]},"fields":{}},"cZ":{"opcode":"looks_changeeffectby","next":null,"parent":"S","inputs":{"CHANGE":[1,[4,"2"]]},"fields":{"EFFECT":["GHOST",null]}},"cV":{"opcode":"control_delete_this_clone","next":null,"parent":"m","inputs":{},"fields":{}}},"comments":{},"currentCostume":1,"costumes":[{"name":"dirt","bitmapResolution":1,"dataFormat":"svg","assetId":"4428ec5d7b3798b2733550a456716829","md5ext":"4428ec5d7b3798b2733550a456716829.svg","rotationCenterX":8,"rotationCenterY":8},{"name":"stone","bitmapResolution":1,"dataFormat":"svg","assetId":"cd86e3abe736f80ebeea9fe2d762c4af","md5ext":"cd86e3abe736f80ebeea9fe2d762c4af.svg","rotationCenterX":8,"rotationCenterY":8}],"sounds":[],"volume":100,"layerOrder":5,"visible":false,"x":36,"y":28,"size":30,"direction":90,"draggable":false,"rotationStyle":"all around"}],"monitors":[{"id":"WIOYQtk8ni%a=uy4-5E;","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Name"},"spriteName":null,"value":[],"width":100,"height":105,"x":0,"y":5,"visible":false},{"id":"f%?~*0|CMZ#9Gw5K.lPB","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Durability"},"spriteName":null,"value":[],"width":105,"height":103,"x":11.5,"y":5,"visible":false},{"id":"*j1uYHafC(5U/WZ7Lq:8","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Level"},"spriteName":null,"value":[],"width":106,"height":99,"x":124.5,"y":6,"visible":false},{"id":"_PgJKa(WzR+~-iY1.YNl","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Min_Points"},"spriteName":null,"value":[],"width":120,"height":100,"x":237.5,"y":9,"visible":false},{"id":"Z2ySSm4q(=ZgQ0Q0lZm6","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Max_Points"},"spriteName":null,"value":[],"width":100,"height":117,"x":373.5,"y":9,"visible":false},{"id":"ze.71iygbyS6;SsB_zf|","mode":"list","opcode":"data_listcontents","params":{"LIST":"Blocks_Temp"},"spriteName":null,"value":[],"width":0,"height":0,"x":0,"y":117,"visible":false},{"id":"VzGD}tm][hTNoS5x:Ibv","mode":"default","opcode":"data_variable","params":{"VARIABLE":"Level"},"spriteName":null,"value":0,"width":0,"height":0,"x":0,"y":0,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"d,Ba6-.Jr6`h)xl2s,OI","mode":"default","opcode":"data_variable","params":{"VARIABLE":"BreakStage"},"spriteName":null,"value":0,"width":0,"height":0,"x":52.5,"y":115,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"3!B/9WIw.uf6;X`p_;cu","mode":"default","opcode":"data_variable","params":{"VARIABLE":"MaxBreakStage"},"spriteName":null,"value":0,"width":0,"height":0,"x":52.5,"y":115,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"fZqCs~PLs3uoIz/[2_|J","mode":"default","opcode":"data_variable","params":{"VARIABLE":"Block_ID"},"spriteName":null,"value":0,"width":0,"height":0,"x":52.5,"y":115,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"`GVD.c1UE9DZ{3mjeUd7","mode":"default","opcode":"data_variable","params":{"VARIABLE":"Points"},"spriteName":null,"value":0,"width":0,"height":0,"x":0,"y":48,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"fS?/^dy,R.4~R07Q8K55","mode":"default","opcode":"data_variable","params":{"VARIABLE":"i"},"spriteName":"Block","value":0,"width":0,"height":0,"x":0,"y":27,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"E!S4pt-5(1v~!0da|;Yl","mode":"default","opcode":"data_variable","params":{"VARIABLE":"random"},"spriteName":null,"value":0,"width":0,"height":0,"x":0,"y":27,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"P1;P5_yL^F=l$@Gc^z^.","mode":"default","opcode":"data_variable","params":{"VARIABLE":"costiume_number"},"spriteName":"BlockBreakOverlay","value":0,"width":0,"height":0,"x":0,"y":25,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"(p+d9kHP;,5r1Oz/e)h(","mode":"default","opcode":"data_variable","params":{"VARIABLE":"minPoints"},"spriteName":null,"value":0,"width":0,"height":0,"x":0,"y":52,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"gYS].7@afa{v{n;o;7X[","mode":"default","opcode":"data_variable","params":{"VARIABLE":"setPoints"},"spriteName":null,"value":0,"width":0,"height":0,"x":-97.5,"y":5,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"aY!s||?W@p5I9yW9Li{M","mode":"default","opcode":"data_variable","params":{"VARIABLE":"ParticleSpeedX"},"spriteName":"Particles","value":0,"width":0,"height":0,"x":-97.5,"y":5,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true},{"id":"!(N(8AFehXE$AoK0B*@3","mode":"default","opcode":"data_variable","params":{"VARIABLE":"ParticleSpeedY"},"spriteName":"Particles","value":0,"width":0,"height":0,"x":-97.5,"y":5,"visible":false,"sliderMin":0,"sliderMax":100,"isDiscrete":true}],"extensions":["runtimeoptions","dogeiscutResolution","lmscomments","tw","SPdisplayTextV2","truefantommath","HyperSense2SP","text"],"extensionURLs":{"runtimeoptions":"https://extensions.turbowarp.org/runtime-options.js","dogeiscutResolution":"data:text/javascript;base64,Ly8gTmFtZTogUmVzb2x1dGlvbgovLyBJRDogZG9nZWlzY3V0UmVzb2x1dGlvbgovLyBEZXNjcmlwdGlvbjogVXRpbGl0eSBibG9ja3MgdGhhdCBlbmFibGVzIGVhc2UgaW4gY3JlYXRpb24gb2YgcHJvamVjdHMgd2l0aCBkeW5hbWljIHJlc29sdXRpb24uCi8vIEJ5OiBEb2dlaXNDdXQgPGh0dHBzOi8vc2NyYXRjaC5taXQuZWR1L3VzZXJzL0RvZ2Vpc0N1dC8+CgooZnVuY3Rpb24oU2NyYXRjaCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIGlmICghU2NyYXRjaC5leHRlbnNpb25zLnVuc2FuZGJveGVkKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdcJ1Jlc29sdXRpb25cJyBtdXN0IHJ1biB1bnNhbmRib3hlZCEnKTsKICAgIH0KCiAgICBjbGFzcyBSZXNvbHV0aW9uIHsKICAgICAgICBnZXRJbmZvKCkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgaWQ6ICdkb2dlaXNjdXRSZXNvbHV0aW9uJywKICAgICAgICAgICAgICAgIG5hbWU6ICdSZXNvbHV0aW9uJywKICAgICAgICAgICAgICAgIGNvbG9yMTogIiMwMDlkZmYiLAogICAgICAgICAgICAgICAgZG9jc1VSSTogJ2h0dHBzOi8vZXh0ZW5zaW9ucy5wZW5ndWlubW9kLmNvbS9kb2NzL1Jlc29sdXRpb24nLAogICAgICAgICAgICAgICAgYmxvY2tzOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvcGNvZGU6ICd3aGVuV2luZG93UmVzaXplZCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuRVZFTlQsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICd3aGVuIHdpbmRvdyByZXNpemVkJywKICAgICAgICAgICAgICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJy0tLScsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvcGNvZGU6ICdzdWdnZXN0ZWRTdGFnZVdpZHRoJywKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ3N1Z2dlc3RlZCBzdGFnZSB3aWR0aCcsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wY29kZTogJ3N1Z2dlc3RlZFN0YWdlSGVpZ2h0JywKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ3N1Z2dlc3RlZCBzdGFnZSBoZWlnaHQnLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgJy0tLScsCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvcGNvZGU6ICdkZXZpY2VQaXhlbFJhdGlvJywKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2RldmljZSBwaXhlbCByYXRpbycsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAnLS0tJywKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wY29kZTogJ3NjcmVlblJlc29sdXRpb24nLAogICAgICAgICAgICAgICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnc2NyZWVuIHJlc29sdXRpb24gW0RJTV0nLAogICAgICAgICAgICAgICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIERJTTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51OiAnZGltZW5zaW9uTWVudScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnd2lkdGgnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3Bjb2RlOiAnaW5uZXJSZXNvbHV0aW9uJywKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ2lubmVyIHJlc29sdXRpb24gW0RJTV0nLAogICAgICAgICAgICAgICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIERJTTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51OiAnZGltZW5zaW9uTWVudScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAnd2lkdGgnCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICctLS0nLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgb3Bjb2RlOiAnc3RhZ2VFZGdlUG9zaXRpb25YJywKICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ3ggb2YgYSBzdGFnZSB3aXRoIHdpZHRoIFtXSURUSF1cJ3MgW0VER0VdJywKICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXSURUSDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IHRoaXMuc3VnZ2VzdGVkU3RhZ2VXaWR0aCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSEVJR0hUOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5zdWdnZXN0ZWRTdGFnZUhlaWdodCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRURHRTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51OiAnc3RhZ2VFZGdlTWVudScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAndG9wIGxlZnQgY29ybmVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wY29kZTogJ3N0YWdlRWRnZVBvc2l0aW9uWScsCiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICd5IG9mIGEgc3RhZ2Ugd2l0aCBoZWlnaHQgW0hFSUdIVF1cJ3MgW0VER0VdJywKICAgICAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXSURUSDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IHRoaXMuc3VnZ2VzdGVkU3RhZ2VXaWR0aCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSEVJR0hUOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5zdWdnZXN0ZWRTdGFnZUhlaWdodCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgRURHRTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZW51OiAnc3RhZ2VFZGdlTWVudScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiAndG9wIGxlZnQgY29ybmVyJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIG9wY29kZTogJ3N0YWdlQW5jaG9yWCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICd4IG9mIHN0YWdlIGFuY2hvciBhdCBbUEVSQ0VOVF0lIHRvIHRoZSByaWdodCBvZiBhIHN0YWdlIHdpdGggd2lkdGggW1dJRFRIXScsCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgUEVSQ0VOVDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IDUwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgV0lEVEg6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLnN1Z2dlc3RlZFN0YWdlV2lkdGgoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhFSUdIVDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6IHRoaXMuc3VnZ2VzdGVkU3RhZ2VIZWlnaHQoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBvcGNvZGU6ICdzdGFnZUFuY2hvclknLAogICAgICAgICAgICAgICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAneSBvZiBzdGFnZSBhbmNob3IgYXQgW1BFUkNFTlRdJSB0byB0aGUgYm90dG9tIG9mIGEgc3RhZ2Ugd2l0aCBoZWlnaHQgW0hFSUdIVF0nLAogICAgICAgICAgICAgICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBFUkNFTlQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiA1MAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdJRFRIOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZTogdGhpcy5zdWdnZXN0ZWRTdGFnZVdpZHRoKCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIRUlHSFQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdFZhbHVlOiB0aGlzLnN1Z2dlc3RlZFN0YWdlSGVpZ2h0KCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgbWVudXM6IHsKICAgICAgICAgICAgICAgICAgICBkaW1lbnNpb25NZW51OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ3dpZHRoJywgdmFsdWU6ICd3aWR0aCcgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ2hlaWdodCcsIHZhbHVlOiAnaGVpZ2h0JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGF4aXNNZW51OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ3gnLCB2YWx1ZTogJ3gnIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICd5JywgdmFsdWU6ICd5JyB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHN0YWdlRWRnZU1lbnU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAndG9wIGxlZnQgY29ybmVyJywgdmFsdWU6ICd0b3AgbGVmdCBjb3JuZXInIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICd0b3AgZWRnZScsIHZhbHVlOiAndG9wIGVkZ2UnIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICd0b3AgcmlnaHQgY29ybmVyJywgdmFsdWU6ICd0b3AgcmlnaHQgY29ybmVyJyB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB0ZXh0OiAncmlnaHQgZWRnZScsIHZhbHVlOiAncmlnaHQgZWRnZScgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ2JvdHRvbSByaWdodCBjb3JuZXInLCB2YWx1ZTogJ2JvdHRvbSByaWdodCBjb3JuZXInIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICdib3R0b20gZWRnZScsIHZhbHVlOiAnYm90dG9tIGVkZ2UnIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IHRleHQ6ICdib3R0b20gbGVmdCBjb3JuZXInLCB2YWx1ZTogJ2JvdHRvbSBsZWZ0IGNvcm5lcicgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdGV4dDogJ2xlZnQgZWRnZScsIHZhbHVlOiAnbGVmdCBlZGdlJyB9CiAgICAgICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHN1Z2dlc3RlZFN0YWdlV2lkdGgoKSB7CiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTWF0aC5tYXgoMzYwLCBNYXRoLnJvdW5kKCh3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCkgKiAzNjApKTsKICAgICAgICAgICAgcmV0dXJuIHdpZHRoOwogICAgICAgIH0KCiAgICAgICAgc3VnZ2VzdGVkU3RhZ2VIZWlnaHQoKSB7CiAgICAgICAgICAgIGlmICh3aW5kb3cuaW5uZXJIZWlnaHQgPiB3aW5kb3cuaW5uZXJXaWR0aCkgewogICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZCgod2luZG93LmlubmVySGVpZ2h0IC8gd2luZG93LmlubmVyV2lkdGgpICogMzYwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gMzYwOwogICAgICAgIH0KCiAgICAgICAgc2NyZWVuUmVzb2x1dGlvbihhcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IERJTSA9IFNjcmF0Y2guQ2FzdC50b1N0cmluZyhhcmdzLkRJTSk7CiAgICAgICAgICAgIHJldHVybiBESU0gPT09ICd3aWR0aCcgPyB3aW5kb3cuc2NyZWVuLndpZHRoIDogd2luZG93LnNjcmVlbi5oZWlnaHQ7CiAgICAgICAgfQoKICAgICAgICBpbm5lclJlc29sdXRpb24oYXJncykgewogICAgICAgICAgICBjb25zdCBESU0gPSBTY3JhdGNoLkNhc3QudG9TdHJpbmcoYXJncy5ESU0pOwogICAgICAgICAgICByZXR1cm4gRElNID09PSAnd2lkdGgnID8gd2luZG93LmlubmVyV2lkdGggOiB3aW5kb3cuaW5uZXJIZWlnaHQ7CiAgICAgICAgfQoKICAgICAgICBkZXZpY2VQaXhlbFJhdGlvKCkgewogICAgICAgICAgICByZXR1cm4gd2luZG93LmRldmljZVBpeGVsUmF0aW87CiAgICAgICAgfQoKICAgICAgICBzdGFnZUVkZ2VQb3NpdGlvbihheGlzLCBhcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IEFYSVMgPSBheGlzOwogICAgICAgICAgICBjb25zdCBFREdFID0gU2NyYXRjaC5DYXN0LnRvU3RyaW5nKGFyZ3MuRURHRSk7CiAgICAgICAgICAgIGNvbnN0IFdJRFRIID0gU2NyYXRjaC5DYXN0LnRvTnVtYmVyKGFyZ3MuV0lEVEgpOwogICAgICAgICAgICBjb25zdCBIRUlHSFQgPSBTY3JhdGNoLkNhc3QudG9OdW1iZXIoYXJncy5IRUlHSFQpOwoKICAgICAgICAgICAgc3dpdGNoIChFREdFKSB7CiAgICAgICAgICAgICAgICBjYXNlICd0b3AgbGVmdCBjb3JuZXInOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBBWElTID09PSAneCcgPyAtV0lEVEggLyAyIDogSEVJR0hUIC8gMjsKICAgICAgICAgICAgICAgIGNhc2UgJ3RvcCBlZGdlJzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQVhJUyA9PT0gJ3gnID8gMCA6IEhFSUdIVCAvIDI7CiAgICAgICAgICAgICAgICBjYXNlICd0b3AgcmlnaHQgY29ybmVyJzoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gQVhJUyA9PT0gJ3gnID8gV0lEVEggLyAyIDogSEVJR0hUIC8gMjsKICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0IGVkZ2UnOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBBWElTID09PSAneCcgPyBXSURUSCAvIDIgOiAwOwogICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tIHJpZ2h0IGNvcm5lcic6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEFYSVMgPT09ICd4JyA/IFdJRFRIIC8gMiA6IC1IRUlHSFQgLyAyOwogICAgICAgICAgICAgICAgY2FzZSAnYm90dG9tIGVkZ2UnOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBBWElTID09PSAneCcgPyAwIDogLUhFSUdIVCAvIDI7CiAgICAgICAgICAgICAgICBjYXNlICdib3R0b20gbGVmdCBjb3JuZXInOgogICAgICAgICAgICAgICAgICAgIHJldHVybiBBWElTID09PSAneCcgPyAtV0lEVEggLyAyIDogLUhFSUdIVCAvIDI7CiAgICAgICAgICAgICAgICBkZWZhdWx0OiAvLyAnbGVmdCBlZGdlJwogICAgICAgICAgICAgICAgICAgIHJldHVybiBBWElTID09PSAneCcgPyAtV0lEVEggLyAyIDogMDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgc3RhZ2VFZGdlUG9zaXRpb25YKGFyZ3MpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhZ2VFZGdlUG9zaXRpb24oJ3gnLCBhcmdzKTsKICAgICAgICB9CiAgICAgICAgc3RhZ2VFZGdlUG9zaXRpb25ZKGFyZ3MpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3RhZ2VFZGdlUG9zaXRpb24oJ3knLCBhcmdzKTsKICAgICAgICB9CgogICAgICAgIHN0YWdlQW5jaG9yWChhcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IFBFUkNFTlQgPSBTY3JhdGNoLkNhc3QudG9OdW1iZXIoYXJncy5QRVJDRU5UKTsKICAgICAgICAgICAgY29uc3QgV0lEVEggPSBTY3JhdGNoLkNhc3QudG9OdW1iZXIoYXJncy5XSURUSCk7CgogICAgICAgICAgICByZXR1cm4gKC1XSURUSCAvIDIpICsgKFdJRFRIICogKFBFUkNFTlQgLyAxMDApKTsKICAgICAgICB9CgogICAgICAgIHN0YWdlQW5jaG9yWShhcmdzKSB7CiAgICAgICAgICAgIGNvbnN0IFBFUkNFTlQgPSBTY3JhdGNoLkNhc3QudG9OdW1iZXIoYXJncy5QRVJDRU5UKTsKICAgICAgICAgICAgY29uc3QgSEVJR0hUID0gU2NyYXRjaC5DYXN0LnRvTnVtYmVyKGFyZ3MuSEVJR0hUKTsKCiAgICAgICAgICAgIHJldHVybiAoLUhFSUdIVCAvIDIpICsgKEhFSUdIVCAqIChQRVJDRU5UIC8gMTAwKSk7CiAgICAgICAgfQogICAgfQogICAgCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCkgPT4gewogICAgICAgIFNjcmF0Y2gudm0ucnVudGltZS5zdGFydEhhdHMoJ2RvZ2Vpc2N1dFJlc29sdXRpb25fd2hlbldpbmRvd1Jlc2l6ZWQnKTsKICAgIH0pOwoKICAgIFNjcmF0Y2guZXh0ZW5zaW9ucy5yZWdpc3RlcihuZXcgUmVzb2x1dGlvbigpKTsKfSkoU2NyYXRjaCk7","lmscomments":"https://extensions.turbowarp.org/Lily/CommentBlocks.js","SPdisplayTextV2":"data:text/javascript;base64,Ly8gTmFtZTogRGlzcGxheSBUZXh0IFYyCi8vIElEOiBTUGRpc3BsYXlUZXh0VjIKLy8gRGVzY3JpcHRpb246IERpc3BsYXkgVGV4dCBpbiBZb3VyIFByb2plY3RzLgovLyBCeTogU2hhcmtQb29sCi8vIExpY2Vuc2U6IE1JVAoKLy8gVmVyc2lvbiBWLjEuMC4wNAoKKGZ1bmN0aW9uIChTY3JhdGNoKSB7CiAgInVzZSBzdHJpY3QiOwogIGlmICghU2NyYXRjaC5leHRlbnNpb25zLnVuc2FuZGJveGVkKSB0aHJvdyBuZXcgRXJyb3IoIkRpc3BsYXkgVGV4dCBWMiBtdXN0IHJ1biB1bnNhbmRib3hlZCEiKTsKCiAgY29uc3QgbWVudUljb25VUkkgPQoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0kyTlM0eU16UWlJR2hsYVdkb2REMGlOalV1TWpNMElpQjJhV1YzUW05NFBTSXdJREFnTmpVdU1qTTBJRFkxTGpJek5DSStQR2NnYzNSeWIydGxMVzFwZEdWeWJHbHRhWFE5SWpFd0lqNDhjR0YwYUNCa1BTSk5NQ0F6TWk0Mk1UZERNQ0F4TkM0Mk1ETWdNVFF1TmpBeklEQWdNekl1TmpFM0lEQnpNekl1TmpFM0lERTBMall3TXlBek1pNDJNVGNnTXpJdU5qRTNMVEUwTGpZd015QXpNaTQyTVRjdE16SXVOakUzSURNeUxqWXhOMU13SURVd0xqWXpNU0F3SURNeUxqWXhOeUlnWm1sc2JEMGlJek5qTkdVMVl5SXZQanh3WVhSb0lHUTlJazB6TGpNNU1TQXpNaTQyTVRkak1DMHhOaTR4TkRFZ01UTXVNRGcxTFRJNUxqSXlOaUF5T1M0eU1qWXRNamt1TWpJMmN6STVMakl5TmlBeE15NHdPRFVnTWprdU1qSTJJREk1TGpJeU5pMHhNeTR3T0RVZ01qa3VNakkyTFRJNUxqSXlOaUF5T1M0eU1qWlRNeTR6T1RFZ05EZ3VOelU0SURNdU16a3hJRE15TGpZeE55SWdabWxzYkQwaUl6YzRPU0l2UGp4d1lYUm9JR1E5SWsweE9TNHdOellnTkRrdU5EYzVZVE11TXpJZ015NHpNaUF3SURBZ01TMHpMak15TVMwekxqTXlkaTAwTGprMWFESXVOakEzZGpJdU9EVTFZVEl1T0RFZ01pNDRNU0F3SURBZ01DQXlMamd3T0NBeUxqZ3dPR2d5TGpnMU5IWXlMall3TjNwdE1qUXVPVGc0TFRJdU5qQTNZVEl1T0RFZ01pNDRNU0F3SURBZ01DQXlMamd3T0MweUxqZ3dPRlkwTVM0eU1XZ3lMall3TjNZMExqazBPR0V6TGpNeUlETXVNeklnTUNBd0lERXRNeTR6TWlBekxqTXlNV2d0TkM0NU5YWXRNaTQyTURkNmJTMHlPQzR6TVMweU55NDNPVFpoTXk0ek1pQXpMak15SURBZ01DQXhJRE11TXpJeUxUTXVNekl4YURRdU9UUTRkakl1TmpBM1NESXhMakUzWVRJdU9ERWdNaTQ0TVNBd0lEQWdNQzB5TGpnd09DQXlMamd3T0hZeUxqZzFOR2d0TWk0Mk1EZDZiVE13TGpRd05DMHpMak15TVdFekxqTXlJRE11TXpJZ01DQXdJREVnTXk0ek1qRWdNeTR6TW5ZMExqazFhQzB5TGpZd04xWXlNUzR4TjJFeUxqZ3hJREl1T0RFZ01DQXdJREF0TWk0NE1EZ3RNaTQ0TURoSU5ERXVNakYyTFRJdU5qQTNlaUlnWm1sc2JEMGlJMlptWmlJZ2MzUnliMnRsUFNJalptWm1JaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqSXVOU0l2UGp4d1lYUm9JR1E5SWsweU5TNDRNVEVnTWpjdU5USXhZUzQ1TXk0NU15QXdJREFnTVMwdU9USTRMUzQ1TWpsMkxURXVOakkyWXpBdExqVXhNeTQwTVRVdExqa3lPQzQ1TWpndExqa3lPR2d4TXk0Mk1USmpMalV4TXlBd0lDNDVNamd1TkRFMUxqa3lPQzQ1TWpoMk1TNDJNalpoTGprekxqa3pJREFnTUNBeExTNDVNamd1T1RJNWVpSWdabWxzYkQwaUkyWm1aaUlnYzNSeWIydGxQU0lqWm1abUlpQnpkSEp2YTJVdGQybGtkR2c5SWpFdU5TSXZQanh3WVhSb0lHUTlJazB6TUM0NE56VWdNall1TmpVM1lTNDVNeTQ1TXlBd0lEQWdNU0F1T1RJNUxTNDVNMmd4TGpZeU5tRXVPVE11T1RNZ01DQXdJREVnTGpreU9TNDVNM1l4TXk0Mk1URmhMamt6TGpreklEQWdNQ0F4TFM0NU1qa3VPVEk0YUMweExqWXlObUV1T1RNdU9UTWdNQ0F3SURFdExqa3lPUzB1T1RJNGVpSWdabWxzYkQwaUkyWm1aaUlnYzNSeWIydGxQU0lqWm1abUlpQnpkSEp2YTJVdGQybGtkR2c5SWpFdU5TSXZQand2Wno0OEwzTjJaejQ9IjsKCiAgY29uc3QgYmxvY2tJY29uVVJJID0KImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJME9TNDJNalFpSUdobGFXZG9kRDBpTkRrdU5qSTBJaUIyYVdWM1FtOTRQU0l3SURBZ05Ea3VOakkwSURRNUxqWXlOQ0krUEdjZ2MzUnliMnRsTFcxcGRHVnliR2x0YVhROUlqRXdJajQ4Y0dGMGFDQmtQU0pOTUNBME9TNDJNalJXTUdnME9TNDJNalIyTkRrdU5qSTBlaUlnWm1sc2JEMGlibTl1WlNJdlBqeHdZWFJvSUdROUlrMHhNUzR5TnpFZ05ERXVOamMwWVRNdU16SWdNeTR6TWlBd0lEQWdNUzB6TGpNeU1TMHpMak15ZGkwMExqazFhREl1TmpBM2RqSXVPRFUxWVRJdU9ERWdNaTQ0TVNBd0lEQWdNQ0F5TGpnd09DQXlMamd3T0dneUxqZzFOSFl5TGpZd04zcHRNalF1T1RnNExUSXVOakEzWVRJdU9ERWdNaTQ0TVNBd0lEQWdNQ0F5TGpnd09DMHlMamd3T0hZdE1pNDROVFJvTWk0Mk1EZDJOQzQ1TkRoaE15NHpNaUF6TGpNeUlEQWdNQ0F4TFRNdU16SWdNeTR6TWpGb0xUUXVPVFYyTFRJdU5qQTNlazAzTGprME9TQXhNUzR5TnpGaE15NHpNaUF6TGpNeUlEQWdNQ0F4SURNdU16SXlMVE11TXpJeGFEUXVPVFE0ZGpJdU5qQTNhQzB5TGpnMU5HRXlMamd4SURJdU9ERWdNQ0F3SURBdE1pNDRNRGdnTWk0NE1EaDJNaTQ0TlRSSU55NDVOWHBOTXpndU16VXpJRGN1T1RWaE15NHpNaUF6TGpNeUlEQWdNQ0F4SURNdU16SXhJRE11TXpKMk5DNDVOV2d0TWk0Mk1EZDJMVEl1T0RVMVlUSXVPREVnTWk0NE1TQXdJREFnTUMweUxqZ3dPQzB5TGpnd09HZ3RNaTQ0TlRSV055NDVOWG9pSUdacGJHdzlJaU5tWm1ZaUlITjBjbTlyWlQwaUkyWm1aaUlnYzNSeWIydGxMWGRwWkhSb1BTSXlMalVpTHo0OGNHRjBhQ0JrUFNKTk1UZ3VNREEySURFNUxqY3hObUV1T1RNdU9UTWdNQ0F3SURFdExqa3lPQzB1T1RJNWRpMHhMall5Tm1Nd0xTNDFNVE11TkRFMUxTNDVNamd1T1RJNExTNDVNamhvTVRNdU5qRXlZeTQxTVRNZ01DQXVPVEk0TGpReE5TNDVNamd1T1RJNGRqRXVOakkyWVM0NU15NDVNeUF3SURBZ01TMHVPVEk0TGpreU9Yb2lJR1pwYkd3OUlpTm1abVlpSUhOMGNtOXJaVDBpSTJabVppSWdjM1J5YjJ0bExYZHBaSFJvUFNJeExqVWlMejQ4Y0dGMGFDQmtQU0pOTWpNdU1EY2dNVGd1T0RVeVlTNDVNeTQ1TXlBd0lEQWdNU0F1T1RJNUxTNDVNMmd4TGpZeU5tRXVPVE11T1RNZ01DQXdJREVnTGpreU9TNDVNM1l4TXk0Mk1URmhMamt6TGpreklEQWdNQ0F4TFM0NU1qa3VPVEk0YUMweExqWXlObUV1T1RNdU9UTWdNQ0F3SURFdExqa3lPUzB1T1RJNGVpSWdabWxzYkQwaUkyWm1aaUlnYzNSeWIydGxQU0lqWm1abUlpQnpkSEp2YTJVdGQybGtkR2c5SWpFdU5TSXZQand2Wno0OEwzTjJaejQ9IjsKCiAgY29uc3QgQ2FzdCA9IFNjcmF0Y2guQ2FzdDsKICBjb25zdCB2bSA9IFNjcmF0Y2gudm07CiAgY29uc3QgcnVudGltZSA9IHZtLnJ1bnRpbWU7CiAgY29uc3QgcmVuZGVyID0gdm0ucmVuZGVyZXI7CgogIGNvbnN0IFRSQU5TTEFUSU9OUyA9IHsKICAgIGlkOiBTY3JhdGNoLnRyYW5zbGF0ZSgibXktdGV4dCIpLAogIH0KCiAgY29uc3QgVEhSRUFEX0tFWSA9IFN5bWJvbCgiU1BkaXNwbGF5VGV4dFYyX3RocmVhZEtleSIpOwoKICBjb25zdCB0ZXh0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgdGV4dERpdi5pZCA9ICJTUGRpc3BsYXlUZXh0VjJfdGV4dERpdiI7CiAgdGV4dERpdi5zdHlsZS5wb2ludGVyRXZlbnRzID0gIm5vbmUiOwogIHJlbmRlci5hZGRPdmVybGF5KHRleHREaXYsICJzY2FsZS1jZW50ZXJlZCIpOwoKICBjb25zdCBpdGVyYXRvckZvckVhY2ggPSAoaXRlcmF0b3IsIGZ1bmMpID0+IHsKICAgIGlmICh0eXBlb2YgaXRlcmF0b3IuZm9yRWFjaCA9PT0gImZ1bmN0aW9uIikgewogICAgICBpdGVyYXRvci5mb3JFYWNoKCh2YWx1ZSkgPT4gZnVuYyh2YWx1ZSkpOwogICAgfSBlbHNlIHsKICAgICAgbGV0IHZhbHVlID0gaXRlcmF0b3IubmV4dCgpOwogICAgICB3aGlsZSAoIXZhbHVlLmRvbmUpIHsKICAgICAgICBmdW5jKHZhbHVlLnZhbHVlKTsKICAgICAgICB2YWx1ZSA9IGl0ZXJhdG9yLm5leHQoKTsKICAgICAgfQogICAgfTsKICB9CgogIGNvbnN0IEJVSUxUX0lOX0ZPTlRTID0gW107CiAgaXRlcmF0b3JGb3JFYWNoKAogICAgZG9jdW1lbnQuZm9udHMua2V5cygpLAogICAgKGZvbnQpID0+IHsKICAgICAgQlVJTFRfSU5fRk9OVFMucHVzaCh7CiAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoZm9udC5mYW1pbHkpLAogICAgICAgIHZhbHVlOiBmb250LmZhbWlseQogICAgICB9KTsKICAgIH0KICApOwoKICAvLyBTbGlnaHRseSBtb2RpZmllZCB2ZXJzaW9uIG9mIE1hcmtkb3duIGZvciBzdmcKICBjb25zdCBNQVJLRE9XTl9DT05TVFMgPSB7CiAgICAvKiBCb2xkICovCiAgICAiKioiOiBgZm9udC13ZWlnaHQ9ImJvbGQiYCwKICAgIC8qIEl0YWxpYyAqLwogICAgIiovIjogYGZvbnQtc3R5bGU9Iml0YWxpYyJgLAogICAgLyogU3RyaWtldGhyb3VnaCAqLwogICAgIn5+IjogYHRleHQtZGVjb3JhdGlvbj0ibGluZS10aHJvdWdoImAsCiAgICAvKiBVbmRlcmxpbmUgKi8KICAgICJfXyI6IGB0ZXh0LWRlY29yYXRpb249InVuZGVybGluZSJgLAogICAgLyogSGVhZGVycyAqLwogICAgIiMgIjogYGZvbnQtc2l6ZT0iMmVtImAsCiAgICAiIyMiOiBgZm9udC1zaXplPSIxLjRlbSJgLAogICAgLyogVGV4dCBDb2xvciAqLwogICAgIkBjIjogYGZpbGw9YCwKICAgIC8qIFRleHQgRm9udCAqLwogICAgIkBmIjogYGZvbnQtZmFtaWx5PWAsCiAgfTsKCiAgY29uc3QgWE1MX1JFR0VYID0gbmV3IFJlZ0V4cCgvWzw+JiciXS9nKTsKCiAgY29uc3QgeG1sRXNjYXBlID0gZnVuY3Rpb24odGV4dCkgewogICAgcmV0dXJuIHRleHQucmVwbGFjZShYTUxfUkVHRVgsIGNoYXIgPT4gewogICAgICBzd2l0Y2ggKGNoYXIpIHsKICAgICAgICBjYXNlICI8IjogcmV0dXJuICImbHQ7IjsKICAgICAgICBjYXNlICI+IjogcmV0dXJuICImZ3Q7IjsKICAgICAgICBjYXNlICImIjogcmV0dXJuICImYW1wOyI7CiAgICAgICAgY2FzZSAiJyI6IHJldHVybiAiJmFwb3M7IjsKICAgICAgICBjYXNlICJcIiI6IHJldHVybiAiJnF1b3Q7IjsKICAgICAgfQogICAgfSk7CiAgfTsKCiAgY29uc3QgY29udmVydDJNYXJrZG93biA9IGZ1bmN0aW9uKHRleHQpIHsKICAgIGxldCBtZFRleHQgPSAiIjsKICAgIGxldCBjb21tYW5kQ2FjaGUgPSBbXTsKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgewogICAgICBjb25zdCBjaGFyID0gdGV4dFtpXTsKICAgICAgY29uc3QgY2hhckJ1ZmZlciA9IGNoYXIgKyAodGV4dFtpICsgMV0gPz8gIiIpOwogICAgICBjb25zdCBtZENvbW1hbmQgPSBNQVJLRE9XTl9DT05TVFNbY2hhckJ1ZmZlcl07CgogICAgICBpZiAoY2hhckJ1ZmZlci5sZW5ndGggPT09IDIgJiYgbWRDb21tYW5kICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjb25zdCBvbGRDb21tYW5kID0gY29tbWFuZENhY2hlLmluZGV4T2YoY2hhckJ1ZmZlcik7CiAgICAgICAgaWYgKG9sZENvbW1hbmQgPiAtMSkgewogICAgICAgICAgLyogZXNjYXBlIGxhc3QgY29tbWFuZCAqLwogICAgICAgICAgY29tbWFuZENhY2hlLnNwbGljZShvbGRDb21tYW5kLCAxKTsKICAgICAgICAgIG1kVGV4dCArPSAiPC90c3Bhbj4iOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvKiBlbnRlciBuZXcgY29tbWFuZCAqLwogICAgICAgICAgY29tbWFuZENhY2hlLnB1c2goY2hhckJ1ZmZlcik7CiAgICAgICAgICBpZiAoY2hhciA9PT0gIkAiKSB7CiAgICAgICAgICAgIC8vIHNwZWNpYWwgY29tbWFuZAogICAgICAgICAgICAvLyBnZXQgY29tbWFuZCB2YXJpYWJsZSAoZm9udCBmYW1pbHksIHRleHQgY29sb3IsIGV0YykKICAgICAgICAgICAgbGV0IHZhbHVlID0gIiI7CiAgICAgICAgICAgIGlmICh0ZXh0W2kgKyAyXSA9PT0gIlsiKSB7CiAgICAgICAgICAgICAgbGV0IGogPSBpICsgMzsKICAgICAgICAgICAgICB3aGlsZSAodGV4dFtqXSAmJiB0ZXh0W2pdICE9PSAiXSIpIHsKICAgICAgICAgICAgICAgIHZhbHVlICs9IHRleHRbal07CiAgICAgICAgICAgICAgICBqKys7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB2YWx1ZSA9IGAiJHt2YWx1ZX0iYDsKICAgICAgICAgICAgICBtZFRleHQgKz0gIjx0c3BhbiAiICsgbWRDb21tYW5kICsgdmFsdWUgKyAiPiI7CiAgICAgICAgICAgICAgaSArPSBqIC0gaSAtIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGJhc2ljIGNvbW1hbmQKICAgICAgICAgICAgbWRUZXh0ICs9ICI8dHNwYW4gIiArIG1kQ29tbWFuZCArICI+IjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaSsrOwogICAgICB9IGVsc2UgewogICAgICAgIG1kVGV4dCArPSBjaGFyOwogICAgICB9CiAgICB9CgogICAgY29uc3QgbWlzc2luZ0Nsb3NlcnMgPSBjb21tYW5kQ2FjaGUubGVuZ3RoOwogICAgaWYgKG1pc3NpbmdDbG9zZXJzKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWlzc2luZ0Nsb3NlcnM7IGkrKykgbWRUZXh0ICs9ICI8L3RzcGFuPiI7CiAgICB9CgogICAgcmV0dXJuIG1kVGV4dDsKICB9OwoKICAvKgogICAgcHJlcGFyZSB0ZXh0IHRvIGJlIHByaW50ZWQgYXMgaHRtbCwKICAgIG11c3QgYmUgeG1sLWVzY2FwZWQgYW5kIGNvbnZlcnRlZCBmb3IgbWFya2Rvd24uCiAgKi8KICBjb25zdCBjb21waWxlVGV4dCA9IChyYXdUZXh0LCBsaW5lU3BhY2UsIHBhdGhJbmZvKSA9PiB7CiAgICBjb25zdCBsaW5lUHJlc2V0ID0gYDx0c3BhbiB4PSIwIiBkeT0iJHtsaW5lU3BhY2V9ZW0iPmA7CiAgICBsZXQgc2FmZVRleHQgPSAiIjsKICAgIGlmIChwYXRoSW5mbykgewogICAgICBjb25zdCBvZmZzZXQgPSBwYXRoSW5mb1sxXSA9PT0gIm1pZGRsZSIgPyAiNTAlIiA6IHBhdGhJbmZvWzFdID09PSAiZW5kIiA/ICIxMDAlIiA6ICIwJSI7CiAgICAgIHNhZmVUZXh0ICs9IGA8dGV4dFBhdGggeGxpbms6aHJlZj0iI2N1cnZlLSR7cGF0aEluZm9bMF19IiBocmVmPSIjY3VydmUtJHtwYXRoSW5mb1swXX0iIHN0YXJ0T2Zmc2V0PSIke29mZnNldH0iPmA7CiAgICB9CgogICAgc2FmZVRleHQgKz0gYDx0c3BhbiB4PSIwIiBkeT0iLjg1ZW0iPmAgKyB4bWxFc2NhcGUocmF3VGV4dCk7CiAgICBzYWZlVGV4dCA9IHNhZmVUZXh0LnJlcGxhY2UoL1xuL2csICI8L3RzcGFuPiIgKyBsaW5lUHJlc2V0KTsKICAgIHNhZmVUZXh0ID0gY29udmVydDJNYXJrZG93bihzYWZlVGV4dCk7CiAgICBzYWZlVGV4dCArPSAiPC90c3Bhbj4iICsgKHBhdGhJbmZvID8gIjwvdGV4dFBhdGg+IiA6ICIiKTsKICAgIHJldHVybiBzYWZlVGV4dDsKICB9OwoKICAvLyBiYXNpYyBjc3MgZWZmZWN0cyBmb3IgdGV4dAogIGNvbnN0IEVGRkVDVF9IQU5ETEVSUyA9IHsKICAgICJibHVyIjogKHYpID0+IFsiZmlsdGVyIiwgYGJsdXIoJHt2fXB4KWBdLAogICAgInNhdHVyYXRpb24iOiAodikgPT4gWyJmaWx0ZXIiLCBgc2F0dXJhdGUoJHt2fSUpYF0sCiAgICAiY29udHJhc3QiOiAodikgPT4gWyJmaWx0ZXIiLCBgY29udHJhc3QoJHt2ICsgMTAwfSUpYF0sCiAgICAiYnJpZ2h0bmVzcyI6ICh2KSA9PiBbImZpbHRlciIsIGBicmlnaHRuZXNzKCR7diArIDEwMH0lKWBdLAogICAgImh1ZSI6ICh2KSA9PiBbImZpbHRlciIsIGBodWUtcm90YXRlKCR7dn1kZWcpYF0sCiAgICAib3BhY2l0eSI6ICh2KSA9PiBbImZpbHRlciIsIGBvcGFjaXR5KCR7KDEwMCAtIHYpIC8gMTAwfSlgXSwKICAgICJzZXBpYSI6ICh2KSA9PiBbImZpbHRlciIsIGBzZXBpYSgke3Z9JSlgXSwKICAgICJpbnZlcnQiOiAodikgPT4gWyJmaWx0ZXIiLCBgaW52ZXJ0KCR7dn0lKWBdLAogICAgImRpcmVjdGlvbiI6ICh2KSA9PiBbInRyYW5zZm9ybSIsIGByb3RhdGUoJHt2IC0gOTB9KWBdLAogICAgInNjYWxlIHgiOiAodikgPT4gWyJzY2FsZTEiLCB2IC8gMTAwXSwKICAgICJzY2FsZSB5IjogKHYpID0+IFsic2NhbGUyIiwgdiAvIDEwMF0sCiAgICAic2tldyB4IjogKHYpID0+IFsidHJhbnNmb3JtIiwgYHNrZXdYKCR7dn0pYF0sCiAgICAic2tldyB5IjogKHYpID0+IFsidHJhbnNmb3JtIiwgYHNrZXdZKCR7dn0pYF0sCiAgfTsKCiAgLyogQ2xhc3MgdXNlZCBieSB0ZXh0IGRpc3BsYXlzICovCiAgY2xhc3MgdGV4dE9iamVjdCB7CiAgICBjb25zdHJ1Y3RvcihpZCwgdGV4dCkgewogICAgICB0aGlzLmlkID0gaWQ7CiAgICAgIHRoaXMucmF3VGV4dCA9IHRleHQ7CiAgICAgIHRoaXMuY2xlYW5zZWRUZXh0ID0gY29tcGlsZVRleHQodGV4dCwgMSwgbnVsbCk7CiAgICAgIHRoaXMuc3R5bGVzID0gbmV3IE1hcCgpOwogICAgICB0aGlzLnNwZWNpYWxTdHlsZXMgPSBuZXcgTWFwKCk7CiAgICAgIHRoaXMuY2xpY2tUaW1lID0gMDsKICAgICAgdGhpcy5wb3NpdGlvbiA9IFtudWxsLCBudWxsXTsKICAgICAgdGhpcy5fY2FjaGVkSW1hZ2UgPSBbbnVsbCwgbnVsbF07CgogICAgICB0aGlzLl9kaXJ0eSA9IGZhbHNlOwogICAgICB0aGlzLl9pbnRlcmFjdGFibGUgPSBmYWxzZTsKICAgICAgdGhpcy5fY2xpY2thYmxlID0gZmFsc2U7CgogICAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDsKICAgICAgdGhpcy5fZWxlbWVudElubmVyID0gbnVsbDsKICAgICAgdGhpcy5fY2xpY2tFdmVudCA9IChlKSA9PiB7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICB0aGlzLmNsaWNrVGltZSA9IGUudGltZVN0YW1wOwogICAgICAgIHJ1bkhhdEV2ZW50cygid2hlblRleHRDbGlja2VkIiwgdGhpcy5pZCk7CiAgICAgIH07CiAgICB9CgogICAgc2V0VGV4dChuZXdUZXh0KSB7CiAgICAgIGlmIChuZXdUZXh0ID09PSB0aGlzLnJhd1RleHQpIHJldHVybjsKICAgICAgY29uc3QgaGFzQ3VydmUgPSBDYXN0LnRvQm9vbGVhbih0aGlzLnNwZWNpYWxTdHlsZXMuZ2V0KCJjdXJ2ZSIpKTsKICAgICAgY29uc3QgYWxpZ25tZW50ID0gdGhpcy5fZWxlbWVudCA/IHRoaXMuX2VsZW1lbnRJbm5lci5nZXRBdHRyaWJ1dGUoInRleHQtYW5jaG9yIikgOiAiIjsKCiAgICAgIHRoaXMucmF3VGV4dCA9IG5ld1RleHQ7CiAgICAgIHRoaXMuY2xlYW5zZWRUZXh0ID0gY29tcGlsZVRleHQoCiAgICAgICAgbmV3VGV4dCwKICAgICAgICB0aGlzLnNwZWNpYWxTdHlsZXMuZ2V0KCJsaW5lLWhlaWdodCIpID8/IDEsCiAgICAgICAgaGFzQ3VydmUgPyBbdGhpcy5pZCwgYWxpZ25tZW50XSA6IG51bGwKICAgICAgKTsKICAgICAgdGhpcy5fZGlydHkgPSB0cnVlOwogICAgfQoKICAgIHNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSwgaXNTcGVjaWFsKSB7CiAgICAgIGxldCBvbGRWYWx1ZTsKICAgICAgaWYgKGlzU3BlY2lhbCkgewogICAgICAgIG9sZFZhbHVlID0gdGhpcy5zcGVjaWFsU3R5bGVzLmdldChuYW1lKTsgCiAgICAgICAgaWYgKHZhbHVlID09PSBvbGRWYWx1ZSkgcmV0dXJuOwogICAgICAgIHRoaXMuc3BlY2lhbFN0eWxlcy5zZXQobmFtZSwgdmFsdWUpOwogICAgICAgIHRoaXMuX2RpcnR5ID0gdHJ1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvbGRWYWx1ZSA9IHRoaXMuc3R5bGVzLmdldChuYW1lKTsgCiAgICAgICAgaWYgKHZhbHVlID09PSBvbGRWYWx1ZSkgcmV0dXJuOwogICAgICAgIHRoaXMuc3R5bGVzLnNldChuYW1lLCB2YWx1ZSk7CiAgICAgICAgdGhpcy5fZGlydHkgPSB0cnVlOwogICAgICB9CiAgICB9CgogICAgc2V0UG9zaXRpb24oeCwgeSkgewogICAgICB0aGlzLnBvc2l0aW9uID0gW3gsIHldOwogICAgICBpZiAoIXRoaXMuX2VsZW1lbnQpIHJldHVybjsKCiAgICAgIGNvbnN0IGJvdW5kcyA9IHRoaXMuX2VsZW1lbnRJbm5lci5nZXRCQm94KCk7CiAgICAgIHkgKz0gYm91bmRzLmhlaWdodCAvIDI7CiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZSgke3h9cHgsICR7eSAqIC0xfXB4KWA7CiAgICAgIHRoaXMuX2VsZW1lbnRJbm5lci5zZXRBdHRyaWJ1dGUoInRyYW5zZm9ybS1vcmlnaW4iLCBgMCAke2JvdW5kcy55ICsgYm91bmRzLmhlaWdodCAvIDJ9YCk7CiAgICB9CgogICAgdG9nZ2xlSW50ZXJhY3QoaW50ZXJhY3RhYmxlKSB7CiAgICAgIGlmICghdGhpcy5fZWxlbWVudCB8fCBpbnRlcmFjdGFibGUgPT09IHRoaXMuX2ludGVyYWN0YWJsZSkgcmV0dXJuOwogICAgICB0aGlzLl9pbnRlcmFjdGFibGUgPSBpbnRlcmFjdGFibGU7CiAgICAgIHRoaXMuX2VsZW1lbnQuc3R5bGUucG9pbnRlckV2ZW50cyA9IGludGVyYWN0YWJsZSA/ICJhdXRvIiA6ICJub25lIjsKICAgIH0KCiAgICB0b2dnbGVDbGlja2FibGUoY2xpY2thYmxlKSB7CiAgICAgIGlmICghdGhpcy5fZWxlbWVudCB8fCBjbGlja2FibGUgPT09IHRoaXMuX2NsaWNrYWJsZSkgcmV0dXJuOwogICAgICB0aGlzLl9jbGlja2FibGUgPSBjbGlja2FibGU7CiAgICAgIGlmIChjbGlja2FibGUpIHsKICAgICAgICB0aGlzLnRvZ2dsZUludGVyYWN0KHRydWUpOwogICAgICAgIHRoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLl9jbGlja0V2ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRvZ2dsZUludGVyYWN0KGZhbHNlKTsKICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5fY2xpY2tFdmVudCk7CiAgICAgIH0KICAgIH0KCiAgICB3cmFwVGV4dChtYXhXaWR0aCkgewogICAgICBpZiAoIXRoaXMuX2VsZW1lbnRJbm5lcikgcmV0dXJuOwogICAgICBjb25zdCBsaW5lU3BhY2UgPSB0aGlzLnNwZWNpYWxTdHlsZXMuZ2V0KCJsaW5lLWhlaWdodCIpID8/IDE7CiAgICAgIGNvbnN0IHRzcGFucyA9IEFycmF5LmZyb20odGhpcy5fZWxlbWVudElubmVyLmNoaWxkcmVuKTsKICAgICAgY29uc3QgbmV3VHNwYW5zID0gW107CgogICAgICBsZXQgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAidHNwYW4iKTsKICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoIngiLCAiMCIpOwogICAgICBsaW5lLnNldEF0dHJpYnV0ZSgiZHkiLCAiLjg1ZW0iKTsKCiAgICAgIHRoaXMuX2VsZW1lbnRJbm5lci5pbm5lckhUTUwgPSAiIjsKICAgICAgdGhpcy5fZWxlbWVudElubmVyLmFwcGVuZENoaWxkKGxpbmUpOwogICAgICBmb3IgKGNvbnN0IHNwYW4gb2YgdHNwYW5zKSB7CiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHNwYW4uY2hpbGROb2RlcykgewogICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgIT09IE5vZGUuVEVYVF9OT0RFKSB7CiAgICAgICAgICAgIGxpbmUuYXBwZW5kQ2hpbGQobm9kZS5jbG9uZU5vZGUodHJ1ZSkpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCB3b3JkcyA9IG5vZGUudGV4dENvbnRlbnQuc3BsaXQoLyhccyspLyk7CiAgICAgICAgICBmb3IgKGNvbnN0IHdvcmQgb2Ygd29yZHMpIHsKICAgICAgICAgICAgaWYgKHdvcmQgPT09ICIiKSBjb250aW51ZTsKICAgICAgICAgICAgY29uc3QgdGVzdE5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh3b3JkKTsKICAgICAgICAgICAgbGluZS5hcHBlbmRDaGlsZCh0ZXN0Tm9kZSk7CgogICAgICAgICAgICBpZiAobGluZS5nZXRDb21wdXRlZFRleHRMZW5ndGgoKSA+IG1heFdpZHRoKSB7CiAgICAgICAgICAgICAgbGluZS5yZW1vdmVDaGlsZCh0ZXN0Tm9kZSk7CgogICAgICAgICAgICAgIGxpbmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgInRzcGFuIik7CiAgICAgICAgICAgICAgbGluZS5zZXRBdHRyaWJ1dGUoIngiLCAiMCIpOwogICAgICAgICAgICAgIGxpbmUuc2V0QXR0cmlidXRlKCJkeSIsIGAke2xpbmVTcGFjZX1lbWApOwogICAgICAgICAgICAgIGxpbmUuYXBwZW5kQ2hpbGQodGVzdE5vZGUpOwoKICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50SW5uZXIuYXBwZW5kQ2hpbGQobGluZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpbml0RWxlbWVudCgpIHsKICAgICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAic3ZnIik7CiAgICAgIHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKCJpZCIsIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLmlkKSk7CiAgICAgIHRoaXMuX2VsZW1lbnQuc2V0QXR0cmlidXRlKCJ4bWxucyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIpOwogICAgICB0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgieG1sbnM6eGxpbmsiLCAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIpOwogICAgICB0aGlzLl9lbGVtZW50LnNldEF0dHJpYnV0ZSgic3R5bGUiLCBgb3ZlcmZsb3c6IHZpc2libGU7IHBvaW50ZXItZXZlbnRzOiBub25lOyBwb3NpdGlvbjogYWJzb2x1dGU7YCk7CgogICAgICBpZiAodHlwZW9mIHNjYWZmb2xkaW5nID09PSAidW5kZWZpbmVkIikgewogICAgICAgIC8vIGluamVjdCBmaWx0ZXJzIGZvciBEZWJ1ZyBNb2RlCiAgICAgICAgdGhpcy5fZWxlbWVudC5pbnNlcnRBZGphY2VudEhUTUwoImFmdGVyQmVnaW4iLCBnZW5lcmF0ZURlYnVnRmlsdGVycygpKTsKICAgICAgfQoKICAgICAgdGhpcy5fZWxlbWVudElubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsICJ0ZXh0Iik7CiAgICAgIHRoaXMuX2VsZW1lbnRJbm5lci5zZXRBdHRyaWJ1dGUoInBhaW50LW9yZGVyIiwgInN0cm9rZSIpOwogICAgICB0aGlzLl9lbGVtZW50SW5uZXIuc2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIsICJtaWRkbGUiKTsKICAgICAgdGhpcy5fZWxlbWVudElubmVyLnNldEF0dHJpYnV0ZSgieG1sOnNwYWNlIiwgInByZXNlcnZlIik7CiAgICAgIHRoaXMuX2VsZW1lbnRJbm5lci5zdHlsZS53aGl0ZVNwYWNlID0gInByZSI7CgogICAgICB0aGlzLl9lbGVtZW50SW5uZXIuaW5uZXJIVE1MID0gdGhpcy5jbGVhbnNlZFRleHQ7CiAgICAgIHRoaXMuX2VsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5fZWxlbWVudElubmVyKTsKICAgICAgdGV4dERpdi5hcHBlbmRDaGlsZCh0aGlzLl9lbGVtZW50KTsKICAgICAgdGhpcy5zZXRQb3NpdGlvbigwLCAwKTsKICAgIH0KCiAgICB1cGRhdGVFbGVtZW50KGlzU3R5bGVVcGRhdGUsIGlzU3BlY2lhbFVwZGF0ZSkgewogICAgICBpZiAoIXRoaXMuX2RpcnR5KSByZXR1cm47CiAgICAgIHRoaXMuX2RpcnR5ID0gZmFsc2U7CiAgICAgIHRoaXMuX2NhY2hlZEltYWdlID0gW251bGwsIG51bGxdOwoKICAgICAgaWYgKGlzU3BlY2lhbFVwZGF0ZSkgewogICAgICAgIGNvbnN0IHNwZWNpYWxTdHlsZXMgPSB0aGlzLnNwZWNpYWxTdHlsZXM7CgogICAgICAgIGlmIChzcGVjaWFsU3R5bGVzLmhhcygidGV4dC1zaGFkb3ciKSkgewogICAgICAgICAgdGhpcy5fZWxlbWVudC5zdHlsZS50ZXh0U2hhZG93ID0gc3BlY2lhbFN0eWxlcy5nZXQoInRleHQtc2hhZG93Iik7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3BlY2lhbFN0eWxlcy5oYXMoIndpZHRoIikpIHsKICAgICAgICAgIGNvbnN0IHdyYXBXaWR0aCA9IHNwZWNpYWxTdHlsZXMuZ2V0KCJ3aWR0aCIpOwogICAgICAgICAgaWYgKHdyYXBXaWR0aCA+IDApIHRoaXMud3JhcFRleHQod3JhcFdpZHRoKTsKICAgICAgICAgIGVsc2UgdGhpcy5fZWxlbWVudElubmVyLmlubmVySFRNTCA9IHRoaXMuY2xlYW5zZWRUZXh0OwogICAgICAgIH0KCiAgICAgICAgaWYgKHNwZWNpYWxTdHlsZXMuaGFzKCJlZmZlY3RzIikpIHsKICAgICAgICAgIC8vIGNvbXBpbGUgYSBsaXN0IG9mIGVmZmVjdHMgZm9yIHRoZSBlbGVtZW50CiAgICAgICAgICBjb25zdCBlZmZlY3RzID0gc3BlY2lhbFN0eWxlcy5nZXQoImVmZmVjdHMiKTsKICAgICAgICAgIGxldCBmaWx0ZXIgPSAiIjsKICAgICAgICAgIGxldCB0cmFuc2Zvcm0gPSAiIjsKICAgICAgICAgIGZvciAoY29uc3QgZWZmZWN0IG9mIE9iamVjdC52YWx1ZXMoZWZmZWN0cykpIHsKICAgICAgICAgICAgY29uc3QgW3R5cGUsIHZhbF0gPSBlZmZlY3QuY29udjsKICAgICAgICAgICAgaWYgKHR5cGUgPT09ICJmaWx0ZXIiKSBmaWx0ZXIgKz0gdmFsICsgIiAiOwogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gInNjYWxlMiIpIHsKICAgICAgICAgICAgICAgIGlmICghZWZmZWN0c1sic2NhbGUgeCJdKSB0cmFuc2Zvcm0gKz0gYHNjYWxlKDEsICR7dmFsfSkgYDsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICJzY2FsZTEiKSB7CiAgICAgICAgICAgICAgICBjb25zdCB5U2NhbGUgPSBlZmZlY3RzWyJzY2FsZSB5Il0/LmNvbnZbMV0gPz8gMTsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybSArPSBgc2NhbGUoJHt2YWx9LCAke3lTY2FsZX0pIGA7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRyYW5zZm9ybSArPSB2YWwgKyAiICI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGZpbHRlcikgdGhpcy5fZWxlbWVudElubmVyLnNldEF0dHJpYnV0ZSgiZmlsdGVyIiwgZmlsdGVyKTsKICAgICAgICAgIGlmICh0cmFuc2Zvcm0pIHRoaXMuX2VsZW1lbnRJbm5lci5zZXRBdHRyaWJ1dGUoInRyYW5zZm9ybSIsIHRyYW5zZm9ybSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3BlY2lhbFN0eWxlcy5oYXMoImN1cnZlIikpIHsKICAgICAgICAgIGNvbnN0IG9sZEN1cnZlID0gdGhpcy5fZWxlbWVudC5nZXRFbGVtZW50QnlJZCgiY3VydmUtIiArIHRoaXMuaWQpOwogICAgICAgICAgaWYgKG9sZEN1cnZlKSBvbGRDdXJ2ZS5yZW1vdmUoKTsKICAgICAgICAgIAogICAgICAgICAgY29uc3QgcGF0aCA9IHNwZWNpYWxTdHlsZXMuZ2V0KCJjdXJ2ZSIpOwogICAgICAgICAgY29uc3QgYWxpZ25tZW50ID0gdGhpcy5fZWxlbWVudElubmVyLmdldEF0dHJpYnV0ZSgidGV4dC1hbmNob3IiKTsKICAgICAgICAgIGlmIChwYXRoICE9PSBudWxsKSB0aGlzLl9lbGVtZW50LmFwcGVuZENoaWxkKHBhdGgpOwogICAgICAgICAgdGhpcy5jbGVhbnNlZFRleHQgPSBjb21waWxlVGV4dCgKICAgICAgICAgICAgdGhpcy5yYXdUZXh0LAogICAgICAgICAgICB0aGlzLnNwZWNpYWxTdHlsZXMuZ2V0KCJsaW5lLWhlaWdodCIpID8/IDEsCiAgICAgICAgICAgIHBhdGggIT09IG51bGwgPyBbdGhpcy5pZCwgYWxpZ25tZW50XSA6IG51bGwKICAgICAgICAgICk7CiAgICAgICAgICB0aGlzLl9lbGVtZW50SW5uZXIuaW5uZXJIVE1MID0gdGhpcy5jbGVhbnNlZFRleHQ7CgogICAgICAgICAgaWYgKHBhdGggIT09IG51bGwpIHF1ZXVlTWljcm90YXNrKCgpID0+IHsKICAgICAgICAgICAgY29uc3QgdGV4dFBhdGggPSB0aGlzLl9lbGVtZW50SW5uZXIuZmlyc3RFbGVtZW50Q2hpbGQ7CiAgICAgICAgICAgIHRleHRQYXRoLnNldEF0dHJpYnV0ZSgieGxpbms6aHJlZiIsICIjY3VydmUtIiArIHRoaXMuaWQpOwogICAgICAgICAgICB0ZXh0UGF0aC5zZXRBdHRyaWJ1dGUoImhyZWYiLCAiI2N1cnZlLSIgKyB0aGlzLmlkKTsKICAgICAgICAgICAgdGV4dFBhdGguc2V0QXR0cmlidXRlKAogICAgICAgICAgICAgICJzdGFydE9mZnNldCIsCiAgICAgICAgICAgICAgYWxpZ25tZW50ID09PSAibWlkZGxlIiA/ICI1MCUiIDogYWxpZ25tZW50ID09PSAiZW5kIiA/ICIxMDAlIiA6ICIwJSIKICAgICAgICAgICAgKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKHNwZWNpYWxTdHlsZXMuaGFzKCJncmFkaWVudCIpKSB7CiAgICAgICAgICBjb25zdCBncmFkaWVudCA9IHNwZWNpYWxTdHlsZXMuZ2V0KCJncmFkaWVudCIpOwogICAgICAgICAgY29uc3QgaWQgPSBncmFkaWVudFswXTsKCiAgICAgICAgICBjb25zdCBvbGRHcmFkaWVudCA9IHRoaXMuX2VsZW1lbnQuZ2V0RWxlbWVudEJ5SWQoImdyYWRDb2xvciIgKyBpZCk7CiAgICAgICAgICBpZiAob2xkR3JhZGllbnQpIG9sZEdyYWRpZW50LnJlbW92ZSgpOwoKICAgICAgICAgIHRoaXMuX2VsZW1lbnQuaW5zZXJ0QWRqYWNlbnRIVE1MKAogICAgICAgICAgICAiYWZ0ZXJCZWdpbiIsCiAgICAgICAgICAgIGdyYWRpZW50WzFdLnJlcGxhY2UoImdyYWRDb2xvciIsICJncmFkQ29sb3IiICsgaWQpCiAgICAgICAgICApOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGlzU3R5bGVVcGRhdGUpIHsKICAgICAgICBpdGVyYXRvckZvckVhY2goCiAgICAgICAgICB0aGlzLnN0eWxlcy5lbnRyaWVzKCksCiAgICAgICAgICAoZW50cnkpID0+IHsKICAgICAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSB0aGlzLl9lbGVtZW50SW5uZXIuZ2V0QXR0cmlidXRlKGVudHJ5WzBdKTsKICAgICAgICAgICAgaWYgKG9sZFZhbHVlID09PSBlbnRyeVsxXSkgcmV0dXJuOwogICAgICAgICAgICB0aGlzLl9lbGVtZW50SW5uZXIuc2V0QXR0cmlidXRlKGVudHJ5WzBdLCBlbnRyeVsxXSk7CiAgICAgICAgICB9CiAgICAgICAgKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLl9lbGVtZW50SW5uZXIuaW5uZXJIVE1MID0gdGhpcy5jbGVhbnNlZFRleHQ7CiAgICAgIH0KICAgICAgCiAgICAgIGlmIChpc0luRGVidWdNb2RlKSB7CiAgICAgICAgY29uc3QgYWxpZ25tZW50ID0gdGhpcy5fZWxlbWVudElubmVyLmdldEF0dHJpYnV0ZSgidGV4dC1hbmNob3IiKTsKICAgICAgICB0aGlzLl9lbGVtZW50SW5uZXIuc2V0QXR0cmlidXRlKAogICAgICAgICAgImZpbHRlciIsCiAgICAgICAgICBgdXJsKCNib3JkZXIke2FsaWdubWVudCA9PT0gIm1pZGRsZSIgPyAiRyIgOiBhbGlnbm1lbnQgPT09ICJlbmQiID8gIkIiIDogIlIifSlgCiAgICAgICAgKTsKICAgICAgfQoKICAgICAgdGhpcy5zZXRQb3NpdGlvbiguLi50aGlzLnBvc2l0aW9uKTsKICAgIH0KCiAgICBkaXNwb3NlKCkgewogICAgICB0aGlzLnRvZ2dsZUNsaWNrYWJsZShmYWxzZSk7CiAgICAgIHRoaXMuc2V0VGV4dCgiIik7CiAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7CiAgICAgIHRoaXMuc3R5bGVzID0gbnVsbDsKICAgICAgdGhpcy5zcGVjaWFsU3R5bGVzID0gbnVsbDsKICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7CiAgICAgIHRoaXMuX2VsZW1lbnRJbm5lciA9IG51bGw7CiAgICAgIHRoaXMuX2NsaWNrRXZlbnQgPSBudWxsOwogICAgICB0aGlzLl9jYWNoZWRJbWFnZSA9IFtudWxsLCBudWxsXTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHJ1bkhhdEV2ZW50cyhvcGNvZGUsIG9wdERhdGEpIHsKICAgIHJ1bnRpbWUuYWxsU2NyaXB0c0J5T3Bjb2RlRG8oCiAgICAgICJTUGRpc3BsYXlUZXh0VjJfIiArIG9wY29kZSwKICAgICAgKHNjcmlwdCwgdGFyZ2V0KSA9PiB7CiAgICAgICAgY29uc3QgdGhyZWFkID0gcnVudGltZS5fcHVzaFRocmVhZChzY3JpcHQuYmxvY2tJZCwgdGFyZ2V0KTsKICAgICAgICBpZiAob3B0RGF0YSkgdGhyZWFkW1RIUkVBRF9LRVldID0gb3B0RGF0YTsKICAgICAgfQogICAgKTsKICB9CgogIGZ1bmN0aW9uIGdlbmVyYXRlRGVidWdGaWx0ZXJzKCkgewogICAgLy8gU1ZHIHRleHRzIGhhdmUgbm8gYm94IGJvcmRlciB2aXN1YWwsIHNvIHdlIGhhdmUgdG8gZmFrZSBpdCB3aXRoIGZpbHRlcnMKICAgIGNvbnN0IG91dGxpbmVGaWx0ZXJzID0gWwogICAgICBbImJvcmRlclIiLCAiI2ZmMDAwMCJdLAogICAgICBbImJvcmRlckciLCAiIzAwZmYwMCJdLAogICAgICBbImJvcmRlckIiLCAiIzAwMDBmZiJdCiAgICBdOwogICAgCiAgICBsZXQgZmlsdGVycyA9ICI8ZGVmcz4iOwogICAgZm9yIChjb25zdCBmaWx0ZXIgb2Ygb3V0bGluZUZpbHRlcnMpIHsKICAgICAgZmlsdGVycyArPSBgPGZpbHRlciBpZD0iJHtmaWx0ZXJbMF19Ij5gOwogICAgICBmaWx0ZXJzICs9IGA8ZmVGbG9vZCB4PSItNTAlIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmbG9vZC1jb2xvcj0iJHtmaWx0ZXJbMV19IiBmbG9vZC1vcGFjaXR5PSIxIiByZXN1bHQ9ImZsb29kIj48L2ZlRmxvb2Q+YDsKCQkJZmlsdGVycyArPSBgPGZlTW9ycGhvbG9neSBpbj0iZmxvb2QiIG9wZXJhdG9yPSJlcm9kZSIgcmFkaXVzPSIyIiByZXN1bHQ9ImxpbmUiPjwvZmVNb3JwaG9sb2d5PmA7CgkJCWZpbHRlcnMgKz0gYDxmZUNvbXBvc2l0ZSBpbj0iZmxvb2QiIGluMj0ibGluZSIgb3BlcmF0b3I9Im91dCIgcmVzdWx0PSJib3JkZXIiPjwvZmVDb21wb3NpdGU+YDsKCQkJZmlsdGVycyArPSBgPGZlTWVyZ2U+PGZlTWVyZ2VOb2RlIGluPSJib3JkZXIiPjwvZmVNZXJnZU5vZGU+YDsKCQkJZmlsdGVycyArPSBgPGZlTWVyZ2VOb2RlIGluPSJTb3VyY2VHcmFwaGljIj48L2ZlTWVyZ2VOb2RlPjwvZmVNZXJnZT48L2ZpbHRlcj5gOwogICAgfQogICAgcmV0dXJuIGZpbHRlcnMgKyAiPC9kZWZzPiI7CiAgfQoKICBmdW5jdGlvbiB1aW50OFRvQmFzZTY0KHVpbnQ4KSB7CiAgICBsZXQgYmluYXJ5ID0gJyc7CiAgICBjb25zdCBjaHVua1NpemUgPSAweDgwMDA7CiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVpbnQ4Lmxlbmd0aDsgaSArPSBjaHVua1NpemUpIHsKICAgICAgY29uc3QgY2h1bmsgPSB1aW50OC5zdWJhcnJheShpLCBpICsgY2h1bmtTaXplKTsKICAgICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgY2h1bmspOwogICAgfQogICAgcmV0dXJuIGJ0b2EoYmluYXJ5KTsKICB9CgogIGNvbnN0IHRleHRPYmplY3RzID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICBsZXQgaXNJbkRlYnVnTW9kZSA9IGZhbHNlOwoKICBjbGFzcyBTUGRpc3BsYXlUZXh0VjIgewogICAgY29uc3RydWN0b3IoKSB7CiAgICAgIHRoaXMudGV4dE9iamVjdHMgPSB0ZXh0T2JqZWN0czsKCiAgICAgIHJ1bnRpbWUub24oIlBST0pFQ1RfU1RBUlQiLCB0aGlzLnJlbW92ZUFsbFR4dCk7CiAgICAgIHJ1bnRpbWUub24oIlBST0pFQ1RfU1RPUF9BTEwiLCB0aGlzLnJlbW92ZUFsbFR4dCk7CiAgICB9CiAgICBnZXRJbmZvKCkgewogICAgICByZXR1cm4gewogICAgICAgIGlkOiAiU1BkaXNwbGF5VGV4dFYyIiwKICAgICAgICBuYW1lOiAiRGlzcGxheSBUZXh0IFYyIiwKICAgICAgICBjb2xvcjE6ICIjNjQ3YjkxIiwKICAgICAgICBjb2xvcjI6ICIjNDY1OTY5IiwKICAgICAgICBjb2xvcjM6ICIjMzI0ODU5IiwKICAgICAgICBtZW51SWNvblVSSSwKICAgICAgICBibG9ja0ljb25VUkksCiAgICAgICAgYmxvY2tzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInByaW50VHh0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicHJpbnQgdGV4dCBbVFhUXSB3aXRoIElEIFtJRF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgSUQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFRSQU5TTEFUSU9OUy5pZCB9LAogICAgICAgICAgICAgIFRYVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogImhlbGxvIHdvcmxkIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJhZGRMaW5lIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiYWRkIGxpbmUgW1RYVF0gdG8gW0lEXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgVFhUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiAibG9yZW0gaXBzdW0iIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInJlbW92ZVR4dCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlbW92ZSB0ZXh0IFtJRF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgSUQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFRSQU5TTEFUSU9OUy5pZCB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZW1vdmVBbGxUeHQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJyZW1vdmUgYWxsIHRleHQiKQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ0eHRFeGlzdHMiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ0ZXh0IFtJRF0gZXhpc3RzPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImFsbElEcyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJhbGwgdGV4dCBJRHMiKQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ0ZXh0QXNJbWFnZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJbSURdIGFzIFtUWVBFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJJTUdfRVhQT1JUUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIkZvcm1hdHRpbmciKSB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRUZXh0Rm9udCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBmb250IG9mIFtJRF0gdG8gW0ZPTlRdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfSwKICAgICAgICAgICAgICBGT05UOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkZPTlRTIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRGb250U2l6ZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBmb250IHNpemUgb2YgW0lEXSB0byBbTlVNXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgTlVNOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAzMCB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRUZXh0QWxpZ24iLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzZXQgdGV4dCBhbGlnbm1lbnQgb2YgW0lEXSB0byBbQUxJR05NRU5UXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgQUxJR05NRU5UOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMSUdOTUVOVFMiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNldEJvbGRuZXNzIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IGJvbGRuZXNzIG9mIFtJRF0gdG8gW05VTV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgTlVNOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAxMDAgfSwKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0VGV4dFNwYWNpbmciLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzZXQgW0FUVF0gc3BhY2luZyBvZiBbSURdIHRvIFtTUEFDSU5HXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgU1BBQ0lORzogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogNSB9LAogICAgICAgICAgICAgIEFUVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJURVhUX0FUVCIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRNYXJnaW5zIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IHdpZHRoIG9mIFtJRF0gdG8gW1dJRFRIXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgV0lEVEg6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDUwIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICAiLS0tIiwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiZ2V0VGV4dEF0dHJpYnV0ZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJbQVRUXSBvZiBbSURdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfSwKICAgICAgICAgICAgICBBVFQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiQVRUUklCVVRFUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIkRlY29yYXRpb25zIikgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0VGV4dENvbG9yIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IHRleHQgY29sb3Igb2YgW0lEXSB0byBbQ09MT1JdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfSwKICAgICAgICAgICAgICBDT0xPUjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiwgZGVmYXVsdFZhbHVlOiAiIzAwMDAwMCIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0VGV4dFNoYWRvdyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBzaGFkb3cgb2YgW0lEXSB0byB4IFt4XSB5IFt5XSB6IFt6XSBjb2xvciBbQ09MT1JdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfSwKICAgICAgICAgICAgICB4OiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAwIH0sCiAgICAgICAgICAgICAgeTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMCB9LAogICAgICAgICAgICAgIHo6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDUgfSwKICAgICAgICAgICAgICBDT0xPUjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRUZXh0T3V0bGluZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBvdXRsaW5lIG9mIFtJRF0gdG8gW0NPTE9SXSB3aXRoIHRoaWNrbmVzcyBbVEhJQ0tORVNTXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgQ09MT1I6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuQ09MT1IgfSwKICAgICAgICAgICAgICBUSElDS05FU1M6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDMgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0TGluZURlY29yIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IGxpbmUgZGVjb3JhdGlvbiBvZiBbSURdIHRvIFtUWVBFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJMSU5FX1RZUEUiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICAiLS0tIiwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0VGV4dEN1cnZlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IGN1cnZlIG9mIFtJRF0gdG8gW1BBVEhdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfSwKICAgICAgICAgICAgICBQQVRIOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZXhlbXB0RnJvbU5vcm1hbGl6YXRpb246IHRydWUsIGRlZmF1bHRWYWx1ZTogIltbLTEwMCwgLTUwXSwgWzAsIDUwXSwgWzEwMCwgLTUwXV0iIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInByZXNldEN1cnZlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInByZXNldCBjdXJ2ZSBbQVJDXSIpLAogICAgICAgICAgICBkaXNhYmxlTW9uaXRvcjogdHJ1ZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgQVJDOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFSQ1MiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICAiLS0tIiwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAibWFrZVN2Z0dyYWRpZW50IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIltUWVBFXSBncmFkaWVudCBjb2xvcmVkIFtDT0xPUjFdIGFuZCBbQ09MT1IyXSBhdCBhbmdsZSBbQU5HTEVdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIENPTE9SMTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5DT0xPUiwgZGVmYXVsdFZhbHVlOiAiI2ZmMDAwMCIgfSwKICAgICAgICAgICAgICBDT0xPUjI6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuQ09MT1IsIGRlZmF1bHRWYWx1ZTogIiMwMGZmMDAiIH0sCiAgICAgICAgICAgICAgQU5HTEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuQU5HTEUsIGRlZmF1bHRWYWx1ZTogOTAgfSwKICAgICAgICAgICAgICBUWVBFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkdSQURJRU5UX1RZUEVTIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgeyBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkxBQkVMLCB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiUG9zaXRpb25pbmciKSB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRUZXh0UG9zaXRpb24iLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzZXQgcG9zaXRpb24gb2YgW0lEXSB0byB4IFt4XSB5IFt5XSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgeDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMCB9LAogICAgICAgICAgICAgIHk6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDAgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAidGV4dFBvc2l0aW9uIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIltBVFRdIG9mIFtJRF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgSUQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFRSQU5TTEFUSU9OUy5pZCB9LAogICAgICAgICAgICAgIEFUVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJQT1MiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7IGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuTEFCRUwsIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJFZmZlY3RzIikgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0RWZmZWN0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IFtFRkZFQ1RdIG9mIFtJRF0gdG8gW1ZBTFVFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgVkFMVUU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDUgfSwKICAgICAgICAgICAgICBFRkZFQ1Q6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiRUZGRUNUUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYW10T2ZFZmZlY3QiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiW0VGRkVDVF0gb2YgW0lEXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBFRkZFQ1Q6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiRUZGRUNUUyIgfSwKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInJlc2V0RWZmZWN0cyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlc2V0IGVmZmVjdHMgb2YgW0lEXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7IGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuTEFCRUwsIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJBZHZhbmNlZCIpIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGZ1bmM6ICJtYXJrZG93blR1dG9yaWFsIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CVVRUT04sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJNYXJrZG93biBGb3JtYXR0aW5nIikKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImRlYnVnIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgidG9nZ2xlIGRlYnVnIG1vZGUgW1RPR0dMRV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgVE9HR0xFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlRPR0dMRSIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZXNldFR4dCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlc2V0IHN0eWxpbmdzIG9mIFtJRF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgSUQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFRSQU5TTEFUSU9OUy5pZCB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZXVzZVN0eWxlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmV1c2Ugc3R5bGluZ3Mgb2YgW0lEXSB0byBbSUQyXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgSUQyOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgKyAiMiIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ0b2dnbGVTZWxlY3QiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ0b2dnbGUgaGlnaGxpZ2h0aW5nIGZvciBJRCBbSURdIFtUWVBFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBJRDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogVFJBTlNMQVRJT05TLmlkIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUT0dHTEUiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInRvZ2dsZUNsaWNrYWJsZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInRvZ2dsZSBjbGlja2luZyBmb3IgW0lEXSBbVFlQRV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgSUQ6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFRSQU5TTEFUSU9OUy5pZCB9LAogICAgICAgICAgICAgIFRZUEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVE9HR0xFIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJpc0NsaWNrZWQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJbSURdIGNsaWNrZWQ/IiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hlblRleHRDbGlja2VkIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5IQVQsCiAgICAgICAgICAgIGlzRWRnZUFjdGl2YXRlZDogZmFsc2UsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3aGVuIFtJRF0gdGV4dCBjbGlja2VkIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIElEOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBUUkFOU0xBVElPTlMuaWQgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICBdLAogICAgICAgIG1lbnVzOiB7CiAgICAgICAgICBGT05UUzogeyBhY2NlcHRSZXBvcnRlcnM6IHRydWUsIGl0ZW1zOiAiX2dldEZvbnRzIiwgaXNUeXBlYWJsZTogdHJ1ZSB9LAogICAgICAgICAgRUZGRUNUUzogeyBhY2NlcHRSZXBvcnRlcnM6IHRydWUsIGl0ZW1zOiAiX2dldEVmZmVjdHMiIH0sCiAgICAgICAgICBUT0dHTEU6IFsKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgib24iKSwgdmFsdWU6ICJvbiIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgib2ZmIiksIHZhbHVlOiAib2ZmIiB9CiAgICAgICAgICBdLAogICAgICAgICAgSU1HX0VYUE9SVFM6IFsKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic3ZnIiksIHZhbHVlOiAic3ZnIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJwbmciKSwgdmFsdWU6ICJwbmciIH0KICAgICAgICAgIF0sCiAgICAgICAgICBURVhUX0FUVDogWwogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJsZXR0ZXIiKSwgdmFsdWU6ICJsZXR0ZXIiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImxpbmUiKSwgdmFsdWU6ICJsaW5lIiB9CiAgICAgICAgICBdLAogICAgICAgICAgUE9TOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInggcG9zaXRpb24iKSwgdmFsdWU6ICJ4IiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ5IHBvc2l0aW9uIiksIHZhbHVlOiAieSIgfQogICAgICAgICAgXSwKICAgICAgICAgIEFSQ1M6IFsKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiY2lyY2xlIiksIHZhbHVlOiAiY2lyY2xlIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJoaWxsIiksIHZhbHVlOiAiaGlsbCIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiZGlwIiksIHZhbHVlOiAiZGlwIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3YXZlIiksIHZhbHVlOiAid2F2ZSIgfQogICAgICAgICAgXSwKICAgICAgICAgIEdSQURJRU5UX1RZUEVTOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImxpbmVhciIpLCB2YWx1ZTogImxpbmVhciIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmFkaWFsIiksIHZhbHVlOiAicmFkaWFsIiB9CiAgICAgICAgICBdLAogICAgICAgICAgQUxJR05NRU5UUzogewogICAgICAgICAgICBhY2NlcHRSZXBvcnRlcnM6IHRydWUsCiAgICAgICAgICAgIGl0ZW1zOiBbCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibGVmdCIpLCB2YWx1ZTogInN0YXJ0IiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJpZ2h0IiksIHZhbHVlOiAiZW5kIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImNlbnRlciIpLCB2YWx1ZTogIm1pZGRsZSIgfQogICAgICAgICAgICBdCiAgICAgICAgICB9LAogICAgICAgICAgTElORV9UWVBFOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ1bmRlcmxpbmUiKSwgdmFsdWU6ICJ1bmRlcmxpbmUiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic3RyaWtldGhyb3VnaCIpLCB2YWx1ZTogInN0cmlrZXRocm91Z2giIH0KICAgICAgICAgICAgXQogICAgICAgICAgfSwKICAgICAgICAgIEFUVFJJQlVURVM6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImxpbmUgY291bnQiKSwgdmFsdWU6ICJsaW5lQ291bnQiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiZm9udCIpLCB2YWx1ZTogImZvbnQiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiZm9udCBzaXplIiksIHZhbHVlOiAic2l6ZSIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJib2xkbmVzcyIpLCB2YWx1ZTogIndlaWdodCIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJtYXJnaW4gd2lkdGgiKSwgdmFsdWU6ICJ3aWR0aCIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJkaXNwbGF5IHdpZHRoIiksIHZhbHVlOiAiYm94VyIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJkaXNwbGF5IGhlaWdodCIpLCB2YWx1ZTogImJveEgiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibGV0dGVyIHNwYWNpbmciKSwgdmFsdWU6ICJsZXR0ZXIiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibGluZSBzcGFjaW5nIiksIHZhbHVlOiAibGluZSIgfSwKICAgICAgICAgICAgXQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIH0KCiAgICAvLyBIZWxwZXIgRnVuY3MKICAgIF9nZXRGb250cygpIHsKICAgICAgaWYgKHJ1bnRpbWUuZm9udE1hbmFnZXIpIHsKICAgICAgICBjb25zdCBjdXN0b21Gb250cyA9IHJ1bnRpbWUuZm9udE1hbmFnZXIuZ2V0Rm9udHMoKS5tYXAoKGYpID0+ICh7CiAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZShmLm5hbWUpLCB2YWx1ZTogZi5mYW1pbHkKICAgICAgICB9KSk7CiAgICAgICAgcmV0dXJuIFsuLi5CVUlMVF9JTl9GT05UUywgLi4uY3VzdG9tRm9udHNdOwogICAgICB9CiAgICAgIHJldHVybiBCVUlMVF9JTl9GT05UUzsKICAgIH0KCiAgICBfZ2V0RWZmZWN0cygpIHsKICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKEVGRkVDVF9IQU5ETEVSUykubWFwKChlKSA9PiB7CiAgICAgICAgcmV0dXJuIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoZSksIHZhbHVlOiBlIH07CiAgICAgIH0pOwogICAgfQoKICAgIGluamVjdEZvbnRUb0RPTShkb20sIHRleHRPYmopIHsKICAgICAgLy8gZ2V0IGFsbCB1c2VkIGZvbnQgbmFtZXMKICAgICAgY29uc3QgZm9udHNJblVzZSA9IFtdOwogICAgICBjb25zdCBpbm5lckVsZW1lbnQgPSB0ZXh0T2JqLl9lbGVtZW50SW5uZXI7CgogICAgICBpZiAoaW5uZXJFbGVtZW50Lmhhc0F0dHJpYnV0ZSgiZm9udC1mYW1pbHkiKSkgewogICAgICAgIGZvbnRzSW5Vc2UucHVzaChpbm5lckVsZW1lbnQuZ2V0QXR0cmlidXRlKCJmb250LWZhbWlseSIpKTsKICAgICAgfQogICAgICBjb25zdCBjaGlsZHJlbiA9IEFycmF5LmZyb20oaW5uZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInRzcGFuIikpOwogICAgICBmb3IgKGNvbnN0IHNwYW4gb2YgY2hpbGRyZW4pIHsKICAgICAgICBpZiAoc3Bhbi5oYXNBdHRyaWJ1dGUoImZvbnQtZmFtaWx5IikpIHsKICAgICAgICAgIGZvbnRzSW5Vc2UucHVzaChzcGFuLmdldEF0dHJpYnV0ZSgiZm9udC1mYW1pbHkiKSk7CiAgICAgICAgfQogICAgICB9CgogICAgICAvLyB0cnkgYW5kIGNvbnZlcnQgZm9udHMgdG8gcHJvcGVybHkgZXhwb3J0CiAgICAgIGNvbnN0IGZvbnRTdHlsZXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgInN0eWxlIik7CgogICAgICBjb25zdCBiYXNpY0ZvbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihgc3R5bGVbaWQ9InNjcmF0Y2gtZm9udC1zdHlsZXNgKTsKICAgICAgZm9udFN0eWxlcy50ZXh0Q29udGVudCA9IGJhc2ljRm9udHMudGV4dENvbnRlbnQ7CgogICAgICBjb25zdCBjdXN0b21Gb250cyA9IHJ1bnRpbWUuZm9udE1hbmFnZXIuZm9udHMuZmlsdGVyKGYgPT4gIWYuc3lzdGVtKTsKICAgICAgZm9yIChjb25zdCBmb250IG9mIGN1c3RvbUZvbnRzKSB7CiAgICAgICAgY29uc3QgcHJvcGVyTmFtZSA9IGAiJHtmb250LmZhbWlseX0iLCAke2ZvbnQuZmFsbGJhY2t9YDsKICAgICAgICBpZiAoIWZvbnQuYXNzZXQgfHwgIWZvbnRzSW5Vc2UuaW5jbHVkZXMocHJvcGVyTmFtZSkpIGNvbnRpbnVlOwoKICAgICAgICBjb25zdCBiYXNlNjQgPSB1aW50OFRvQmFzZTY0KGZvbnQuYXNzZXQuZGF0YSk7CgogICAgICAgIC8vIG5vcm1hbGl6ZSBmb3JtYXQgZm9yIGJyb3dzZXIgY29tcGF0aWJpbGl0eQogICAgICAgIGxldCBmb3JtYXQgPSBmb250LmFzc2V0LmRhdGFGb3JtYXQudG9Mb3dlckNhc2UoKTsKICAgICAgICBpZiAoZm9ybWF0ID09PSAib3RmIikgZm9ybWF0ID0gIm9wZW50eXBlIjsKICAgICAgICBpZiAoZm9ybWF0ID09PSAidHRmIikgZm9ybWF0ID0gInRydWV0eXBlIjsKICAgICAgICAKICAgICAgICBmb250U3R5bGVzLnRleHRDb250ZW50ICs9IGBAZm9udC1mYWNlIHtmb250LWZhbWlseTogIiR7Zm9udC5mYW1pbHl9IjtgOwogICAgICAgIGZvbnRTdHlsZXMudGV4dENvbnRlbnQgKz0gYHNyYzogdXJsKCdkYXRhOmZvbnQvJHtmb3JtYXR9O2Jhc2U2NCwke2Jhc2U2NH0nKSBmb3JtYXQoJyR7Zm9ybWF0fScpO31gOwogICAgICB9CgogICAgICBkb20uYXBwZW5kQ2hpbGQoZm9udFN0eWxlcyk7CiAgICB9CgogICAgbWFya2Rvd25UdXRvcmlhbCgpIHsKICAgICAgYWxlcnQoWwogICAgICAgICJIb3cgdG8gdXNlIE1hcmtkb3duIGluIERpc3BsYXkgVGV4dCBWMiIsCiAgICAgICAgIkJvbGQgVGV4dCDihpIgKip0ZXh0KioiLAogICAgICAgICJJdGFsaWMgVGV4dCDihpIgKi90ZXh0Ki8iLAogICAgICAgICJTdHJpa2UgVGV4dCDihpIgfn50ZXh0fn4iLAogICAgICAgICJVbmRlcmxpbmUgVGV4dCDihpIgX190ZXh0X18iLAogICAgICAgICJIZWFkZXIgVGV4dCAxIOKGkiAjIHRleHQjICIsCiAgICAgICAgIkhlYWRlciBUZXh0IDIg4oaSICMjdGV4dCMjIiwKICAgICAgICAiIiwKICAgICAgICAiVGV4dCBDb2xvciDihpIgQGNbI2ZmMDAwMF10ZXh0QGMiLAogICAgICAgICJUZXh0IEZvbnQg4oaSIEBmW0NvbWljIFNhbnMgTXNddGV4dEBmIgogICAgICBdLmpvaW4oIlxuIikpOwogICAgfQoKICAgIC8vIEJsb2NrIEZ1bmNzCiAgICBwcmludFR4dChhcmdzKSB7CiAgICAgIGNvbnN0IGlkID0gQ2FzdC50b1N0cmluZyhhcmdzLklEKTsKICAgICAgY29uc3QgdGV4dCA9IENhc3QudG9TdHJpbmcoYXJncy5UWFQpOwogICAgICBsZXQgdGV4dE9iajsKICAgICAgaWYgKHRleHRPYmplY3RzW2lkXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGV4dE9iaiA9IG5ldyB0ZXh0T2JqZWN0KGlkLCB0ZXh0KTsKICAgICAgICB0ZXh0T2JqZWN0c1tpZF0gPSB0ZXh0T2JqOwogICAgICAgIHRleHRPYmouaW5pdEVsZW1lbnQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0T2JqID0gdGV4dE9iamVjdHNbaWRdOwogICAgICAgIHRleHRPYmouc2V0VGV4dCh0ZXh0KTsKICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQoZmFsc2UpOwogICAgICB9CiAgICB9CgogICAgYWRkTGluZShhcmdzKSB7CiAgICAgIGNvbnN0IGlkID0gQ2FzdC50b1N0cmluZyhhcmdzLklEKTsKICAgICAgY29uc3QgdGV4dCA9IENhc3QudG9TdHJpbmcoYXJncy5UWFQpOwogICAgICBsZXQgdGV4dE9iajsKICAgICAgaWYgKHRleHRPYmplY3RzW2lkXSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGV4dE9iaiA9IG5ldyB0ZXh0T2JqZWN0KGlkLCB0ZXh0KTsKICAgICAgICB0ZXh0T2JqZWN0c1tpZF0gPSB0ZXh0T2JqOwogICAgICAgIHRleHRPYmouaW5pdEVsZW1lbnQoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZXh0T2JqID0gdGV4dE9iamVjdHNbaWRdOwogICAgICAgIHRleHRPYmouc2V0VGV4dCh0ZXh0T2JqLnJhd1RleHQgKyAiXG4iICsgdGV4dCk7CiAgICAgICAgdGV4dE9iai51cGRhdGVFbGVtZW50KGZhbHNlKTsKICAgICAgfQogICAgfQoKICAgIHJlbW92ZVR4dChhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICB0ZXh0T2JqLmRpc3Bvc2UoKTsKICAgICAgICBkZWxldGUgdGV4dE9iamVjdHNbdGV4dE9iai5pZF07CiAgICAgIH0KICAgIH0KCiAgICByZW1vdmVBbGxUeHQoKSB7CiAgICAgIGZvciAoY29uc3QgdGV4dE9iaiBvZiBPYmplY3QudmFsdWVzKHRleHRPYmplY3RzKSkgewogICAgICAgIHRleHRPYmouZGlzcG9zZSgpOwogICAgICAgIGRlbGV0ZSB0ZXh0T2JqZWN0c1t0ZXh0T2JqLmlkXTsKICAgICAgfQogICAgfQoKICAgIHR4dEV4aXN0cyhhcmdzKSB7CiAgICAgIHJldHVybiB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXSAhPT0gdW5kZWZpbmVkOwogICAgfQoKICAgIGFsbElEcygpIHsKICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KE9iamVjdC5rZXlzKHRleHRPYmplY3RzKSk7CiAgICB9CgogICAgdGV4dEFzSW1hZ2UoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgY29uc3QgdHlwZSA9IGFyZ3MuVFlQRSA9PT0gInN2ZyIgPyAwIDogMTsKICAgICAgICBpZiAodGV4dE9iai5fY2FjaGVkSW1hZ2VbdHlwZV0pIHJldHVybiB0ZXh0T2JqLl9jYWNoZWRJbWFnZVt0eXBlXTsKCiAgICAgICAgY29uc3QgYm91bmRzID0gdGV4dE9iai5fZWxlbWVudC5nZXRCQm94KCk7CiAgICAgICAgY29uc3QgY2xvbmUgPSB0ZXh0T2JqLl9lbGVtZW50LmNsb25lTm9kZSh0cnVlKTsKICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgYm91bmRzLndpZHRoKTsKICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIGJvdW5kcy5oZWlnaHQpOwogICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZSgidmlld0JveCIsIGAke2JvdW5kcy54fSAke2JvdW5kcy55fSAke2JvdW5kcy53aWR0aH0gJHtib3VuZHMuaGVpZ2h0fWApOwogICAgICAgIGNsb25lLnN0eWxlLnRyYW5zZm9ybSA9ICIiOwogICAgICAgIHRoaXMuaW5qZWN0Rm9udFRvRE9NKGNsb25lLCB0ZXh0T2JqKTsKCiAgICAgICAgbGV0IGltYWdlID0gY2xvbmUub3V0ZXJIVE1MOwogICAgICAgIGNsb25lLnJlbW92ZSgpOwoKICAgICAgICBpZiAodHlwZSA9PT0gMCkgewogICAgICAgICAgdGV4dE9iai5fY2FjaGVkSW1hZ2VbMF0gPSBpbWFnZTsKICAgICAgICAgIHJldHVybiBpbWFnZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImNhbnZhcyIpOwogICAgICAgICAgICBjYW52YXMud2lkdGggPSBNYXRoLmNlaWwoYm91bmRzLndpZHRoICogMik7CiAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBNYXRoLmNlaWwoYm91bmRzLmhlaWdodCAqIDIpOwoKICAgICAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoIjJkIik7CiAgICAgICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2ltYWdlXSwgeyB0eXBlOiAiaW1hZ2Uvc3ZnK3htbDtjaGFyc2V0PXV0Zi04IiB9KTsKICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKCiAgICAgICAgICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7CiAgICAgICAgICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGggKiAyLCBjYW52YXMuaGVpZ2h0ICogMik7CiAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApOwogICAgICAgICAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKCiAgICAgICAgICAgICAgY29uc3QgcG5nID0gY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIik7CiAgICAgICAgICAgICAgdGV4dE9iai5fY2FjaGVkSW1hZ2VbMV0gPSBwbmc7CiAgICAgICAgICAgICAgcmVzb2x2ZShwbmcpOwogICAgICAgICAgICB9OwogICAgICAgICAgICBpbWcuc3JjID0gdXJsOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiAiIjsKICAgIH0KCiAgICBzZXRUZXh0Rm9udChhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgiZm9udC1mYW1pbHkiLCBDYXN0LnRvU3RyaW5nKGFyZ3MuRk9OVCkpOwogICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudCh0cnVlKTsKICAgICAgfQogICAgfQoKICAgIHNldEZvbnRTaXplKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIHRleHRPYmouc2V0QXR0cmlidXRlKCJmb250LXNpemUiLCBDYXN0LnRvTnVtYmVyKGFyZ3MuTlVNKSk7CiAgICAgICAgdGV4dE9iai51cGRhdGVFbGVtZW50KHRydWUpOwogICAgICB9CiAgICB9CgogICAgc2V0VGV4dEFsaWduKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIHRleHRPYmouc2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIsIENhc3QudG9TdHJpbmcoYXJncy5BTElHTk1FTlQpKTsKICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQodHJ1ZSk7CiAgICAgIH0KICAgIH0KCiAgICBzZXRCb2xkbmVzcyhhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICAvLyBub3JtYWxpemUgYm9sZFZhbHVlIGZyb20gLTEwMCAtIDkwMAogICAgICAgIGxldCBib2xkVmFsdWUgPSBDYXN0LnRvTnVtYmVyKGFyZ3MuTlVNKSAqIDEwOwogICAgICAgIGJvbGRWYWx1ZSAtPSAxMDA7CgogICAgICAgIHRleHRPYmouc2V0QXR0cmlidXRlKCJmb250LXdlaWdodCIsIGJvbGRWYWx1ZSk7CiAgICAgICAgdGV4dE9iai51cGRhdGVFbGVtZW50KHRydWUpOwogICAgICB9CiAgICB9CgogICAgc2V0VGV4dFNwYWNpbmcoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgY29uc3Qgc3BhY2luZyA9IENhc3QudG9OdW1iZXIoYXJncy5TUEFDSU5HKTsKICAgICAgICBpZiAoYXJncy5BVFQgPT09ICJsZXR0ZXIiKSB7CiAgICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgibGV0dGVyLXNwYWNpbmciLCBzcGFjaW5nKTsKICAgICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudCh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoImxpbmUtaGVpZ2h0Iiwgc3BhY2luZywgdHJ1ZSk7CiAgICAgICAgICBpZiAoIXRleHRPYmouX2RpcnR5KSByZXR1cm47CgogICAgICAgICAgLy8gZm9yY2UgYSByZWZsb3cgaWYgdGhlcmUgaXMgbm8gbWFyZ2lucwogICAgICAgICAgY29uc3Qgd3JhcFdpZHRoID0gdGV4dE9iai5zcGVjaWFsU3R5bGVzLmdldCgid2lkdGgiKTsKICAgICAgICAgIGlmICghd3JhcFdpZHRoIHx8IHdyYXBXaWR0aCA8IDEpIHsKICAgICAgICAgICAgY29uc3Qgb2xkUmF3VGV4dCA9IHRleHRPYmoucmF3VGV4dDsKICAgICAgICAgICAgdGV4dE9iai5yYXdUZXh0ID0gdW5kZWZpbmVkOwogICAgICAgICAgICB0ZXh0T2JqLnNldFRleHQob2xkUmF3VGV4dCk7CiAgICAgICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudChmYWxzZSwgdHJ1ZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0ZXh0T2JqLndyYXBUZXh0KHdyYXBXaWR0aCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc2V0TWFyZ2lucyhhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgid2lkdGgiLCBDYXN0LnRvTnVtYmVyKGFyZ3MuV0lEVEgpLCB0cnVlKTsKICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQodHJ1ZSwgdHJ1ZSk7CiAgICAgIH0KICAgIH0KCiAgICBnZXRUZXh0QXR0cmlidXRlKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIGNvbnN0IHN0eWxlcyA9IHRleHRPYmouc3R5bGVzOwogICAgICAgIHN3aXRjaCAoQ2FzdC50b1N0cmluZyhhcmdzLkFUVCkpIHsKICAgICAgICAgIGNhc2UgImxpbmVDb3VudCI6IHJldHVybiB0ZXh0T2JqLl9lbGVtZW50SW5uZXIuY2hpbGRyZW4ubGVuZ3RoOwogICAgICAgICAgY2FzZSAiZm9udCI6IHJldHVybiBzdHlsZXMuZ2V0KCJmb250LWZhbWlseSIpIHx8ICJBcmlhbCI7CiAgICAgICAgICBjYXNlICJzaXplIjogcmV0dXJuIHN0eWxlcy5nZXQoImZvbnQtc2l6ZSIpIHx8IDE2OwogICAgICAgICAgY2FzZSAid2VpZ2h0IjogewogICAgICAgICAgICBjb25zdCB3ZWlnaHQgPSBzdHlsZXMuZ2V0KCJmb250LXdlaWdodCIpIHx8IC0xMDA7CiAgICAgICAgICAgIHJldHVybiAod2VpZ2h0ICsgMTAwKSAvIDEwOwogICAgICAgICAgfQogICAgICAgICAgY2FzZSAibGV0dGVyIjogcmV0dXJuIHN0eWxlcy5nZXQoImxldHRlci1zcGFjaW5nIikgfHwgMDsKICAgICAgICAgIGNhc2UgImxpbmUiOiByZXR1cm4gdGV4dE9iai5zcGVjaWFsU3R5bGVzLmdldCgibGluZS1oZWlnaHQiKSB8fCAxOwogICAgICAgICAgY2FzZSAid2lkdGgiOiByZXR1cm4gdGV4dE9iai5zcGVjaWFsU3R5bGVzLmdldCgid2lkdGgiKSB8fCAtMTsKICAgICAgICAgIGNhc2UgImJveFciOiB7CiAgICAgICAgICAgIGNvbnN0IGJvdW5kcyA9IHRleHRPYmouX2VsZW1lbnRJbm5lci5nZXRCQm94KCk7CiAgICAgICAgICAgIHJldHVybiBib3VuZHMud2lkdGg7CiAgICAgICAgICB9CiAgICAgICAgICBjYXNlICJib3hIIjogewogICAgICAgICAgICBjb25zdCBib3VuZHMgPSB0ZXh0T2JqLl9lbGVtZW50SW5uZXIuZ2V0QkJveCgpOwogICAgICAgICAgICByZXR1cm4gYm91bmRzLmhlaWdodDsKICAgICAgICAgIH0KICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiAiIjsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuICIiOwogICAgfQoKICAgIHNldFRleHRDb2xvcihhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICBsZXQgY29sb3IgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuQ09MT1IpOwogICAgICAgIGxldCBpc0dyYWRpZW50ID0gZmFsc2U7CiAgICAgICAgaWYgKGNvbG9yLnN0YXJ0c1dpdGgoIjwiKSAmJiBjb2xvci5lbmRzV2l0aCgiR3JhZGllbnQ+IikpIHsKICAgICAgICAgIGlzR3JhZGllbnQgPSB0cnVlCiAgICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgiZ3JhZGllbnQiLCBbMSwgY29sb3JdLCB0cnVlKTsKICAgICAgICAgIGNvbG9yID0gInVybCgjZ3JhZENvbG9yMSkiOwogICAgICAgIH0KICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgiZmlsbCIsIGNvbG9yKTsKICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQodHJ1ZSwgaXNHcmFkaWVudCk7CiAgICAgIH0KICAgIH0KCiAgICBzZXRUZXh0U2hhZG93KGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIGNvbnN0IHBvc2l0aW9uID0gewogICAgICAgICAgeDogQ2FzdC50b051bWJlcihhcmdzLngpLAogICAgICAgICAgeTogQ2FzdC50b051bWJlcihhcmdzLnkpLAogICAgICAgICAgejogQ2FzdC50b051bWJlcihhcmdzLnopCiAgICAgICAgfTsKICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgKICAgICAgICAgICJ0ZXh0LXNoYWRvdyIsCiAgICAgICAgICBwb3NpdGlvbi56ID09PSAwID8gIm5vbmUiIDogYCR7cG9zaXRpb24ueH1weCAke3Bvc2l0aW9uLnl9cHggJHtwb3NpdGlvbi56fXB4ICR7YXJncy5DT0xPUn1gLAogICAgICAgICAgdHJ1ZQogICAgICAgICk7CiAgICAgICAgdGV4dE9iai51cGRhdGVFbGVtZW50KHRydWUsIHRydWUpOwogICAgICB9CiAgICB9CgogICAgc2V0VGV4dE91dGxpbmUoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgbGV0IGNvbG9yID0gQ2FzdC50b1N0cmluZyhhcmdzLkNPTE9SKTsKICAgICAgICBsZXQgaXNHcmFkaWVudCA9IGZhbHNlOwogICAgICAgIGlmIChjb2xvci5zdGFydHNXaXRoKCI8IikgJiYgY29sb3IuZW5kc1dpdGgoIkdyYWRpZW50PiIpKSB7CiAgICAgICAgICBpc0dyYWRpZW50ID0gdHJ1ZQogICAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoImdyYWRpZW50IiwgWzIsIGNvbG9yXSwgdHJ1ZSk7CiAgICAgICAgICBjb2xvciA9ICJ1cmwoI2dyYWRDb2xvcjIpIjsKICAgICAgICB9CiAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoInN0cm9rZSIsIGNvbG9yKTsKICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgic3Ryb2tlLXdpZHRoIiwgQ2FzdC50b051bWJlcihhcmdzLlRISUNLTkVTUykgKyAicHgiKTsKICAgICAgICB0ZXh0T2JqLnNldEF0dHJpYnV0ZSgic3Ryb2tlLWxpbmVqb2luIiwgInJvdW5kIik7CiAgICAgICAgdGV4dE9iai51cGRhdGVFbGVtZW50KHRydWUsIGlzR3JhZGllbnQpOwogICAgICB9CiAgICB9CgogICAgc2V0TGluZURlY29yKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIGNvbnN0IHR5cGUgPSBhcmdzLlRZUEUgPT09ICJzdHJpa2V0aHJvdWdoIiA/ICJsaW5lLXRocm91Z2giIDogInVuZGVybGluZSI7CiAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoInRleHQtZGVjb3JhdGlvbiIsIHR5cGUpOwogICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudCh0cnVlKTsKICAgICAgfQogICAgfQoKICAgIHNldFRleHRDdXJ2ZShhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICB0cnkgewogICAgICAgICAgY29uc3QgcGF0aFBvaW50cyA9IHR5cGVvZiBhcmdzLlBBVEggPT09ICJvYmplY3QiID8gYXJncy5QQVRIIDogSlNPTi5wYXJzZShhcmdzLlBBVEgpOwogICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHBhdGhQb2ludHMpKSByZXR1cm47CgogICAgICAgICAgaWYgKHBhdGhQb2ludHMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIHRleHRPYmouc2V0QXR0cmlidXRlKCJjdXJ2ZSIsIG51bGwsIHRydWUpOwogICAgICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQodHJ1ZSwgdHJ1ZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgcGF0aFN0cmluZyA9ICIiOwogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoUG9pbnRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGNvbnN0IGNvb3JkID0gcGF0aFBvaW50c1tpXTsKICAgICAgICAgICAgY29uc3QgeCA9IGNvb3JkID8gQ2FzdC50b051bWJlcihjb29yZFswXSkgOiAwOwogICAgICAgICAgICBjb25zdCB5ID0gY29vcmQgPyBDYXN0LnRvTnVtYmVyKGNvb3JkWzFdKSAqIC0xIDogMDsKICAgICAgICAgICAgcGF0aFN0cmluZyArPSBpID09PSAwID8gYE0gJHt4fSAke3l9YCA6IGBMICR7eH0gJHt5fWA7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAicGF0aCIpOwogICAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoImQiLCBwYXRoU3RyaW5nKTsKICAgICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCJpZCIsICJjdXJ2ZS0iICsgdGV4dE9iai5pZCk7CiAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgiZmlsbCIsICJub25lIik7CgogICAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoImN1cnZlIiwgcGF0aCwgdHJ1ZSk7CiAgICAgICAgICB0ZXh0T2JqLnVwZGF0ZUVsZW1lbnQodHJ1ZSwgdHJ1ZSk7CiAgICAgICAgfSBjYXRjaCB7fQogICAgICB9CiAgICB9CgogICAgcHJlc2V0Q3VydmUoYXJncykgewogICAgICByZXR1cm4gewogICAgICAgIGNpcmNsZTogYFtbLTIzLC00NV0sWy0yOSwtNDBdLFstMzUsLTM1XSxbLTQwLC0yOV0sWy00NSwtMjNdLFstNDgsLTE1XSxbLTQ5LC04XSxbLTUwLDBdLFstNDksOF0sWy00OCwxNV0sWy00NSwyM10sWy00MCwyOV0sWy0zNSwzNV0sWy0yOSw0MF0sWy0yMyw0NV0sWy0xNSw0OF0sWy04LDQ5XSxbMCw1MF0sWzgsNDldLFsxNSw0OF0sWzIzLDQ1XSxbMjksNDBdLFszNSwzNV0sWzQwLDI5XSxbNDUsMjNdLFs0OCwxNV0sWzQ5LDhdLFs1MCwwXSxbNDksLThdLFs0OCwtMTVdLFs0NSwtMjNdLFs0MCwtMjldLFszNSwtMzVdLFsyOSwtNDBdLFsyMywtNDVdLFsxNSwtNDhdLFs4LC00OV0sWzAsLTUwXSxbLTgsLTQ5XSxbLTE1LC00OF0sWy0yMywtNDVdXWAsCiAgICAgICAgZGlwOiBgW1swLDBdLFs1LC00XSxbMTAsLThdLFsxNSwtMTJdLFsyMCwtMTVdLFsyNSwtMTldLFszMCwtMjNdLFszNSwtMjZdLFs0MCwtMjldLFs0NSwtMzJdLFs1MCwtMzVdLFs1NSwtMzhdLFs2MCwtNDBdLFs2NSwtNDNdLFs3MCwtNDVdLFs3NSwtNDZdLFs4MCwtNDhdLFs4NSwtNDldLFs5MCwtNDldLFs5NSwtNTBdLFsxMDAsLTUwXSxbMTA1LC01MF0sWzExMCwtNDldLFsxMTUsLTQ5XSxbMTIwLC00OF0sWzEyNSwtNDZdLFsxMzAsLTQ1XSxbMTM1LC00M10sWzE0MCwtNDBdLFsxNDUsLTM4XSxbMTUwLC0zNV0sWzE1NSwtMzJdLFsxNjAsLTI5XSxbMTY1LC0yNl0sWzE3MCwtMjNdLFsxNzUsLTE5XSxbMTgwLC0xNV0sWzE4NSwtMTJdLFsxOTAsLThdLFsxOTUsLTRdLFsyMDAsMF1dYCwKICAgICAgICBoaWxsOiBgW1swLDBdLFs1LDRdLFsxMCw4XSxbMTUsMTJdLFsyMCwxNV0sWzI1LDE5XSxbMzAsMjNdLFszNSwyNl0sWzQwLDI5XSxbNDUsMzJdLFs1MCwzNV0sWzU1LDM4XSxbNjAsNDBdLFs2NSw0M10sWzcwLDQ1XSxbNzUsNDZdLFs4MCw0OF0sWzg1LDQ5XSxbOTAsNDldLFs5NSw1MF0sWzEwMCw1MF0sWzEwNSw1MF0sWzExMCw0OV0sWzExNSw0OV0sWzEyMCw0OF0sWzEyNSw0Nl0sWzEzMCw0NV0sWzEzNSw0M10sWzE0MCw0MF0sWzE0NSwzOF0sWzE1MCwzNV0sWzE1NSwzMl0sWzE2MCwyOV0sWzE2NSwyNl0sWzE3MCwyM10sWzE3NSwxOV0sWzE4MCwxNV0sWzE4NSwxMl0sWzE5MCw4XSxbMTk1LDRdLFsyMDAsMF1dYCwKICAgICAgICB3YXZlOiBgW1swLDBdLFs1LC04XSxbMTAsLTE1XSxbMTUsLTIzXSxbMjAsLTI5XSxbMjUsLTM1XSxbMzAsLTQwXSxbMzUsLTQ1XSxbNDAsLTQ4XSxbNDUsLTQ5XSxbNTAsLTUwXSxbNTUsLTQ5XSxbNjAsLTQ4XSxbNjUsLTQ1XSxbNzAsLTQwXSxbNzUsLTM1XSxbODAsLTI5XSxbODUsLTIzXSxbOTAsLTE1XSxbOTUsLThdLFsxMDAsMF0sWzEwNSw4XSxbMTEwLDE1XSxbMTE1LDIzXSxbMTIwLDI5XSxbMTI1LDM1XSxbMTMwLDQwXSxbMTM1LDQ1XSxbMTQwLDQ4XSxbMTQ1LDQ5XSxbMTUwLDUwXSxbMTU1LDQ5XSxbMTYwLDQ4XSxbMTY1LDQ1XSxbMTcwLDQwXSxbMTc1LDM1XSxbMTgwLDI5XSxbMTg1LDIzXSxbMTkwLDE1XSxbMTk1LDhdLFsyMDAsMF1dYAogICAgICB9W2FyZ3MuQVJDXTsKICAgIH0KCiAgICBtYWtlU3ZnR3JhZGllbnQoYXJncykgewogICAgICBjb25zdCBleHRyYWN0U3RvcHMgPSAodmFsdWUpID0+IHsKICAgICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAic3RyaW5nIikgcmV0dXJuIFtdOwogICAgICAgIGlmICh2YWx1ZS5pbmNsdWRlcygiPHN0b3AiKSkgcmV0dXJuIHZhbHVlLm1hdGNoKC88c3RvcFtcc1xTXSo/XC8+L2cpID8/IFtdOwogICAgICAgIHJldHVybiBbYDxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iJHt2YWx1ZX0iIC8+YF07CiAgICAgIH07CgogICAgICBjb25zdCB0eXBlID0gQ2FzdC50b1N0cmluZyhhcmdzLlRZUEUpICsgIkdyYWRpZW50IjsKICAgICAgY29uc3QgYW5nbGUgPSB0eXBlLnN0YXJ0c1dpdGgoInJhZGlhbCIpID8gIiIgOgogICAgICAgIGBncmFkaWVudFRyYW5zZm9ybT0icm90YXRlKCR7Q2FzdC50b051bWJlcihhcmdzLkFOR0xFKX0gMC41IDAuNSkiYDsKCiAgICAgIC8vIGluIGNhc2UgdGhlIHVzZXIgaW5wdXRzIGFub3RoZXIgZ3JhZGllbnQgYmxvY2ssIGluY3JlYXNlCiAgICAgIC8vIHRoZSBudW1iZXIgb2YgY29sb3Igc3RvcHMgaW4gdGhlIGdlbmVyYXRlZCBncmFkaWVudAogICAgICBjb25zdCBzdG9wcyA9IFsKICAgICAgICAuLi5leHRyYWN0U3RvcHMoQ2FzdC50b1N0cmluZyhhcmdzLkNPTE9SMikpLAogICAgICAgIC4uLmV4dHJhY3RTdG9wcyhDYXN0LnRvU3RyaW5nKGFyZ3MuQ09MT1IxKSkKICAgICAgXTsKCiAgICAgIGxldCBncmFkaWVudCA9IGA8JHt0eXBlfSBpZD0iZ3JhZENvbG9yIiB4MT0iMCIgeTE9IjAiIHgyPSIwIiB5Mj0iMSIgJHthbmdsZX0+YDsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdG9wcy5sZW5ndGg7IGkrKykgewogICAgICAgIGdyYWRpZW50ICs9IHN0b3BzW2ldLnJlcGxhY2UoCiAgICAgICAgICAvXHMqb2Zmc2V0XHMqPVxzKiIoLio/KSIvLAogICAgICAgICAgYCBvZmZzZXQ9IiR7KGkgLyAoc3RvcHMubGVuZ3RoIC0gMSkpICogMTAwfSUiYAogICAgICAgICkgKyAiXG4iOwogICAgICB9CiAgICAgIHJldHVybiBncmFkaWVudCArIGA8LyR7dHlwZX0+YDsKICAgIH0KCiAgICBzZXRUZXh0UG9zaXRpb24oYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB0ZXh0T2JqLnNldFBvc2l0aW9uKAogICAgICAgIENhc3QudG9OdW1iZXIoYXJncy54KSwgQ2FzdC50b051bWJlcihhcmdzLnkpCiAgICAgICk7CiAgICB9CgogICAgdGV4dFBvc2l0aW9uKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICByZXR1cm4gdGV4dE9iaiA/IHRleHRPYmoucG9zaXRpb25bYXJncy5BVFQgPT09ICJ4IiA/IDAgOiAxXSA6IDA7CiAgICB9CgogICAgc2V0RWZmZWN0KGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgewogICAgICAgIGxldCBlZmZlY3RDYWNoZSA9IHRleHRPYmouc3BlY2lhbFN0eWxlcy5nZXQoImVmZmVjdHMiKTsKICAgICAgICBpZiAoIWVmZmVjdENhY2hlKSB7CiAgICAgICAgICB0ZXh0T2JqLnNwZWNpYWxTdHlsZXMuc2V0KCJlZmZlY3RzIiwge30pOwogICAgICAgICAgZWZmZWN0Q2FjaGUgPSB0ZXh0T2JqLnNwZWNpYWxTdHlsZXMuZ2V0KCJlZmZlY3RzIik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBlZmZlY3QgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuRUZGRUNUKTsKICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKEVGRkVDVF9IQU5ETEVSUywgZWZmZWN0KSkgewogICAgICAgICAgaWYgKCFlZmZlY3RDYWNoZVtlZmZlY3RdKSB7CiAgICAgICAgICAgIGVmZmVjdENhY2hlW2VmZmVjdF0gPSB7IHJhdzogbnVsbCwgY29udjogbnVsbCB9OwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnN0IHZhbHVlID0gQ2FzdC50b051bWJlcihhcmdzLlZBTFVFKTsKICAgICAgICAgIGlmIChlZmZlY3RDYWNoZVtlZmZlY3RdLnJhdyAhPT0gdmFsdWUpIHsKICAgICAgICAgICAgZWZmZWN0Q2FjaGVbZWZmZWN0XS5yYXcgPSB2YWx1ZTsKICAgICAgICAgICAgZWZmZWN0Q2FjaGVbZWZmZWN0XS5jb252ID0gRUZGRUNUX0hBTkRMRVJTW2VmZmVjdF0odmFsdWUpOwogICAgICAgICAgICB0ZXh0T2JqLl9kaXJ0eSA9IHRydWU7CiAgICAgICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudCh0cnVlLCB0cnVlKTsKICAgICAgICAgICAgcnVudGltZS5yZXF1ZXN0UmVkcmF3KCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgYW10T2ZFZmZlY3QoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgY29uc3QgZWZmZWN0Q2FjaGUgPSB0ZXh0T2JqLnNwZWNpYWxTdHlsZXMuZ2V0KCJlZmZlY3RzIikgPz8ge307CiAgICAgICAgY29uc3QgZWZmZWN0ID0gQ2FzdC50b1N0cmluZyhhcmdzLkVGRkVDVCk7CiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChFRkZFQ1RfSEFORExFUlMsIGVmZmVjdCkpIHsKICAgICAgICAgIGlmIChlZmZlY3RDYWNoZVtlZmZlY3RdKSByZXR1cm4gZWZmZWN0Q2FjaGVbZWZmZWN0XS5yYXc7CiAgICAgICAgICBlbHNlIHJldHVybiAwOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0KCiAgICByZXNldEVmZmVjdHMoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgdGV4dE9iai5zcGVjaWFsU3R5bGVzLmRlbGV0ZSgiZWZmZWN0cyIpOwogICAgICAgIHRleHRPYmouX2VsZW1lbnRJbm5lci5yZW1vdmVBdHRyaWJ1dGUoInRyYW5zZm9ybSIpOwogICAgICAgIHRleHRPYmouX2VsZW1lbnRJbm5lci5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpOwogICAgICB9CiAgICB9CgogICAgZGVidWcoYXJncykgewogICAgICBsZXQgeHlNYXAgPSB0ZXh0RGl2LnF1ZXJ5U2VsZWN0b3IoYGltZ1tpZD0iU1AtRGVidWctTWFwIl1gKTsKICAgICAgaWYgKGFyZ3MuVE9HR0xFID09PSAib24iKSB7CiAgICAgICAgaWYgKHh5TWFwKSByZXR1cm47CiAgICAgICAgZm9yIChjb25zdCB0ZXh0T2JqIG9mIE9iamVjdC52YWx1ZXModGV4dE9iamVjdHMpKSB7CiAgICAgICAgICBjb25zdCBhbGlnbm1lbnQgPSB0ZXh0T2JqLl9lbGVtZW50SW5uZXIuZ2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIpOwogICAgICAgICAgdGV4dE9iai5vbGRGaWx0ZXIgPSB0ZXh0T2JqLl9lbGVtZW50SW5uZXIuZ2V0QXR0cmlidXRlKCJmaWx0ZXIiKTsKICAgICAgICAgIHRleHRPYmouX2VsZW1lbnRJbm5lci5zZXRBdHRyaWJ1dGUoCiAgICAgICAgICAgICJmaWx0ZXIiLAogICAgICAgICAgICBgdXJsKCNib3JkZXIke2FsaWdubWVudCA9PT0gIm1pZGRsZSIgPyAiRyIgOiBhbGlnbm1lbnQgPT09ICJlbmQiID8gIkIiIDogIlIifSlgCiAgICAgICAgICApOwogICAgICAgIH0KCiAgICAgICAgeHlNYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbWciKTsKICAgICAgICB4eU1hcC5jcm9zc09yaWdpbiA9ICJhbm9ueW1vdXMiOwogICAgICAgIHh5TWFwLnNyYyA9ICJodHRwczovL2Nkbi5hc3NldHMuc2NyYXRjaC5taXQuZWR1L2ludGVybmFsYXBpL2Fzc2V0Lzk4MzhkMDIwMDJkMDVmODhkYzU0ZDk2NDk0ZmJjMjAyLnBuZy9nZXQvIjsKICAgICAgICB4eU1hcC5pZCA9ICJTUC1EZWJ1Zy1NYXAiOwogICAgICAgIHh5TWFwLnNldEF0dHJpYnV0ZSgic3R5bGUiLCBgcG9zaXRpb246IGFic29sdXRlOyB3aWR0aDogNDgwcHg7IGhlaWdodDogMzYwcHg7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOyB6LWluZGV4OiAtMTsgb3BhY2l0eTogNTAlYCk7CiAgICAgICAgdGV4dERpdi5hcHBlbmRDaGlsZCh4eU1hcCk7CiAgICAgICAgaXNJbkRlYnVnTW9kZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHh5TWFwKSB4eU1hcC5yZW1vdmUoKTsKICAgICAgICBmb3IgKGNvbnN0IHRleHRPYmogb2YgT2JqZWN0LnZhbHVlcyh0ZXh0T2JqZWN0cykpIHsKICAgICAgICAgIHRleHRPYmouX2VsZW1lbnRJbm5lci5zZXRBdHRyaWJ1dGUoImZpbHRlciIsIHRleHRPYmoub2xkRmlsdGVyKTsKICAgICAgICAgIGRlbGV0ZSB0ZXh0T2JqLm9sZEZpbHRlcjsKICAgICAgICB9CiAgICAgICAgaXNJbkRlYnVnTW9kZSA9IGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmVzZXRUeHQoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgdGV4dE9iai5zdHlsZXMuY2xlYXIoKTsKICAgICAgICB0ZXh0T2JqLnNwZWNpYWxTdHlsZXMuY2xlYXIoKTsKICAgICAgICB0ZXh0T2JqLl9kaXJ0eSA9IHRydWU7CiAgICAgICAgdGV4dE9iai5zZXRBdHRyaWJ1dGUoImN1cnZlIiwgbnVsbCwgdHJ1ZSk7CgogICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0ZXh0T2JqLl9lbGVtZW50SW5uZXI7CiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGVsZW1lbnQuYXR0cmlidXRlczsKICAgICAgICBmb3IgKGxldCBpID0gYXR0cmlidXRlcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlc1tpXS5uYW1lKTsKICAgICAgICB9CgogICAgICAgIHRleHRPYmoudXBkYXRlRWxlbWVudCh0cnVlLCB0cnVlKTsKICAgICAgICB0ZXh0T2JqLl9lbGVtZW50LnN0eWxlLnRleHRTaGFkb3cgPSAibm9uZSI7CiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoInBhaW50LW9yZGVyIiwgInN0cm9rZSIpOwogICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJ0ZXh0LWFuY2hvciIsICJtaWRkbGUiKTsKICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgieG1sOnNwYWNlIiwgInByZXNlcnZlIik7CiAgICAgICAgZWxlbWVudC5zdHlsZS53aGl0ZVNwYWNlID0gInByZSI7CiAgICAgIH0KICAgIH0KCiAgICByZXVzZVN0eWxlKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iajEgPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgY29uc3QgdGV4dE9iajIgPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQyKV07CiAgICAgIGlmICh0ZXh0T2JqMSAmJiB0ZXh0T2JqMikgewogICAgICAgIHRleHRPYmoyLnN0eWxlcyA9IHN0cnVjdHVyZWRDbG9uZSh0ZXh0T2JqMS5zdHlsZXMpOwoKICAgICAgICAvLyBzcGVjaWFsU3R5bGVzIGhhcyBzb21lIG5vbi1jbG9uZWFibGUgc3R1ZmYKICAgICAgICBpdGVyYXRvckZvckVhY2goCiAgICAgICAgICB0ZXh0T2JqMS5zcGVjaWFsU3R5bGVzLmVudHJpZXMoKSwKICAgICAgICAgIChba2V5LCB2YWx1ZV0pID0+IHsKICAgICAgICAgICAgdGV4dE9iajIuc3BlY2lhbFN0eWxlcy5zZXQoCiAgICAgICAgICAgICAga2V5LCBrZXkgPT09ICJjdXJ2ZSIgPyB2YWx1ZS5jbG9uZU5vZGUodHJ1ZSkgOiB2YWx1ZQogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICk7CgogICAgICAgIHRleHRPYmoyLl9kaXJ0eSA9IHRydWU7CiAgICAgICAgdGV4dE9iajIudXBkYXRlRWxlbWVudCh0cnVlLCB0cnVlKTsKICAgICAgfQogICAgfQoKICAgIHRvZ2dsZVNlbGVjdChhcmdzKSB7CiAgICAgIGNvbnN0IHRleHRPYmogPSB0ZXh0T2JqZWN0c1tDYXN0LnRvU3RyaW5nKGFyZ3MuSUQpXTsKICAgICAgaWYgKHRleHRPYmopIHsKICAgICAgICBjb25zdCB0b2dnbGVyID0gYXJncy5UWVBFID09PSAib24iOwogICAgICAgIHRleHRPYmoudG9nZ2xlSW50ZXJhY3QodG9nZ2xlcik7CiAgICAgICAgdGV4dE9iai5fZWxlbWVudC5zdHlsZS51c2VyU2VsZWN0ID0gdG9nZ2xlciA/ICJ0ZXh0IiA6ICJub25lIjsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgdG9nZ2xlQ2xpY2thYmxlKGFyZ3MpIHsKICAgICAgY29uc3QgdGV4dE9iaiA9IHRleHRPYmplY3RzW0Nhc3QudG9TdHJpbmcoYXJncy5JRCldOwogICAgICBpZiAodGV4dE9iaikgdGV4dE9iai50b2dnbGVDbGlja2FibGUoYXJncy5UWVBFID09PSAib24iKTsKICAgIH0KCiAgICBpc0NsaWNrZWQoYXJncykgewogICAgICBjb25zdCB0ZXh0T2JqID0gdGV4dE9iamVjdHNbQ2FzdC50b1N0cmluZyhhcmdzLklEKV07CiAgICAgIGlmICh0ZXh0T2JqKSB7CiAgICAgICAgY29uc3QgYnVmZmVyID0gcGVyZm9ybWFuY2Uubm93KCkgLSB0ZXh0T2JqLmNsaWNrVGltZTsKICAgICAgICByZXR1cm4gYnVmZmVyIDwgcnVudGltZS5jdXJyZW50U3RlcFRpbWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHdoZW5UZXh0Q2xpY2tlZChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGNsaWNrZWRJZCA9IHV0aWwudGhyZWFkW1RIUkVBRF9LRVldOwogICAgICByZXR1cm4gY2xpY2tlZElkICYmIGNsaWNrZWRJZCA9PT0gQ2FzdC50b1N0cmluZyhhcmdzLklEKTsKICAgIH0KICB9CgogIFNjcmF0Y2guZXh0ZW5zaW9ucy5yZWdpc3RlcihuZXcgU1BkaXNwbGF5VGV4dFYyKCkpOwp9KShTY3JhdGNoKTsK","truefantommath":"https://extensions.turbowarp.org/true-fantom/math.js","HyperSense2SP":"data:text/javascript;base64,Ly8gTmFtZTogSHlwZXIgU2Vuc2UgVjIKLy8gSUQ6IEh5cGVyU2Vuc2UyU1AKLy8gRGVzY3JpcHRpb246IENvb2wgTmV3IFNlbnNpbmcgQmxvY2tzCi8vIEJ5OiBTaGFya1Bvb2wKLy8gTGljZW5zZTogTUlUCgovLyBWZXJzaW9uIDIuMC4wMQoKKGZ1bmN0aW9uIChTY3JhdGNoKSB7CiAgInVzZSBzdHJpY3QiOwogIGlmICghU2NyYXRjaC5leHRlbnNpb25zLnVuc2FuZGJveGVkKSB0aHJvdyBuZXcgRXJyb3IoIkh5cGVyIFNlbnNlIG11c3QgcnVuIHVuc2FuZGJveGVkIik7CgogIGNvbnN0IG1lbnVJY29uVVJJID0KImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjRiV3h1Y3owaWFIUjBjRG92TDNkM2R5NTNNeTV2Y21jdk1qQXdNQzl6ZG1jaUlIZHBaSFJvUFNJeE5EVXVNamt6SWlCb1pXbG5hSFE5SWpFME5TNHlPVE1pSUhacFpYZENiM2c5SWpBZ01DQXhORFV1TWpreklERTBOUzR5T1RNaVBqeG5JSE4wY205clpTMXRhWFJsY214cGJXbDBQU0l4TUNJK1BIQmhkR2dnWkQwaVRUQWdOekl1TmpRM1F6QWdNekl1TlRJMUlETXlMalV5TlNBd0lEY3lMalkwTnlBd2N6Y3lMalkwTnlBek1pNDFNalVnTnpJdU5qUTNJRGN5TGpZME55MHpNaTQxTWpVZ056SXVOalEzTFRjeUxqWTBOeUEzTWk0Mk5EZFRNQ0F4TVRJdU56WTVJREFnTnpJdU5qUTNJaUJtYVd4c1BTSWpOREkzWmprNUlpOCtQSEJoZEdnZ1pEMGlUVGd1TURreElEY3lMalkwTjJNd0xUTTFMalkxTXlBeU9DNDVNRE10TmpRdU5UVTJJRFkwTGpVMU5pMDJOQzQxTlRaek5qUXVOVFUySURJNExqa3dNeUEyTkM0MU5UWWdOalF1TlRVMkxUSTRMamt3TXlBMk5DNDFOVFl0TmpRdU5UVTJJRFkwTGpVMU5sTTRMakE1TVNBeE1EZ3VNeUE0TGpBNU1TQTNNaTQyTkRjaUlHWnBiR3c5SWlNMVkySXhaRFlpTHo0OGNHRjBhQ0JrUFNKTk1UQTJMakl4TlNBeE1EZ3VPRGcwWVRJdU5qY2dNaTQyTnlBd0lEQWdNUzB4TGpnNE5pMHVOemhNTXpjdU56VWdOREV1TlRJeVlUSXVOamNnTWk0Mk55QXdJREFnTVNBd0xUTXVOemN5SURJdU5qY2dNaTQyTnlBd0lEQWdNU0F6TGpjM01pQXdiRFkyTGpVNElEWTJMalU0WVRJdU5qWTVJREl1TmpZNUlEQWdNQ0F4TFRFdU9EZzNJRFF1TlRVMElpQm1hV3hzUFNJalptWm1JaTgrUEhCaGRHZ2daRDBpVFRZMUxqYzFOQ0ExTVM0d09ETmpNQ0E0TGpFd015MDJMalUyT0NBeE5DNDJOekV0TVRRdU5qY3hJREUwTGpZM01YTXRNVFF1TmpjeExUWXVOVFk0TFRFMExqWTNNUzB4TkM0Mk4yTXdMVGd1TVRBMElEWXVOVFk0TFRFMExqWTNNaUF4TkM0Mk55MHhOQzQyTnpJZ09DNHhNRFFnTUNBeE5DNDJOeklnTmk0MU5qZ2dNVFF1TmpjeUlERTBMalkzTVNJZ1ptbHNiRDBpSTJabVppSXZQanh3WVhSb0lHUTlJazAyTXk0M01pQTRNUzR6TnpGakxUY3VPRGcxTFRFdU9EWXlMVEV5TGpjMk9TMDVMamMyTkMweE1DNDVNRFl0TVRjdU5qVnpPUzQzTmpRdE1USXVOelk1SURFM0xqWTFMVEV3TGprd055QXhNaTQzTmprZ09TNDNOalVnTVRBdU9UQTNJREUzTGpZMVl5MHhMamcyTWlBM0xqZzROaTA1TGpjMk5TQXhNaTQzTnkweE55NDJOU0F4TUM0NU1EY2lJR1pwYkd3OUlpTm1abVlpTHo0OGNHRjBhQ0JrUFNKTk9UY3VOelkzSURnekxqQTVOR013SURndU1UQXlMVFl1TlRjZ01UUXVOamN6TFRFMExqWTNNeUF4TkM0Mk56TnpMVEUwTGpZM01pMDJMalUzTFRFMExqWTNNaTB4TkM0Mk56TWdOaTQxTmprdE1UUXVOamN4SURFMExqWTNNaTB4TkM0Mk56RmpPQzR4TURJZ01DQXhOQzQyTnpNZ05pNDFOeUF4TkM0Mk56TWdNVFF1TmpjaUlHWnBiR3c5SWlObVptWWlMejQ4Y0dGMGFDQmtQU0pOTVRBMkxqSXhOU0F4TURndU9EZzBZVEl1TmpjZ01pNDJOeUF3SURBZ01TMHhMamc0TmkwdU56aHNMVEUyTGpNMExURTJMak0wWVRJdU5qWTFJREl1TmpZMUlEQWdNQ0F4SURBdE15NDNOek1nTWk0Mk55QXlMalkzSURBZ01DQXhJRE11TnpjeUlEQnNNVFl1TXpRZ01UWXVNelJoTWk0Mk55QXlMalkzSURBZ01DQXhJREFnTXk0M056TWdNaTQyT0NBeUxqWTRJREFnTUNBeExURXVPRGcyTGpjNElpQm1hV3hzUFNJalptWm1JaTgrUEhCaGRHZ2daRDBpVFRFMUxqTXhOU0EzTWk0Mk5EY2dNamd1TVRJeUlEVTVMamcwZGpJMUxqWXhOSHB0TnpBdU1UTTVMVFEwTGpVeU5VZzFPUzQ0Tkd3eE1pNDRNRGN0TVRJdU9EQTNlbTAwTkM0MU1qVWdORFF1TlRJMUxURXlMamd3TnlBeE1pNDRNRGRXTlRrdU9EUjZUVFU1TGpnMElERXhOeTR4TnpKb01qVXVOakUwYkMweE1pNDRNRGNnTVRJdU9EQTNlaUlnWm1sc2JEMGlJMlptWmlJZ2MzUnliMnRsUFNJalptWm1JaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqRXVOU0l2UGp3dlp6NDhMM04yWno0PSI7CgogIGNvbnN0IENhc3QgPSBTY3JhdGNoLkNhc3Q7CiAgY29uc3Qgdm0gPSBTY3JhdGNoLnZtOwogIGNvbnN0IHJ1bnRpbWUgPSB2bS5ydW50aW1lOwogIGNvbnN0IHJlbmRlciA9IHZtLnJlbmRlcmVyOwogIGNvbnN0IHNlbnNpbmdDb3JlID0gcnVudGltZS5leHRfc2NyYXRjaDNfc2Vuc2luZzsKICBjb25zdCBpc1BhY2thZ2VkID0gdHlwZW9mIHNjYWZmb2xkaW5nICE9PSAidW5kZWZpbmVkIjsKCiAgY29uc3QgdHJhbnNsYXRlZEtleXMgPSBbCiAgICAiYW55IiwgImEiLCAiYiIsICJjIiwgImQiLCAiZSIsICJmIiwgImciLCAiaCIsICJpIiwgImoiLAogICAgImsiLCAibCIsICJtIiwgIm4iLCAibyIsICJwIiwgInEiLCAiciIsICJzIiwgInQiLCAidSIsCiAgICAidiIsICJ3IiwgIngiLCAieSIsICJ6IiwKICAgICIwIiwgIjEiLCAiMiIsICIzIiwgIjQiLCAiNSIsICI2IiwgIjciLCAiOCIsICI5IiwKICAgICJ1cCBhcnJvdyIsICJkb3duIGFycm93IiwgImxlZnQgYXJyb3ciLCAicmlnaHQgYXJyb3ciLAogICAgInNwYWNlIiwgImVudGVyIiwgInNoaWZ0IiwgImNvbnRyb2wiLCAiYWx0IiwgIm1ldGEiLCAiZXNjYXBlIiwKICAgICJiYWNrc3BhY2UiLCAidGFiIiwgImNhcHMgbG9jayIsICJpbnNlcnQiLCAiZGVsZXRlIiwgInBhZ2UgdXAiLCAicGFnZSBkb3duIiwKICAgICJgIiwgIn4iLCAiISIsICI/IiwgIkAiLCAiIyIsICIkIiwgIiUiLCAiXiIsICImIiwgIioiLCAiLSIsICJfIiwgIisiLCAiPSIsCiAgICAiKCIsICIpIiwgIlsiLCAiXSIsICJ7IiwgIn0iLCAiXFwiLCAifCIsICIvIiwgIjwiLCAiPiIsICIsIiwgIi4iLAogICAgImYxIiwgImYyIiwgImYzIiwgImY0IiwgImY1IiwgImY2IiwgImY3IiwgImY4IiwgImY5IiwgImYxMCIsICJmMTEiLCAiZjEyIiAKICBdLm1hcCgoa2V5KSA9PiB7CiAgICBpZiAoL15bYS16MC05IF0rJC9pLnRlc3Qoa2V5KSkgcmV0dXJuIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoa2V5KSwgdmFsdWU6IGtleSB9OwogICAgZWxzZSByZXR1cm4geyB0ZXh0OiBrZXksIHZhbHVlOiBrZXkgfTsKICB9KTsKCiAgY29uc3Qga2V5RGF0YSA9IHsKICAgIGN1cktleTogIiIsCiAgICBsYXN0S2V5OiAiIiwKICAgIGtleXM6IFtdLAogICAga2V5VGltZXJzOiBuZXcgTWFwKCksCiAgICBrZXlCbG9ja2VyczogbmV3IFNldCgpCiAgfTsKCiAgY29uc3QgbW91c2VEYXRhID0gewogICAgY2xpZW50OiBbMCwgMF0sCiAgICB2ZWxvY2l0eTogWzAsIDBdLAogICAgc2Nyb2xsOiBbMCwgMF0sCiAgICBzY3JvbGxWZWxvY2l0eTogWzAsIDBdCiAgfTsKCiAgLyogdW5kZWZpbmVkIGlzIGRlZmF1bHQgdmFsdWVzICovCiAgY29uc3QgYXNrQm94U2V0dGluZ3MgPSB7CiAgICB4OiB1bmRlZmluZWQsIHk6IHVuZGVmaW5lZCwKICAgIHdpZHRoOiB1bmRlZmluZWQsCiAgICBpbnB1dDogewogICAgICB0eXBlOiB1bmRlZmluZWQsCiAgICAgIHZhbHVlOiB1bmRlZmluZWQKICAgIH0sCiAgfTsKCiAgY29uc3QgdmFsaWRJbnB1dHMgPSBbCiAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ0ZXh0IiksIHZhbHVlOiAidGV4dCIgfSwKICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInBhc3N3b3JkIiksIHZhbHVlOiAicGFzc3dvcmQiIH0sCiAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJudW1iZXIiKSwgdmFsdWU6ICJudW1iZXIiIH0sCiAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJjb2xvciIpLCB2YWx1ZTogImNvbG9yIiB9CiAgXTsKCiAgbGV0IGxvdWRuZXNzQ2FjaGUgPSBbXTsKCiAgY2xhc3MgSHlwZXJTZW5zZTJTUCB7CiAgICBjb25zdHJ1Y3RvcigpIHsKICAgICAgcnVudGltZS5vbigiQkVGT1JFX0VYRUNVVEUiLCAoKSA9PiB7CiAgICAgICAgLy8ga2V5IG9wZXJhdGlvbnMKICAgICAgICBjb25zdCBrZXlUaW1lcnMgPSBrZXlEYXRhLmtleVRpbWVyczsKICAgICAgICBrZXlUaW1lcnMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4gewogICAgICAgICAga2V5VGltZXJzLnNldChrZXksIHZhbHVlICsgMC4xKTsKICAgICAgICB9KTsKICAgICAgICBydW50aW1lLnN0YXJ0SGF0cygiSHlwZXJTZW5zZTJTUF93aGVuS2V5Iik7CgogICAgICAgIC8vIHZlbG9jaXR5IGFwcGxpY2F0aW9uCiAgICAgICAgY29uc3QgeyB2ZWxvY2l0eSwgc2Nyb2xsVmVsb2NpdHkgfSA9IG1vdXNlRGF0YTsKICAgICAgICBtb3VzZURhdGEudmVsb2NpdHlbMF0gKz0gKDAgLSB2ZWxvY2l0eVswXSkgLyAzOwogICAgICAgIG1vdXNlRGF0YS52ZWxvY2l0eVsxXSArPSAoMCAtIHZlbG9jaXR5WzFdKSAvIDM7CgogICAgICAgIG1vdXNlRGF0YS5zY3JvbGxWZWxvY2l0eVswXSArPSAoMCAtIHNjcm9sbFZlbG9jaXR5WzBdKSAvIDQ7CiAgICAgICAgbW91c2VEYXRhLnNjcm9sbFZlbG9jaXR5WzFdICs9ICgwIC0gc2Nyb2xsVmVsb2NpdHlbMV0pIC8gNDsKICAgICAgfSk7CgogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigia2V5ZG93biIsIChlKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy50b1Byb3BlcktleShlLCBmYWxzZSk7CiAgICAgICAga2V5RGF0YS5jdXJLZXkgPSBrZXk7CiAgICAgICAga2V5RGF0YS5sYXN0S2V5ID0ga2V5OwogICAgICAgIGlmICgha2V5RGF0YS5rZXlUaW1lcnMuaGFzKGtleSkpIHsKICAgICAgICAgIGtleURhdGEua2V5cy5wdXNoKGtleSk7CiAgICAgICAgICBrZXlEYXRhLmtleVRpbWVycy5zZXQoa2V5LCAwKTsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHRoaXMgaXMgYSBibG9ja2VkIGtleSwgcHJldmVudCBkZWZhdWx0CiAgICAgICAgaWYgKGtleURhdGEua2V5QmxvY2tlcnMuaGFzKCJhbnkiKSB8fCBrZXlEYXRhLmtleUJsb2NrZXJzLmhhcyhrZXkpKSB7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImtleXVwIiwgKGUpID0+IHsKICAgICAgICBjb25zdCBrZXkgPSB0aGlzLnRvUHJvcGVyS2V5KGUsIGZhbHNlKTsKICAgICAgICBjb25zdCBpbmRleCA9IGtleURhdGEua2V5cy5pbmRleE9mKGtleSk7CgogICAgICAgIGtleURhdGEua2V5VGltZXJzLmRlbGV0ZShrZXkpOwogICAgICAgIGtleURhdGEua2V5cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICAgIGtleURhdGEuY3VyS2V5ID0ga2V5RGF0YS5rZXlzWzBdIHx8ICIiOwogICAgICB9KTsKCiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIndoZWVsIiwgKGUpID0+IHsKICAgICAgICBjb25zdCBvbGRTY3JvbGwgPSBtb3VzZURhdGEuc2Nyb2xsOwogICAgICAgIG1vdXNlRGF0YS5zY3JvbGwgPSBbb2xkU2Nyb2xsWzBdICsgZS5kZWx0YVgsIG9sZFNjcm9sbFsxXSArIGUuZGVsdGFZXTsKICAgICAgICBtb3VzZURhdGEuc2Nyb2xsVmVsb2NpdHkgPSBbZS5kZWx0YVgsIGUuZGVsdGFZXTsKCiAgICAgICAgaWYgKGUuZGVsdGFYID4gMSkgcnVudGltZS5zdGFydEhhdHMoIkh5cGVyU2Vuc2UyU1Bfd2hlblNjcm9sbGVkIiwgeyBESVI6ICJyaWdodCIgfSk7CiAgICAgICAgZWxzZSBpZiAoZS5kZWx0YVggPCAtMSkgcnVudGltZS5zdGFydEhhdHMoIkh5cGVyU2Vuc2UyU1Bfd2hlblNjcm9sbGVkIiwgeyBESVI6ICJsZWZ0IiB9KTsKCiAgICAgICAgaWYgKGUuZGVsdGFZID4gMSkgcnVudGltZS5zdGFydEhhdHMoIkh5cGVyU2Vuc2UyU1Bfd2hlblNjcm9sbGVkIiwgeyBESVI6ICJ1cCIgfSk7CiAgICAgICAgZWxzZSBpZiAoZS5kZWx0YVkgPCAtMSkgcnVudGltZS5zdGFydEhhdHMoIkh5cGVyU2Vuc2UyU1Bfd2hlblNjcm9sbGVkIiwgeyBESVI6ICJkb3duIiB9KTsKICAgICAgfSk7CiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIm1vdXNlbW92ZSIsIChlKSA9PiB7CiAgICAgICAgbW91c2VEYXRhLmNsaWVudCA9IFtlLmNsaWVudFgsIGUuY2xpZW50WV07CiAgICAgICAgbW91c2VEYXRhLnZlbG9jaXR5ID0gWwogICAgICAgICAgcnVudGltZS5pb0RldmljZXMubW91c2UuZ2V0U2NyYXRjaFgoKSwKICAgICAgICAgIHJ1bnRpbWUuaW9EZXZpY2VzLm1vdXNlLmdldFNjcmF0Y2hZKCkKICAgICAgICBdOwogICAgICB9KTsKICAgIH0KICAgIGdldEluZm8oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgaWQ6ICJIeXBlclNlbnNlMlNQIiwKICAgICAgICBuYW1lOiBTY3JhdGNoLnRyYW5zbGF0ZSgiSHlwZXIgU2Vuc2UgVjIiKSwKICAgICAgICBjb2xvcjE6ICIjNWNiMWQ2IiwKICAgICAgICBjb2xvcjI6ICIjNDdhOGQxIiwKICAgICAgICBjb2xvcjM6ICIjMmU4ZWI4IiwKICAgICAgICBtZW51SWNvblVSSSwKICAgICAgICBibG9ja3M6IFsKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIlNjcm9sbCBEZWN0ZWN0aW9uIikgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2Nyb2xsVmFsdWUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2Nyb2xsIFtUWVBFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUWVBFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlNDUk9MTF9UWVBFUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0U2Nyb2xsRGlzdCIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBzY3JvbGwgZGlzdGFuY2UgW1BPU10gdG8gW0FNVF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgUE9TOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlBPU0lUSU9OIiB9LAogICAgICAgICAgICAgIEFNVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMCB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJjaGFuZ2VTY3JvbGxEaXN0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiY2hhbmdlIHNjcm9sbCBkaXN0YW5jZSBbUE9TXSBieSBbQU1UXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBQT1M6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiUE9TSVRJT04iIH0sCiAgICAgICAgICAgICAgQU1UOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAxMDAgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAid2hlblNjcm9sbGVkIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5FVkVOVCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndoZW4gc2Nyb2xsZWQgW0RJUl0iKSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgRElSOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlNDUk9MTF9FVkVOVFMiIH0KICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImlzU2Nyb2xsZWQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJpcyBzY3JvbGxpbmcgW1RZUEVdID8iKSwKICAgICAgICAgICAgZGlzYWJsZU1vbml0b3I6IHRydWUsCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFRZUEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiU0NST0xMX0VWRU5UUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIk1vdXNlIERldGVjdGlvbiIpIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogIm1vdXNlQ2xpY2siLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJpcyBtb3VzZSBbQlVUVE9OXSBkb3duPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBCVVRUT046IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiTU9VU0VfQlVUVE9OUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZWFsTW91c2UiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmVhbCBtb3VzZSBbUE9TXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBQT1M6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiUE9TSVRJT04iIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAibW91c2VWZWxvY2l0eSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJtb3VzZSB2ZWxvY2l0eSBbUE9TXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBQT1M6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiUE9TSVRJT04iIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIktleSBEZXRlY3Rpb24iKSB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJ3aGVuS2V5IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5IQVQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3aGVuIFtLRVldIGtleSBbVFlQRV0iKSwKICAgICAgICAgICAgaXNFZGdlQWN0aXZhdGVkOiBmYWxzZSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgS0VZOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIktFWVMiIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJLRVlfUFJFU1MiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiaXNLZXkiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJrZXkgW0tFWV0gW1RZUEVdID8iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgS0VZOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIktFWVMiIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJLRVlfUFJFU1MiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJjdXJyZW50S2V5IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIltUWVBFXSBwcmVzc2VkIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFRZUEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiS0VZX0xJU1RTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInRpbWVLZXlQcmVzc2VkIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNlY29uZHMgW0tFWV0ga2V5IHByZXNzZWQiKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgS0VZOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIktFWVMiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRLZXlCbG9jayIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImJsb2NrIGRlZmF1bHQgYmVoYXZpb3VyIG9mIGtleSBbS0VZXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBLRVk6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiS0VZUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJyZXNldEtleUJsb2NrcyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInJlc2V0IGJsb2NrZWQga2V5IGJlaGF2aW91cnMiKQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiZ2V0S2V5QmxvY2tlcnMiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiYmxvY2tlZCBrZXlzIikKICAgICAgICAgIH0sCiAgICAgICAgICB7IGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuTEFCRUwsIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJUb3VjaGluZyBFeHBhbmRlZCIpIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNwcml0ZVBvaW50aW5nIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiaXMgW1NQUklURTFdIHBvaW50aW5nIHRvd2FyZHMgW1NQUklURTJdPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBTUFJJVEUxOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9UQVJHRVRTIiB9LAogICAgICAgICAgICAgIFNQUklURTI6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiT0JKRUNUUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzcHJpdGVUb3VjaGluZ1Nwcml0ZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQk9PTEVBTiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImlzIFtTUFJJVEUxXSB0b3VjaGluZyBbU1BSSVRFMl0/IiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFNQUklURTE6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiT0JKRUNUUyIgfSwKICAgICAgICAgICAgICBTUFJJVEUyOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9UQVJHRVRTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNwcml0ZVRvdWNoaW5nU3ByaXRlVHlwZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQk9PTEVBTiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImlzIFtTUFJJVEUxXSB0b3VjaGluZyBbVFlQRV0gb2YgW1NQUklURTJdPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBTUFJJVEUxOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9PQkpFQ1RTIiB9LAogICAgICAgICAgICAgIFRZUEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUX1RZUEUiIH0sCiAgICAgICAgICAgICAgU1BSSVRFMjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJUQVJHRVRTIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNwcml0ZVRvdWNoaW5nQ2xvbmUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJpcyBbU1BSSVRFMV0gdG91Y2hpbmcgY2xvbmUgb2YgW1NQUklURTJdIHdpdGggW1ZBUl0gc2V0IHRvIFtWQUxdPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBTUFJJVEUxOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9PQkpFQ1RTIiB9LAogICAgICAgICAgICAgIFNQUklURTI6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiVEFSR0VUUyIgfSwKICAgICAgICAgICAgICBWQVI6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBkZWZhdWx0VmFsdWU6IFNjcmF0Y2gudHJhbnNsYXRlKCJteSB2YXJpYWJsZSIpIH0sCiAgICAgICAgICAgICAgVkFMOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiAwIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzcHJpdGVzVG91Y2hpbmciLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic3ByaXRlcyB0b3VjaGluZyBbU1BSSVRFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBTUFJJVEU6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiQUxMX09CSkVDVFMiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiZ2V0TmVpZ2hib3JzIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIm5laWdoYm9ycyBvZiBbU1BSSVRFXSBpbiByYW5nZSBbRElBTUVURVJdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFNQUklURTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJBTExfT0JKRUNUUyIgfSwKICAgICAgICAgICAgICBESUFNRVRFUjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMjAwIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgICItLS0iLAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJvYmpUb3VjaGluZ0NvbG9yIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImNvbG9yIHRvdWNoaW5nIFtTUFJJVEVdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFNQUklURTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJBTExfT0JKRUNUUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJjb2xvckF0UG9zaXRpb24iLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiY29sb3IgYXQgeCBbeF0geSBbeV0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgeDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMCB9LAogICAgICAgICAgICAgIHk6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuTlVNQkVSLCBkZWZhdWx0VmFsdWU6IDAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgIi0tLSIsCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNwcml0ZURyYWdNb2RlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IGRyYWcgbW9kZSBvZiBbU1BSSVRFXSB0byBbRFJBR10iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgU1BSSVRFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9UQVJHRVRTIiB9LAogICAgICAgICAgICAgIERSQUc6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiRFJBR19NT0RFUyIgfQogICAgICAgICAgICB9LAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic3ByaXRlRHJhZ2dhYmxlIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiaXMgW1NQUklURV0gW0RSQUddID8iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgU1BSSVRFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFMTF9UQVJHRVRTIiB9LAogICAgICAgICAgICAgIERSQUc6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBtZW51OiAiRFJBR19UWVBFIiB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9LAogICAgICAgICAgeyBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkxBQkVMLCB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiQXNraW5nIikgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYWR2YW5jZWRBc2siLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJhc2sgW1FVRVNUSU9OXSBhcyBbVFlQRV0gYW5kIFtXQUlUXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBRVUVTVElPTjogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogU2NyYXRjaC50cmFuc2xhdGUoIndoYXQgaXMgeW91ciBuYW1lPyIpIH0sCiAgICAgICAgICAgICAgVFlQRTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIG1lbnU6ICJBU0tfVFlQRSIgfSwKICAgICAgICAgICAgICBXQUlUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIldBSVRfVFlQRVMiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAiYXNrUmVwb3J0ZXIiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiYXNrIFtRVUVTVElPTl0gYXMgW1RZUEVdIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFFVRVNUSU9OOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgZGVmYXVsdFZhbHVlOiBTY3JhdGNoLnRyYW5zbGF0ZSgid2hhdCBpcyB5b3VyIG5hbWU/IikgfSwKICAgICAgICAgICAgICBUWVBFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFTS19UWVBFIiB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInN0b3BBc2tpbmciLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzdG9wIGFza2luZyBxdWVzdGlvbiIpCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJjdXJyZW50VHlwZWQiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgidHlwZWQgYW5zd2VyIikKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImlzQXNraW5nIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5CT09MRUFOLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiaXMgYXNraW5nIHF1ZXN0aW9uPyIpCiAgICAgICAgICB9LAogICAgICAgICAgIi0tLSIsCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogInNldEFza0Rpc3BsYXkiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkNPTU1BTkQsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzZXQgYXNrIG1vbml0b3IgeDogW3hdIHk6IFt5XSB3aWR0aDogW3dpZHRoXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICB4OiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLk5VTUJFUiwgZGVmYXVsdFZhbHVlOiAwIH0sCiAgICAgICAgICAgICAgeTogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogMCwgZXhlbXB0RnJvbU5vcm1hbGl6YXRpb246IHRydWUgfSwKICAgICAgICAgICAgICB3aWR0aDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5OVU1CRVIsIGRlZmF1bHRWYWx1ZTogNDgwIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2V0QXNrVHlwZSIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQ09NTUFORCwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNldCBhc2sgYm94IGlucHV0IHRvIFtUWVBFXSBkZWZhdWx0IHZhbHVlIFtURVhUXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUWVBFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIkFTS19JTlBVVFMiIH0sCiAgICAgICAgICAgICAgVEVYVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogIi4uLiIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJzZXRBc2tMaXN0IiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5DT01NQU5ELAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgic2V0IGFzayBib3ggaW5wdXQgdG8gZHJvcGRvd24gd2l0aCBpdGVtcyBpbiBhcnJheSBbTElTVF0iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgTElTVDogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogIltcIm9wdGlvbiAxXCIsIFwib3B0aW9uIDJcIl0iIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5MQUJFTCwgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIk1pc2NlbGxhbmVvdXMiKSB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJpc1NjcmVlbiIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuQk9PTEVBTiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImlzIFtTQ1JFRU5dID8iKSwKICAgICAgICAgICAgYXJndW1lbnRzOiB7CiAgICAgICAgICAgICAgU0NSRUVOOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlNDUkVFTlMiIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgb3Bjb2RlOiAic2NyZWVuT2ZmIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInN0YWdlIFtUWVBFXSIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBUWVBFOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogIlNUQUdFX1NDQUxFUyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgIi0tLSIsCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImF2ZXJhZ2VNaWNWb2x1bWUiLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLlJFUE9SVEVSLAogICAgICAgICAgICB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiYXZlcmFnZSBsb3VkbmVzcyIpCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBvcGNvZGU6ICJnZXRTcHJpdGVOYW1lIiwKICAgICAgICAgICAgYmxvY2tUeXBlOiBTY3JhdGNoLkJsb2NrVHlwZS5SRVBPUlRFUiwKICAgICAgICAgICAgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIm15IHNwcml0ZSBuYW1lIikKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImFsbExheWVycyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJtYXggc3ByaXRlIGxheWVycyIpCiAgICAgICAgICB9LAogICAgICAgICAgIi0tLSIsCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImJvb2xlYW4iLAogICAgICAgICAgICBibG9ja1R5cGU6IFNjcmF0Y2guQmxvY2tUeXBlLkJPT0xFQU4sCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJpcyBbU1RSSU5HXSByZWFsPyIpLAogICAgICAgICAgICBhcmd1bWVudHM6IHsKICAgICAgICAgICAgICBTVFJJTkc6IHsgdHlwZTogU2NyYXRjaC5Bcmd1bWVudFR5cGUuU1RSSU5HLCBleGVtcHRGcm9tTm9ybWFsaXphdGlvbjogdHJ1ZSB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIG9wY29kZTogImdldEFsbFN0cmluZyIsCiAgICAgICAgICAgIGJsb2NrVHlwZTogU2NyYXRjaC5CbG9ja1R5cGUuUkVQT1JURVIsCiAgICAgICAgICAgIHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJnZXQgW1RFWFRdIGluIFtTVFJJTkddIiksCiAgICAgICAgICAgIGFyZ3VtZW50czogewogICAgICAgICAgICAgIFNUUklORzogeyB0eXBlOiBTY3JhdGNoLkFyZ3VtZW50VHlwZS5TVFJJTkcsIGRlZmF1bHRWYWx1ZTogU2NyYXRjaC50cmFuc2xhdGUoInJvdGF0aW5nIGEgNiBtYWtlcyBhIDkhIikgfSwKICAgICAgICAgICAgICBURVhUOiB7IHR5cGU6IFNjcmF0Y2guQXJndW1lbnRUeXBlLlNUUklORywgbWVudTogInN0cmluZ190eXBlcyIgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgICAgbWVudXM6IHsKICAgICAgICAgIE9CSkVDVFM6IHsgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLCBpdGVtczogdGhpcy5fZ2V0T2JqZWN0cyh0cnVlLCBmYWxzZSkgfSwKICAgICAgICAgIEFMTF9PQkpFQ1RTOiB7IGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwgaXRlbXM6IHRoaXMuX2dldE9iamVjdHModHJ1ZSwgdHJ1ZSkgfSwKICAgICAgICAgIFRBUkdFVFM6IHsgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLCBpdGVtczogdGhpcy5fZ2V0T2JqZWN0cyhmYWxzZSwgZmFsc2UpIH0sCiAgICAgICAgICBBTExfVEFSR0VUUzogeyBhY2NlcHRSZXBvcnRlcnM6IHRydWUsIGl0ZW1zOiB0aGlzLl9nZXRPYmplY3RzKGZhbHNlLCB0cnVlKSB9LAogICAgICAgICAgUE9TSVRJT046IFsieCIsICJ5Il0sCiAgICAgICAgICBXQUlUX1RZUEVTOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIndhaXQiKSwgdmFsdWU6ICJ3YWl0IiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJjb250aW51ZSIpLCB2YWx1ZTogImNvbnRpbnVlIiB9CiAgICAgICAgICBdLAogICAgICAgICAgU0NST0xMX1RZUEVTOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImRpc3RhbmNlIHgiKSwgdmFsdWU6ICJkaXN0YW5jZVgiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImRpc3RhbmNlIHkiKSwgdmFsdWU6ICJkaXN0YW5jZVkiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInZlbG9jaXR5IHgiKSwgdmFsdWU6ICJ2ZWxvY2l0eVgiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInZlbG9jaXR5IHkiKSwgdmFsdWU6ICJ2ZWxvY2l0eVkiIH0KICAgICAgICAgIF0sCiAgICAgICAgICBTQ1JPTExfRVZFTlRTOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInVwIiksIHZhbHVlOiAidXAiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImRvd24iKSwgdmFsdWU6ICJkb3duIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJsZWZ0IiksIHZhbHVlOiAibGVmdCIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmlnaHQiKSwgdmFsdWU6ICJyaWdodCIgfQogICAgICAgICAgXSwKICAgICAgICAgIE1PVVNFX0JVVFRPTlM6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogWwogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImxlZnQiKSwgdmFsdWU6ICIwIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNjcm9sbCB3aGVlbCIpLCB2YWx1ZTogIjEiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicmlnaHQiKSwgdmFsdWU6ICIyIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImJhY2siKSwgdmFsdWU6ICIzIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImZvd2FyZCIpLCB2YWx1ZTogIjQiIH0KICAgICAgICAgICAgXSwKICAgICAgICAgIH0sCiAgICAgICAgICBLRVlfUFJFU1M6IFsKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicHJlc3NlZCIpLCB2YWx1ZTogInByZXNzZWQiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImhpdCIpLCB2YWx1ZTogImhpdCIgfQogICAgICAgICAgXSwKICAgICAgICAgIEtFWV9MSVNUUzogWwogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJjdXJyZW50IGtleSIpLCB2YWx1ZTogInByZXNzIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJrZXlzIiksIHZhbHVlOiAicHJlc3NlZCIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibGFzdCBrZXkiKSwgdmFsdWU6ICJsYXN0UHJlc3MiIH0KICAgICAgICAgIF0sCiAgICAgICAgICBLRVlTOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgaXRlbXM6IHRyYW5zbGF0ZWRLZXlzCiAgICAgICAgICB9LAogICAgICAgICAgVEFSR0VUX1RZUEU6IFsKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgicGFyZW50IiksIHZhbHVlOiAicGFyZW50IiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJjbG9uZSIpLCB2YWx1ZTogImNsb25lIiB9CiAgICAgICAgICBdLAogICAgICAgICAgRFJBR19UWVBFOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImRyYWdnYWJsZSIpLCB2YWx1ZTogImRyYWdnYWJsZSIgfSwKICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgiYmVpbmcgZHJhZ2dlZCIpLCB2YWx1ZTogImJlaW5nIGRyYWdnZWQiIH0KICAgICAgICAgIF0sCiAgICAgICAgICBEUkFHX01PREVTOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJkcmFnZ2FibGUiKSwgdmFsdWU6ICJkcmFnZ2FibGUiIH0sCiAgICAgICAgICAgICAgeyB0ZXh0OiBTY3JhdGNoLnRyYW5zbGF0ZSgibm90IGRyYWdnYWJsZSIpLCB2YWx1ZTogIm5vdCBkcmFnZ2FibGUiIH0KICAgICAgICAgICAgXQogICAgICAgICAgfSwKICAgICAgICAgIEFTS19UWVBFOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInN0YWdlIiksIHZhbHVlOiAic3RhZ2UiIH0sCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNwcml0ZSIpLCB2YWx1ZTogInNwcml0ZSIgfQogICAgICAgICAgXSwKICAgICAgICAgIEFTS19JTlBVVFM6IHsKICAgICAgICAgICAgYWNjZXB0UmVwb3J0ZXJzOiB0cnVlLAogICAgICAgICAgICBpdGVtczogdmFsaWRJbnB1dHMKICAgICAgICAgIH0sCiAgICAgICAgICBTQ1JFRU5TOiBbCiAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImZ1bGxzY3JlZW4iKSwgdmFsdWU6ICJmdWxsc2NyZWVuIiB9LAogICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzbWFsbHNjcmVlbiIpLCB2YWx1ZTogInNtYWxsc2NyZWVuIiB9CiAgICAgICAgICBdLAogICAgICAgICAgU1RBR0VfU0NBTEVTOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJ3aWR0aCIpLCB2YWx1ZTogIndpZHRoIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImRpc3BsYXkgd2lkdGgiKSwgdmFsdWU6ICJkaXNwbGF5IHdpZHRoIiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoImhlaWdodCIpLCB2YWx1ZTogImhlaWdodCIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJkaXNwbGF5IGhlaWdodCIpLCB2YWx1ZTogImRpc3BsYXkgaGVpZ2h0IiB9LAogICAgICAgICAgICAgIHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoInNpemUgcmF0aW8iKSwgdmFsdWU6ICJyYXRpbyIgfQogICAgICAgICAgICBdCiAgICAgICAgICB9LAogICAgICAgICAgc3RyaW5nX3R5cGVzOiB7CiAgICAgICAgICAgIGFjY2VwdFJlcG9ydGVyczogdHJ1ZSwKICAgICAgICAgICAgaXRlbXM6IFsKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJudW1iZXJzIiksIHZhbHVlOiAibnVtYmVycyIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJsZXR0ZXJzIiksIHZhbHVlOiAibGV0dGVycyIgfSwKICAgICAgICAgICAgICB7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJzcGVjaWFsIGNoYXJhY3RlcnMiKSwgdmFsdWU6ICJzcGVjaWFsIiB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9CgogICAgLy8gSGVscGVyIEZ1bmNzCiAgICBfZ2V0T2JqZWN0cyhtb3VzZSwgbXlzZWxmKSB7CiAgICAgIGNvbnN0IHNwcml0ZU5hbWVzID0gW107CiAgICAgIGlmIChtb3VzZSkgeyBzcHJpdGVOYW1lcy5wdXNoKHsgdGV4dDogU2NyYXRjaC50cmFuc2xhdGUoIm1vdXNlLXBvaW50ZXIiKSwgdmFsdWU6ICJfbW91c2VfIiB9KSB9CiAgICAgIGlmIChteXNlbGYpIHsgc3ByaXRlTmFtZXMucHVzaCh7IHRleHQ6IFNjcmF0Y2gudHJhbnNsYXRlKCJteXNlbGYiKSwgdmFsdWU6ICJfbXlzZWxmXyIgfSkgfQogICAgICBjb25zdCB0YXJnZXRzID0gcnVudGltZS50YXJnZXRzOwogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB0YXJnZXQgPSB0YXJnZXRzW2ldOwogICAgICAgIGlmICh0YXJnZXQuaXNPcmlnaW5hbCkgewogICAgICAgICAgY29uc3QgdGFyZ2V0TmFtZSA9IHRhcmdldC5nZXROYW1lKCk7CiAgICAgICAgICBzcHJpdGVOYW1lcy5wdXNoKHsgdGV4dDogdGFyZ2V0TmFtZSwgdmFsdWU6IHRhcmdldE5hbWUgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzcHJpdGVOYW1lcy5sZW5ndGggPiAwID8gc3ByaXRlTmFtZXMgOiBbIiJdOwogICAgfQoKICAgIHRvUHJvcGVyS2V5KGV2ZW50LCByZXZlcnNlKSB7CiAgICAgIGxldCBrZXkgPSBldmVudC5rZXk7CiAgICAgIGlmIChrZXkgPT09ICIgIikgcmV0dXJuICJzcGFjZSI7CiAgICAgIGVsc2UgaWYgKGtleS5sZW5ndGggPiAxKSBrZXkgPSBrZXkudG9Mb3dlckNhc2UoKTsKCiAgICAgIGlmIChrZXkuc3RhcnRzV2l0aCgiYXJyb3ciKSkga2V5ID0ga2V5LnJlcGxhY2UoImFycm93IiwgIiIpICsgIiBhcnJvdyI7CiAgICAgIGVsc2UgaWYgKGtleS5zdGFydHNXaXRoKCJwYWdlIikpIGtleSA9IGtleS5yZXBsYWNlKCJwYWdlIiwgInBhZ2UgIik7CiAgICAgIGVsc2UgaWYgKGtleSA9PT0gImNhcHNsb2NrIikga2V5ID0gImNhcHMgbG9jayI7CiAgICAgIGVsc2UgaWYgKGtleSA9PT0gImNvbnRleHRtZW51Iikga2V5ID0gImNvbnRleHQgbWVudSI7CiAgICAgIHJldHVybiBrZXk7CiAgICB9CgogICAga2V5Q2hlY2tIYW5kbGVyKGtleSwgaGl0T25seSkgewogICAgICBjb25zdCB7IGtleVRpbWVycywgY3VyS2V5IH0gPSBrZXlEYXRhOwogICAgICBpZiAoa2V5ID09PSAiYW55IiAmJiBjdXJLZXkgIT09ICIiKSByZXR1cm4gaGl0T25seSA/IGtleVRpbWVycy5nZXQoY3VyS2V5KSA8PSAwLjEgOiB0cnVlOwogICAgICBpZiAoa2V5VGltZXJzLmhhcyhrZXkpKSByZXR1cm4gaGl0T25seSA/IGtleVRpbWVycy5nZXQoa2V5KSA8PSAwLjEgOiB0cnVlOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgY29sb3JBdFBvcyh4LCB5KSB7CiAgICAgIGNvbnN0IGNsaWVudFggPSBNYXRoLnJvdW5kKCgoKHJ1bnRpbWUuc3RhZ2VXaWR0aCAvIDIpICsgeCkgLyBydW50aW1lLnN0YWdlV2lkdGgpICogcmVuZGVyLl9nbC5jYW52YXMuY2xpZW50V2lkdGgpOwogICAgICBjb25zdCBjbGllbnRZID0gTWF0aC5yb3VuZCgoKChydW50aW1lLnN0YWdlSGVpZ2h0IC8gMikgLSB5KSAvIHJ1bnRpbWUuc3RhZ2VIZWlnaHQpICogcmVuZGVyLl9nbC5jYW52YXMuY2xpZW50SGVpZ2h0KTsKICAgICAgY29uc3QgcmdiID0gcmVuZGVyLmV4dHJhY3RDb2xvcihjbGllbnRYLCBjbGllbnRZLCAyMCkuY29sb3I7CiAgICAgIHJldHVybiBgIyR7cmdiLnIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICIwIil9JHtyZ2IuZy50b1N0cmluZygxNikucGFkU3RhcnQoMiwgIjAiKX0ke3JnYi5iLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAiMCIpfWA7CiAgICB9CgogICAgZ2V0VGFyZ2V0KG5hbWUsIHV0aWwsIGNoZWNrTW91c2UsIGNoZWNrTXlzZWxmKSB7CiAgICAgIGlmIChjaGVja01vdXNlICYmIG5hbWUgPT09ICJfbW91c2VfIikgcmV0dXJuICJfbW91c2VfIjsKICAgICAgaWYgKGNoZWNrTXlzZWxmICYmIG5hbWUgPT09ICJfbXlzZWxmXyIpIHJldHVybiB1dGlsLnRhcmdldDsKICAgICAgcmV0dXJuIHJ1bnRpbWUuZ2V0U3ByaXRlVGFyZ2V0QnlOYW1lKG5hbWUpOwogICAgfQoKICAgIHVwZGF0ZUFza01vbml0b3IoKSB7CiAgICAgIGxldCBib3ggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBkaXZbY2xhc3MqPSJxdWVzdGlvbiJdYCk7CiAgICAgIGlmICghYm94KSByZXR1cm47CgogICAgICBpZiAoaXNQYWNrYWdlZCkgYm94ID0gYm94LmZpcnN0RWxlbWVudENoaWxkOwogICAgICBlbHNlIGJveCA9IGJveC5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZDsKICAgICAgY29uc3QgeyB4LCB5LCB3aWR0aCwgaW5wdXQgfSA9IGFza0JveFNldHRpbmdzOwoKICAgICAgaWYgKHggIT09IHVuZGVmaW5lZCB8fCB5ICE9PSB1bmRlZmluZWQgfHwgd2lkdGggIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNvbnN0IGNhbnZhc0JvdW5kcyA9IHJlbmRlci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgY29uc3QgcmF0aW8gPSBjYW52YXNCb3VuZHMud2lkdGggLyBydW50aW1lLnN0YWdlV2lkdGg7CgogICAgICAgIGNvbnN0IHdpZHRoQ1NTID0gYHdpZHRoOiBjYWxjKCR7d2lkdGggPyBgJHt3aWR0aCAqIHJhdGlvfXB4YCA6ICIxMDAlIn0gLSAxcmVtKTtgOwogICAgICAgIGNvbnN0IHBvc2l0aW9uQ1NTID0gYHRyYW5zZm9ybTogdHJhbnNsYXRlKGNhbGMoLTUwJSArICR7eCA/PyAwfXB4KSwgY2FsYygtNTAlICsgJHt5ID8/IGlzUGFja2FnZWQgPyAtNTUgOiAxMDB9cHgpKTtgOwogICAgICAgIGJveC5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgYG1hcmdpbjogMDsgcG9zaXRpb246IGFic29sdXRlOyBsZWZ0OiA1MCU7IHRvcDogNTAlOyAke3dpZHRoQ1NTfSAke3Bvc2l0aW9uQ1NTfWApOwogICAgICB9CgogICAgICBpZiAoaW5wdXQudHlwZSA9PT0gdW5kZWZpbmVkKSByZXR1cm47CiAgICAgIGNvbnN0IGFza0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihpc1BhY2thZ2VkID8gYGlucHV0W2NsYXNzPSJzYy1xdWVzdGlvbi1pbnB1dCJdYCA6IGBkaXZbY2xhc3MqPSJxdWVzdGlvbiJdIFtjbGFzc149ImlucHV0X2lucHV0LWZvcm0iXWApOwogICAgICBjb25zdCBlbGVtZW50ID0gYm94LnF1ZXJ5U2VsZWN0b3IoYHNlbGVjdFtpZD0iU1AtaW5wdXRfc2VsZWN0Il1gKTsKICAgICAgaWYgKGVsZW1lbnQpIGVsZW1lbnQucmVtb3ZlKCk7CgogICAgICBpZiAoaW5wdXQudHlwZSA9PT0gImRyb3Bkb3duIikgewogICAgICAgIGNvbnN0IGRyb3Bkb3duID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2VsZWN0Iik7CiAgICAgICAgZHJvcGRvd24uaWQgPSAiU1AtaW5wdXRfc2VsZWN0IjsKICAgICAgICBkcm9wZG93bi5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgYXNrSW5wdXQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpKTsKICAgICAgICBkcm9wZG93bi5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgYHdpZHRoOiAxMDAlOyBiYWNrZ3JvdW5kOiAjZmZmOyBjb2xvcjogIzUwNTA1MDsgYm9yZGVyLWNvbG9yOiAjRDlEOUQ5O2ApOwogICAgICAgIGlucHV0LnZhbHVlLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKTsKICAgICAgICAgIG9wdGlvbi52YWx1ZSA9IGl0ZW07IG9wdGlvbi50ZXh0ID0gaXRlbTsKICAgICAgICAgIGRyb3Bkb3duLmFwcGVuZENoaWxkKG9wdGlvbik7CiAgICAgICAgfSk7CgogICAgICAgIGFza0lucHV0LnBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoZHJvcGRvd24pOwogICAgICAgIGFza0lucHV0LnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgYXNrSW5wdXQudmFsdWUgPSBkcm9wZG93bi52YWx1ZTsKICAgICAgICBkcm9wZG93bi5hZGRFdmVudExpc3RlbmVyKCJjaGFuZ2UiLCAoZSkgPT4gewogICAgICAgICAgYXNrSW5wdXQudmFsdWUgPSBkcm9wZG93bi52YWx1ZTsKICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgfSk7CgogICAgICAgIGNvbnN0IGJ1dHRvbiA9IGJveC5xdWVyeVNlbGVjdG9yKGBidXR0b25bY2xhc3MqPSJxdWVzdGlvbi1zdWJtaXQtYnV0dG9uIl1gKTsKICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCAoKSA9PiB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsgc2Vuc2luZ0NvcmUuX2Fuc3dlciA9IGFza0lucHV0LnZhbHVlIH0sIDEwKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoaW5wdXQudmFsdWUpIGFza0lucHV0LnZhbHVlID0gaW5wdXQudmFsdWU7CiAgICAgICAgYXNrSW5wdXQudHlwZSA9IGlucHV0LnR5cGU7CiAgICAgICAgYXNrSW5wdXQucGF0dGVybiA9IGlucHV0LnR5cGUgPT09ICJudW1iZXIiID8gIlswLTldKiIgOiAibm9uZSI7CiAgICAgICAgYXNrSW5wdXQuc3R5bGUuZGlzcGxheSA9ICJibG9jayI7CiAgICAgIH0KICAgIH0KCiAgICAvLyBCbG9jayBGdW5jcwogICAgc2Nyb2xsVmFsdWUoYXJncykgewogICAgICBjb25zdCB0eXBlID0gQ2FzdC50b1N0cmluZyhhcmdzLlRZUEUpOwogICAgICBjb25zdCBpbmRleCA9IHR5cGUuZW5kc1dpdGgoIlgiKSA/IDAgOiAxOwogICAgICBpZiAodHlwZS5zdGFydHNXaXRoKCJkaXN0YW5jZSIpKSByZXR1cm4gbW91c2VEYXRhLnNjcm9sbFtpbmRleF07CiAgICAgIGVsc2UgcmV0dXJuIG1vdXNlRGF0YS5zY3JvbGxWZWxvY2l0eVtpbmRleF07CiAgICB9CgogICAgc2V0U2Nyb2xsRGlzdChhcmdzKSB7CiAgICAgIGNvbnN0IGluZGV4ID0gYXJncy5QT1MgPT09ICJ4IiA/IDAgOiAxOwogICAgICBtb3VzZURhdGEuc2Nyb2xsW2luZGV4XSA9IENhc3QudG9OdW1iZXIoYXJncy5BTVQpOwogICAgfQoKICAgIGNoYW5nZVNjcm9sbERpc3QoYXJncykgewogICAgICBjb25zdCBpbmRleCA9IGFyZ3MuUE9TID09PSAieCIgPyAwIDogMTsKICAgICAgbW91c2VEYXRhLnNjcm9sbFtpbmRleF0gKz0gQ2FzdC50b051bWJlcihhcmdzLkFNVCk7CiAgICB9CgogICAgaXNTY3JvbGxlZChhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHR5cGUgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuVFlQRSk7CiAgICAgIGNvbnN0IGlzWCA9IHR5cGUgPT09ICJsZWZ0IiB8fCB0eXBlID09PSAicmlnaHQiOwogICAgICBjb25zdCBzY3JvbGxEaXN0ID0gbW91c2VEYXRhLnNjcm9sbFtpc1ggPyAwIDogMV07CiAgICAgIGNvbnN0IHN0YWNrTmFtZSA9IGBTUHNjcm9sbENoZWNrJHtpc1ggPyAiWCIgOiAiWSJ9YDsKCiAgICAgIGlmICh1dGlsLnRocmVhZC5zdGFja0ZyYW1lc1swXVtzdGFja05hbWVdID09PSB1bmRlZmluZWQpIHV0aWwudGhyZWFkLnN0YWNrRnJhbWVzWzBdW3N0YWNrTmFtZV0gPSAwOwogICAgICBjb25zdCB0ZXN0ZXJWYWwgPSB1dGlsLnRocmVhZC5zdGFja0ZyYW1lc1swXVtzdGFja05hbWVdOwoKICAgICAgY29uc3Qgc3RhdHVzID0gdHlwZSA9PT0gImRvd24iIHx8IHR5cGUgPT09ICJsZWZ0IiA/CiAgICAgICAgc2Nyb2xsRGlzdCA+IHRlc3RlclZhbCA6IHNjcm9sbERpc3QgPCB0ZXN0ZXJWYWw7CgogICAgICBpZiAoc3RhdHVzKSB1dGlsLnRocmVhZC5zdGFja0ZyYW1lc1swXVtzdGFja05hbWVdID0gc2Nyb2xsRGlzdDsKICAgICAgcmV0dXJuIENhc3QudG9Cb29sZWFuKHN0YXR1cyk7CiAgICB9CgogICAgbW91c2VDbGljayhhcmdzLCB1dGlsKSB7CiAgICAgIHJldHVybiB1dGlsLmlvUXVlcnkoIm1vdXNlIiwgImdldEJ1dHRvbklzRG93biIsIFtDYXN0LnRvTnVtYmVyKGFyZ3MuQlVUVE9OKV0pCiAgICB9CgogICAgcmVhbE1vdXNlKGFyZ3MpIHsKICAgICAgcmV0dXJuIG1vdXNlRGF0YS5jbGllbnRbYXJncy5QT1MgPT09ICJ4IiA/IDAgOiAxXTsKICAgIH0KCiAgICBtb3VzZVZlbG9jaXR5KGFyZ3MpIHsKICAgICAgcmV0dXJuIG1vdXNlRGF0YS52ZWxvY2l0eVthcmdzLlBPUyA9PT0gIngiID8gMCA6IDFdOwogICAgfQoKICAgIHdoZW5LZXkoYXJncykgewogICAgICBjb25zdCBrZXkgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuS0VZKTsKICAgICAgY29uc3QgaXNIaXQgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuVFlQRSkgPT09ICJoaXQiOwogICAgICByZXR1cm4gdGhpcy5rZXlDaGVja0hhbmRsZXIoa2V5LCBpc0hpdCk7CiAgICB9CgogICAgaXNLZXkoYXJncykgewogICAgICAvLyByZWFsbHkgbm90aGluZyBzcGVjaWFsIGhlcmUKICAgICAgcmV0dXJuIHRoaXMud2hlbktleShhcmdzKTsKICAgIH0KCiAgICBjdXJyZW50S2V5KGFyZ3MpIHsKICAgICAgY29uc3QgdHlwZSA9IENhc3QudG9TdHJpbmcoYXJncy5UWVBFKTsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAicHJlc3MiOiByZXR1cm4ga2V5RGF0YS5jdXJLZXk7CiAgICAgICAgY2FzZSAicHJlc3NlZCI6IHJldHVybiBKU09OLnN0cmluZ2lmeShrZXlEYXRhLmtleXMpOwogICAgICAgIGNhc2UgImxhc3RQcmVzcyI6IHJldHVybiBrZXlEYXRhLmxhc3RLZXk7CiAgICAgICAgZGVmYXVsdDogcmV0dXJuICIiOwogICAgICB9CiAgICB9CgogICAgdGltZUtleVByZXNzZWQoYXJncykgewogICAgICBjb25zdCBrZXkgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuS0VZKS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAoa2V5ID09PSAiYW55IikgcmV0dXJuIE1hdGgubWF4KDAsIC4uLmtleURhdGEua2V5VGltZXJzLnZhbHVlcygpLnRvQXJyYXkoKSk7CiAgICAgIGVsc2UgcmV0dXJuIGtleURhdGEua2V5VGltZXJzLmdldChrZXkpID8/IDA7CiAgICB9CgogICAgc2V0S2V5QmxvY2soYXJncykgewogICAgICBjb25zdCBrZXkgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuS0VZKTsKICAgICAga2V5RGF0YS5rZXlCbG9ja2Vycy5hZGQoa2V5KTsKICAgIH0KCiAgICByZXNldEtleUJsb2NrcygpIHsKICAgICAga2V5RGF0YS5rZXlCbG9ja2Vycy5jbGVhcigpOwogICAgfQoKICAgIGdldEtleUJsb2NrZXJzKCkgewogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoa2V5RGF0YS5rZXlCbG9ja2Vycy52YWx1ZXMoKS50b0FycmF5KCkpOwogICAgfQoKICAgIHNwcml0ZVBvaW50aW5nKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5TUFJJVEUxLCB1dGlsLCBmYWxzZSwgdHJ1ZSk7CiAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gZmFsc2U7CiAgICAgIGNvbnN0IG9sZERpciA9IHRhcmdldC5kaXJlY3Rpb247CiAgICAgIHJ1bnRpbWUuZXh0X3NjcmF0Y2gzX21vdGlvbi5wb2ludFRvd2FyZHMoeyBUT1dBUkRTOiBhcmdzLlNQUklURTIgfSwgeyAuLi51dGlsLCB0YXJnZXQsIGlvUXVlcnk6IHV0aWwuaW9RdWVyeSB9KTsKICAgICAgY29uc3QgbmV3RGlyID0gdGFyZ2V0LmRpcmVjdGlvbjsKICAgICAgdGFyZ2V0LnNldERpcmVjdGlvbihvbGREaXIpOwogICAgICByZXR1cm4gTWF0aC5yb3VuZChuZXdEaXIpID09PSBNYXRoLnJvdW5kKG9sZERpcik7CiAgICB9CgogICAgc3ByaXRlVG91Y2hpbmdTcHJpdGUoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLmdldFRhcmdldChhcmdzLlNQUklURTIsIHV0aWwsIGZhbHNlLCB0cnVlKTsKICAgICAgaWYgKCF0YXJnZXQpIHJldHVybiBmYWxzZTsKICAgICAgcmV0dXJuIHRhcmdldC5zcHJpdGUuY2xvbmVzLnNvbWUoKHQpID0+IHQuaXNUb3VjaGluZ09iamVjdChhcmdzLlNQUklURTEpKTsKICAgIH0KCiAgICBzcHJpdGVUb3VjaGluZ1Nwcml0ZVR5cGUoYXJncywgdXRpbCkgewogICAgICBjb25zdCB0YXJnZXQxID0gdGhpcy5nZXRUYXJnZXQoYXJncy5TUFJJVEUxLCB1dGlsLCB0cnVlLCB0cnVlKTsKICAgICAgY29uc3QgdGFyZ2V0MiA9IHJ1bnRpbWUuZ2V0U3ByaXRlVGFyZ2V0QnlOYW1lKGFyZ3MuU1BSSVRFMik7CiAgICAgIGlmICghdGFyZ2V0MSB8fCAhdGFyZ2V0MikgcmV0dXJuIGZhbHNlOwogICAgICBpZiAoYXJncy5UWVBFID09PSAicGFyZW50IikgewogICAgICAgIGlmICh0YXJnZXQxID09PSAiX21vdXNlXyIpIHJldHVybiB0YXJnZXQyLmlzVG91Y2hpbmdPYmplY3QoIl9tb3VzZV8iKTsKICAgICAgICBlbHNlIHJldHVybiByZW5kZXIuaXNUb3VjaGluZ0RyYXdhYmxlcyh0YXJnZXQxLmRyYXdhYmxlSUQsIFt0YXJnZXQyLmRyYXdhYmxlSURdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBjbG9uZXMgPSB0YXJnZXQyLnNwcml0ZS5jbG9uZXM7CiAgICAgICAgaWYgKHRhcmdldDEgPT09ICJfbW91c2VfIikgcmV0dXJuIGNsb25lcy5zb21lKChjKSA9PiAhYy5pc09yaWdpbmFsICYmIGMuaXNUb3VjaGluZ09iamVjdCgiX21vdXNlXyIpKTsKICAgICAgICBlbHNlIHsKICAgICAgICAgIGNvbnN0IGNsb25lSWRzID0gW107CiAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNsb25lcy5sZW5ndGg7IGkrKykgY2xvbmVJZHMucHVzaChjbG9uZXNbaV0uZHJhd2FibGVJRCk7CiAgICAgICAgICByZXR1cm4gcmVuZGVyLmlzVG91Y2hpbmdEcmF3YWJsZXModGFyZ2V0MS5kcmF3YWJsZUlELCBjbG9uZUlkcyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgc3ByaXRlVG91Y2hpbmdDbG9uZShhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldDEgPSB0aGlzLmdldFRhcmdldChhcmdzLlNQUklURTEsIHV0aWwsIHRydWUsIHRydWUpOwogICAgICBjb25zdCB0YXJnZXQyID0gcnVudGltZS5nZXRTcHJpdGVUYXJnZXRCeU5hbWUoYXJncy5TUFJJVEUyKTsKICAgICAgaWYgKCF0YXJnZXQxIHx8ICF0YXJnZXQyKSByZXR1cm4gZmFsc2U7CgogICAgICBjb25zdCBjbG9uZXMgPSB0YXJnZXQyLnNwcml0ZS5jbG9uZXM7CiAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgY2xvbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgdmFyaWFibGUgPSBjbG9uZXNbaV0ubG9va3VwVmFyaWFibGVCeU5hbWVBbmRUeXBlKGFyZ3MuVkFSLCAiIiwgY2xvbmVzW2ldKTsKICAgICAgICBpZiAodmFyaWFibGUgJiYgQ2FzdC50b1N0cmluZyh2YXJpYWJsZS52YWx1ZSkgPT09IENhc3QudG9TdHJpbmcoYXJncy5WQUwpKSB7CiAgICAgICAgICBpZiAodGFyZ2V0MSA9PT0gIl9tb3VzZV8iKSB7CiAgICAgICAgICAgIGlmIChjbG9uZXNbaV0uaXNUb3VjaGluZ09iamVjdCgiX21vdXNlXyIpKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChyZW5kZXIuaXNUb3VjaGluZ0RyYXdhYmxlcyh0YXJnZXQxLmRyYXdhYmxlSUQsIFtjbG9uZXNbaV0uZHJhd2FibGVJRF0pKSByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHNwcml0ZXNUb3VjaGluZyhhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IGxpc3QgPSBbXTsKICAgICAgY29uc3QgdGhpc1Nwcml0ZSA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuU1BSSVRFLCB1dGlsLCB0cnVlLCB0cnVlKTsKICAgICAgaWYgKCF0aGlzU3ByaXRlKSByZXR1cm4gIltdIjsKICAgICAgY29uc3QgdGFyZ2V0cyA9IHJ1bnRpbWUudGFyZ2V0czsKICAgICAgaWYgKHRoaXNTcHJpdGUgPT09ICJfbW91c2VfIikgewogICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGFyZ2V0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGFyZ2V0c1tpXTsKICAgICAgICAgIGNvbnN0IG5hbWUgPSBgJHt0YXJnZXQuZ2V0TmFtZSgpfSR7dGFyZ2V0LmlzT3JpZ2luYWwgPyAiIiA6ICIgKENsb25lKSJ9YDsKICAgICAgICAgIGlmICh0YXJnZXQuaXNUb3VjaGluZ09iamVjdCh0aGlzU3ByaXRlKSkgbGlzdC5wdXNoKG5hbWUpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRhcmdldHNbaV07CiAgICAgICAgICBpZiAodGFyZ2V0LmlkID09PSB0aGlzU3ByaXRlLmlkKSBjb250aW51ZTsKCiAgICAgICAgICBjb25zdCBuYW1lID0gYCR7dGFyZ2V0LmdldE5hbWUoKX0ke3RhcmdldC5pc09yaWdpbmFsID8gIiIgOiAiIChDbG9uZSkifWA7CiAgICAgICAgICBpZiAocmVuZGVyLmlzVG91Y2hpbmdEcmF3YWJsZXModGhpc1Nwcml0ZS5kcmF3YWJsZUlELCBbdGFyZ2V0LmRyYXdhYmxlSURdKSkgbGlzdC5wdXNoKG5hbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobGlzdCk7CiAgICB9CgogICAgZ2V0TmVpZ2hib3JzKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgY2lyYyA9IENhc3QudG9OdW1iZXIoYXJncy5ESUFNRVRFUik7CiAgICAgIGxldCBsaXN0ID0gW10sIHBvcyA9IFtdOwogICAgICBpZiAoYXJncy5TUFJJVEUgPT09ICJfbW91c2VfIikgcG9zID0gW3V0aWwuaW9RdWVyeSgibW91c2UiLCAiZ2V0U2NyYXRjaFgiKSwgdXRpbC5pb1F1ZXJ5KCJtb3VzZSIsICJnZXRTY3JhdGNoWSIpLCAiIl07CiAgICAgIGVsc2UgaWYgKGFyZ3MuU1BSSVRFID09PSAiX215c2VsZl8iKSBwb3MgPSBbdXRpbC50YXJnZXQueCwgdXRpbC50YXJnZXQueSwgdXRpbC50YXJnZXQuaWRdOwogICAgICBlbHNlIHsKICAgICAgICBjb25zdCBuYW1lVGFyZ2V0ID0gcnVudGltZS5nZXRTcHJpdGVUYXJnZXRCeU5hbWUoYXJncy5TUFJJVEUpOwogICAgICAgIGlmICghbmFtZVRhcmdldCkgcmV0dXJuICJbXSI7CiAgICAgICAgcG9zID0gW25hbWVUYXJnZXQueCwgbmFtZVRhcmdldC55LCBuYW1lVGFyZ2V0LmlkXTsKICAgICAgfQogICAgICBjb25zdCB0YXJnZXRzID0gcnVudGltZS50YXJnZXRzOwogICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRhcmdldHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCB0YXJnZXQgPSB0YXJnZXRzW2ldOwogICAgICAgIGNvbnN0IGR4ID0gcG9zWzBdIC0gdGFyZ2V0Lng7CiAgICAgICAgY29uc3QgZHkgPSBwb3NbMV0gLSB0YXJnZXQueTsKICAgICAgICBpZiAoTWF0aC5zcXJ0KChkeCAqIGR4KSArIChkeSAqIGR5KSkgPD0gY2lyYyAmJiB0YXJnZXQuaWQgIT09IHBvc1syXSkgbGlzdC5wdXNoKGAke3RhcmdldC5nZXROYW1lKCl9JHt0YXJnZXQuaXNPcmlnaW5hbCA/ICIiIDogIiAoQ2xvbmUpIn1gKTsKICAgICAgfQogICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkobGlzdCk7CiAgICB9CgogICAgY29sb3JBdFBvc2l0aW9uKGFyZ3MpIHsgcmV0dXJuIHRoaXMuY29sb3JBdFBvcyhDYXN0LnRvTnVtYmVyKGFyZ3MueCksIENhc3QudG9OdW1iZXIoYXJncy55KSkgfQogICAgb2JqVG91Y2hpbmdDb2xvcihhcmdzLCB1dGlsKSB7CiAgICAgIGlmIChhcmdzLlNQUklURSA9PT0gIl9tb3VzZV8iKSByZXR1cm4gdGhpcy5jb2xvckF0UG9zKHV0aWwuaW9RdWVyeSgibW91c2UiLCAiZ2V0U2NyYXRjaFgiKSwgdXRpbC5pb1F1ZXJ5KCJtb3VzZSIsICJnZXRTY3JhdGNoWSIpKTsKICAgICAgZWxzZSB7CiAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5TUFJJVEUsIHV0aWwsIGZhbHNlLCB0cnVlKTsKICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuICIiOwogICAgICAgIGNvbnN0IHdhc1Zpc2libGUgPSB0YXJnZXQudmlzaWJsZTsKICAgICAgICB0YXJnZXQuc2V0VmlzaWJsZShmYWxzZSk7CiAgICAgICAgY29uc3QgaGV4ID0gdGhpcy5jb2xvckF0UG9zKHRhcmdldC54LCB0YXJnZXQueSk7CiAgICAgICAgdGFyZ2V0LnNldFZpc2libGUod2FzVmlzaWJsZSk7CiAgICAgICAgcmV0dXJuIGhleDsKICAgICAgfQogICAgfQoKICAgIHNwcml0ZURyYWdNb2RlKGFyZ3MsIHV0aWwpIHsKICAgICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5nZXRUYXJnZXQoYXJncy5TUFJJVEUsIHV0aWwsIGZhbHNlLCB0cnVlKTsKICAgICAgaWYgKHRhcmdldCkgdGFyZ2V0LnNldERyYWdnYWJsZShhcmdzLkRSQUcgPT09ICJkcmFnZ2FibGUiKTsKICAgIH0KICAgIHNwcml0ZURyYWdnYWJsZShhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuZ2V0VGFyZ2V0KGFyZ3MuU1BSSVRFLCB1dGlsLCBmYWxzZSwgdHJ1ZSk7CiAgICAgIGlmICh0YXJnZXQpIHJldHVybiB0YXJnZXRbYXJncy5EUkFHID09PSAiZHJhZ2dhYmxlIiA/ICJkcmFnZ2FibGUiIDogImRyYWdnaW5nIl07CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBhZHZhbmNlZEFzayhhcmdzLCB1dGlsKSB7CiAgICAgIGNvbnN0IHdhc1Zpc2libGUgPSB1dGlsLnRhcmdldC52aXNpYmxlOwogICAgICBpZiAoIXV0aWwudGFyZ2V0LmlzU3RhZ2UgJiYgYXJncy5UWVBFID09PSAic3RhZ2UiKSB1dGlsLnRhcmdldC5zZXRWaXNpYmxlKGZhbHNlKTsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsKICAgICAgICBzZW5zaW5nQ29yZS5hc2tBbmRXYWl0KGFyZ3MsIHV0aWwpOwogICAgICAgIGlmICghdXRpbC50YXJnZXQuaXNTdGFnZSAmJiB3YXNWaXNpYmxlKSB1dGlsLnRhcmdldC5zZXRWaXNpYmxlKHRydWUpOwogICAgICAgIHRoaXMudXBkYXRlQXNrTW9uaXRvcigpOwoKICAgICAgICBpZiAoYXJncy5XQUlUID09PSAiY29udGludWUiKSByZXNvbHZlKCk7CiAgICAgICAgZWxzZSBydW50aW1lLm9uY2UoIkFOU1dFUiIsICgpID0+IHJlc29sdmUoKSk7CiAgICAgIH0pOwogICAgfQoKICAgIGFza1JlcG9ydGVyKGFyZ3MsIHV0aWwpIHsKICAgICAgcmV0dXJuIHRoaXMuYWR2YW5jZWRBc2soYXJncywgdXRpbCkudGhlbigoKSA9PiB7IHJldHVybiBzZW5zaW5nQ29yZS5nZXRBbnN3ZXIoKSB9KTsKICAgIH0KCiAgICBzdG9wQXNraW5nKCkgewogICAgICBydW50aW1lLmVtaXQoIkFOU1dFUiIsIHRoaXMuY3VycmVudFR5cGVkKCkpOwogICAgICBydW50aW1lLmVtaXQoIlFVRVNUSU9OIiwgbnVsbCk7CiAgICB9CgogICAgY3VycmVudFR5cGVkKCkgewogICAgICBsZXQgYm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihpc1BhY2thZ2VkID8gYGlucHV0W2NsYXNzPSJzYy1xdWVzdGlvbi1pbnB1dCJdYCA6IGBkaXZbY2xhc3MqPSJxdWVzdGlvbiJdIFtjbGFzc149ImlucHV0X2lucHV0LWZvcm0iXWApOwogICAgICByZXR1cm4gYm94ID8gYm94LnZhbHVlIDogIiI7CiAgICB9CgogICAgaXNBc2tpbmcoKSB7IHJldHVybiBDYXN0LnRvQm9vbGVhbihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBkaXZbY2xhc3MqPSJxdWVzdGlvbi1pbnB1dCJdYCkpIH0KCiAgICBzZXRBc2tEaXNwbGF5KGFyZ3MpIHsKICAgICAgYXNrQm94U2V0dGluZ3Mud2lkdGggPSBDYXN0LnRvTnVtYmVyKGFyZ3Mud2lkdGgpOwogICAgICBpZiAoYXNrQm94U2V0dGluZ3Mud2lkdGggPCAwKSBhc2tCb3hTZXR0aW5ncy53aWR0aCA9IHVuZGVmaW5lZDsKCiAgICAgIGFza0JveFNldHRpbmdzLnggPSBDYXN0LnRvTnVtYmVyKGFyZ3MueCk7CiAgICAgIGFza0JveFNldHRpbmdzLnkgPSBpc05hTihhcmdzLnkpID8gdW5kZWZpbmVkIDogQ2FzdC50b051bWJlcihhcmdzLnkpICogLTE7CiAgICAgIGlmIChpc05hTihhcmdzLnkpKSBhc2tCb3hTZXR0aW5ncy55ID0gdW5kZWZpbmVkOwogICAgICB0aGlzLnVwZGF0ZUFza01vbml0b3IoKTsKICAgIH0KCiAgICBzZXRBc2tUeXBlKGFyZ3MpIHsKICAgICAgY29uc3QgaW5wdXRUeXBlID0gQ2FzdC50b1N0cmluZyhhcmdzLlRZUEUpOwogICAgICBhc2tCb3hTZXR0aW5ncy5pbnB1dCA9IHsKICAgICAgICB0eXBlOiB2YWxpZElucHV0cy5maW5kKChpKSA9PiBpLnZhbHVlID09PSBpbnB1dFR5cGUpID8gaW5wdXRUeXBlIDogInRleHQiLAogICAgICAgIHZhbHVlOiBhcmdzLlRFWFQKICAgICAgfTsKICAgICAgdGhpcy51cGRhdGVBc2tNb25pdG9yKCk7CiAgICB9CgogICAgc2V0QXNrTGlzdChhcmdzKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYXJyYXkgPSBKU09OLnBhcnNlKGFyZ3MuTElTVCk7CiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXJyYXkpICYmIGFycmF5Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIGFza0JveFNldHRpbmdzLmlucHV0ID0geyB0eXBlOiAiZHJvcGRvd24iLCB2YWx1ZTogYXJyYXkgfTsKICAgICAgICAgIHRoaXMudXBkYXRlQXNrTW9uaXRvcigpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCB7fQogICAgfQoKICAgIGlzU2NyZWVuKGFyZ3MpIHsKICAgICAgY29uc3QgdmFsdWVzID0gW3JlbmRlci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgsIHJ1bnRpbWUuc3RhZ2VXaWR0aF07CiAgICAgIHJldHVybiBhcmdzLlNDUkVFTiA9PT0gImZ1bGxzY3JlZW4iID8gdmFsdWVzWzBdID4gdmFsdWVzWzFdIDogdmFsdWVzWzBdIDwgdmFsdWVzWzFdOwogICAgfQoKICAgIHNjcmVlbk9mZihhcmdzKSB7CiAgICAgIGNvbnN0IHR5cGUgPSBDYXN0LnRvU3RyaW5nKGFyZ3MuVFlQRSk7CiAgICAgIGNvbnN0IGNhbnZhc0JvdW5kcyA9IHR5cGUuc3RhcnRzV2l0aCgiZGlzcGxheSIpIHx8IHR5cGUgPT09ICJyYXRpbyIgPwogICAgICAgIHJlbmRlci5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiB7fTsKICAgICAgc3dpdGNoICh0eXBlKSB7CiAgICAgICAgY2FzZSAid2lkdGgiOiByZXR1cm4gcnVudGltZS5zdGFnZVdpZHRoOwogICAgICAgIGNhc2UgImhlaWdodCI6IHJldHVybiBydW50aW1lLnN0YWdlSGVpZ2h0OwogICAgICAgIGNhc2UgImRpc3BsYXkgd2lkdGgiOiByZXR1cm4gY2FudmFzQm91bmRzLndpZHRoOwogICAgICAgIGNhc2UgImRpc3BsYXkgaGVpZ2h0IjogcmV0dXJuIGNhbnZhc0JvdW5kcy5oZWlnaHQ7CiAgICAgICAgY2FzZSAicmF0aW8iOiByZXR1cm4gY2FudmFzQm91bmRzLndpZHRoIC8gcnVudGltZS5zdGFnZVdpZHRoOwogICAgICAgIGRlZmF1bHQ6IHJldHVybiAwOwogICAgICB9CiAgICB9CgogICAgYXZlcmFnZU1pY1ZvbHVtZSgpIHsKICAgICAgaWYgKGxvdWRuZXNzQ2FjaGUubGVuZ3RoID49IDMwKSBsb3VkbmVzc0NhY2hlID0gW107CiAgICAgIGxvdWRuZXNzQ2FjaGUucHVzaChzZW5zaW5nQ29yZS5nZXRMb3VkbmVzcygpKTsKICAgICAgbGV0IHN1bSA9IGxvdWRuZXNzQ2FjaGUucmVkdWNlKChhY2N1bXVsYXRvciwgY3VyVmFsdWUpID0+IGFjY3VtdWxhdG9yICsgY3VyVmFsdWUsIDApOwogICAgICByZXR1cm4gTWF0aC5yb3VuZCgoc3VtIC8gbG91ZG5lc3NDYWNoZS5sZW5ndGgpICogMTAwKSAvIDEwMDsKICAgIH0KCiAgICBnZXRTcHJpdGVOYW1lKF8sIHV0aWwpIHsgcmV0dXJuIHV0aWwudGFyZ2V0LmdldE5hbWUoKSB9CgogICAgYWxsTGF5ZXJzKCkgeyByZXR1cm4gcmVuZGVyLl9kcmF3TGlzdC5sZW5ndGggLSAxIH0KCiAgICBib29sZWFuKGFyZ3MpIHsKICAgICAgcmV0dXJuIENhc3QudG9Cb29sZWFuKGFyZ3MuU1RSSU5HKSAmJiBhcmdzLlNUUklORyAhPT0gdW5kZWZpbmVkOwogICAgfQoKICAgIGdldEFsbFN0cmluZyhhcmdzKSB7CiAgICAgIGxldCByZWdleDsKICAgICAgc3dpdGNoIChhcmdzLlRFWFQpIHsKICAgICAgICBjYXNlICJudW1iZXJzIjoge3JlZ2V4ID0gL1teMC05XS9nOyBicmVhayB9CiAgICAgICAgY2FzZSAic3BlY2lhbCBjaGFyYWN0ZXJzIjoge3JlZ2V4ID0gL1tBLVphLXowLTldL2c7IGJyZWFrIH0KICAgICAgICBkZWZhdWx0OiByZWdleCA9IC9bXkEtWmEtel0vZzsKICAgICAgfQogICAgICByZXR1cm4gQ2FzdC50b1N0cmluZyhhcmdzLlNUUklORykucmVwbGFjZShyZWdleCwgIiIpOwogICAgfQogIH0KCiAgU2NyYXRjaC5leHRlbnNpb25zLnJlZ2lzdGVyKG5ldyBIeXBlclNlbnNlMlNQKCkpOwp9KShTY3JhdGNoKTsK","text":"https://extensions.turbowarp.org/lab/text.js"},"customFonts":[{"system":true,"family":"Minecraft Ten v2","fallback":"Sans Serif"}],"meta":{"semver":"3.0.0","platform":{"name":"TurboWarp","url":"https://turbowarp.org/"}}}